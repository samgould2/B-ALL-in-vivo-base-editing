# Multiplexed in vivo base editing defines functional gene-variant-context interactions
## Acosta & Johnson & Gould et al. (2025)

Code for the generation of all figures associated with "Multiplexed in vivo base editing defines functional gene-variant-context interactions".

Notebooks are organized by figures, with main figures split into separate Jupyter notebooks, while extended data and supplementary figures are in a single notebook:
- **Figure 1**: figure1.ipynb
- **Figure 2**: figure2.ipynb
- **Figure 3**: figure3.ipynb
- **Figure 3a** (UMAP): figure3a.ipynb
    - This figure is separated because the UMAP package requires a clean virtual environment for package compatability.
- **Figure 4**: figure4.ipynb
- **Figure 5**: figure5.ipynb
- **Extended Data Figures**: extended_figures.ipynb
- **Supplementary Figures**: supplementary_figures.ipynb

There are three additional jupyter notebooks present in this repository. 
- **empirical_FDR_LFC.ipynb**: This notebook includes the code for processing of raw gRNA count dataframes to generate LFC tables, as well as compute non-parametric empirical p-values and FDR values for the various screening datasets in this project.
- **MBESv2_library_generation.ipynb**: This notebook includes code for the generation of the MBESv2 library. This includes the use of PEGG.base for the generation of "sensor" libraries, as well as filtration of the library and inclusion of control gRNAs. 
    - For information about generating base editing sensor libraries, please visit: [https://pegg.readthedocs.io](https://pegg.readthedocs.io/en/latest/)
    - For additional information about h2m (human2mouse), please visit: [https://h2m-public.readthedocs.io/en/latest/](https://h2m-public.readthedocs.io/en/latest/) or [https://human2mouse.com/](https://human2mouse.com/)
- **editing_analysis.ipynb**: This notebook includes the code that was used to process crispresso editing information as well as generated maximum likelihood estimates of editing at each time-point.


Datasets are organized into the following folders:
- **240807Hem_ABE**: Raw counts data and crispresso editing data for the ABE screen.
- **240807HemA_CBE**: Raw counts data and crispresso editing data for the CBE screen.
    - These sequencing datasets were processed using the following pipeline: [https://github.com/samgould2/base-editing-sensor-analysis](https://github.com/samgould2/base-editing-sensor-analysis)
- **ABE_editing**: Processed editing files for the ABE screen.
- **CBE_editing_UPDATED**: Processed editing files for the CBE screen
- **figures**: Folder for holding figures.
- **mageck**: Folder for holding MAGeCK screen analysis files. These were used in previous versions of this manuscript, but have since been replaced by the non-parametric approach for calculating p-values and FDR values.
- **MBESv2_OT_CasOFF**: Off-target predictions for the gRNAs present in the library, generated by Cas-OFFinder.
- **source_data**: Inlcudes additional datasets used for analysis, including kinase information, cancer gene classification, and datasets used to generate the library.

Frequently used tables were left in the root directory:
- **MBESv2_CORRECTED.csv**: Table of the gRNA library, with relevant annotations.
- **ABE_LFC_FDR_df.csv**: ABE LFC tables with empirically calculated p-value and FDR values.
- **CBE_LFC_FDR_df.csv**: CBE LFC tables with empirically calculated p-value and FDR values.
- **KO_LFC_FDR.csv**: Cas9 KO LFC tables with empirically calculated p-value and FDR values.
- **master_table_min50_control_mean_invitro.csv**: Legacy MAGeCK dataframe of processed screening data. 
- **master_table_unfiltered.csv**: Legacy MAGeCK dataframe of processed screening data. 
- **cancer_type_counts_per_guide.csv**: A breakdown of the mutations in the library by the number of times each mutation was observed in different cancer types in the MSK-IMPACT dataset. 
- **B-ALL validation.xlsx**: Flow data of the competition assays for validation gRNAs (used in Figure 5).



For questions, please email: samgould@mit.edu



