pdf(file='CBE_d15_input.pdf',width=4.5,height=4.5);
gstable=read.table('CBE_d15_input.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("safe_target","non_target","Atrx","Tshr","Phox2b","Ctcf","Epha3","Phf6","Pik3cg","Hist1h3g")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='d15_rep1,d15_rep2,d15_rep3_vs_input_rep1,input_rep2,input_rep3 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(871.1581075747638,1080.9145455481425,561.8188096249324,549.708464880727,3641.2591758707085,774.5913640321237),c(1078.817889031539,585.4189134632554,199.70599456930515,44.782766996393235,272.98944225097586,168.8358201424953),c(953.2090456137822,946.0296234805899,702.4677785628477,721.0025486419311,528.129574816311,357.0649439500069),c(1420.1903102556032,1558.0584875558116,1345.8785314943054,1870.8000912743273,3663.3083231294413,1972.413060989016),c(258.30850864135436,941.4417009612854,460.8002131501866,211.59857405795805,338.0869246339009,286.3364247011238),c(632.0961152635496,923.0900108840674,982.2115841852207,716.5242719422918,1711.433811034964,803.1109282453831),c(1369.541583071024,817.5677929400637,601.4491820881019,220.5551274572367,1226.3525713428453,506.5074604274859),c(604.7458025838768,464.2977589536164,139.09483668445768,118.67433254044207,62.997563596379045,133.4715605180537),c(685.7837660792036,1420.4208119766763,1719.647338450865,2057.7681434842693,2646.947630441193,1025.5635291088058),c(2142.441159907704,1912.2461060461196,2835.514296433442,5624.715534746991,1779.681171597708,2257.6087031216093),c(1490.0855537703228,811.1447014130373,361.3357489288984,277.6531553776381,3270.6235100453455,670.7801502958597),c(648.3037079626149,342.25901994011645,149.97376245866107,66.05458131968003,178.49309685640728,134.61234308658408),c(2059.3772473249937,879.045954698744,1180.3634465010682,375.05567359479335,2310.960624593838,1467.0463831300606),c(840.7688712640162,723.9741735462517,320.9283103390001,408.6427488420883,1940.3249587684745,546.434850326049),c(1174.037496138548,1696.6137476388078,1390.171300717848,626.9587379495053,1808.0300752160786,724.3969310167872),c(2040.1307309948538,2418.7527521773377,4391.977748271255,3242.2723305388704,2094.668989579603,3110.914064382329),c(965.3647401380813,1064.3980244786462,721.894431731068,4451.4070394414875,643.6251080763392,1033.5490070885185),c(806.3277367785023,1224.9753126543042,550.939883850729,512.7626821087025,1453.1438002898099,556.7018934428223),c(283.63287223364404,495.49563208488706,330.25310385974586,170.1745145862943,473.5316863661158,329.686162305278),c(748.5881877880819,962.5461445500862,594.4555869475425,613.5239078505873,927.1141442600449,547.5756328945794),c(169.16674879649483,467.0505124651991,145.31136569828817,69.41328884440952,91.34646721474961,454.0314622750887),c(142.8294106605136,497.33080109260885,170.95454788033905,106.35907161643394,699.2729559198074,401.55546412269155),c(480.14993370981165,557.8913783474284,209.80785421677973,77.25027306877833,394.784731870642,130.0492128124626),c(618.9274461955589,533.116596743184,258.763020200695,98.52208739206512,1230.5524089159373,391.28842100591817),c(173.21864697126117,55.97265473551502,28.751446688966112,23.51095267310645,209.9918786545968,106.09277887332475),c(1728.1345715378454,2670.1709062352247,2684.7634678480517,2888.488471267364,2160.8164313558013,3057.2972836614013),c(1832.4709495380787,1597.5146212218303,1429.0246070542887,537.3932039567188,1656.835922584769,1860.6163692730395),c(1191.258063381305,1287.3710589168454,1115.0898918558478,347.06644422204755,559.6283566145005,2177.7539233244834),c(991.7020782740625,830.4139759941163,385.4247988574916,228.3921116816055,1517.191323279462,373.0358999094322),c(1745.3551387806024,1806.723888102116,1091.7779080539833,1344.602579066707,1612.7376280673034,880.6841429054484),c(380.8784284280363,518.4352446814096,372.99174082983063,344.8273058722279,500.8306305912134,220.1710357263621),c(713.1340787588764,642.3091527026314,516.7489742746612,381.7730886442523,568.0280317606844,1168.1613501751026),c(384.9303266028026,495.49563208488706,233.11983801864415,110.83734831607326,25.199025438551615,15.97095595942523),c(787.0812204483622,1257.0907702894356,676.047530254068,265.33789445362993,1728.2331613273318,1313.04073637846),c(1164.9207252453236,1079.0793765404208,1070.7971226323054,1238.243507450273,560.6783160077734,852.1645786921891),c(3676.084619056765,1829.6635006986385,1633.3929983839666,1427.4506980100343,1384.8964397270659,739.2271044076821),c(571.3176426420544,269.7698441351052,94.02500133418647,16.793537623647463,781.1697885951002,269.22468617316815),c(371.761657534812,587.2540824709772,232.34277189191533,166.8158070615648,2566.100757159173,837.3344053012943),c(111.42719980607444,277.1105201659924,274.3043427352713,152.261407787737,8.399675146183872,329.686162305278),c(774.9255259240631,1417.6680584650935,965.8931955239156,1483.4291567555258,1080.4082156779007,2086.4913178420534),c(178.2835196897191,730.3972650732779,435.93409709486457,296.6858313511052,244.64053863260528,966.2428355452265),c(13.168669067990615,200.95100634553754,87.03140619362715,24.63052184801628,124.9451677994851,28.51956421325934),c(130.67371613621458,45.879225193045094,66.05062077194917,55.978458745491544,128.09504597930405,87.84025777683877),c(668.5631988364466,563.3968853705938,867.982863556085,1941.3329492936468,1136.0560635213687,835.0528401642335),c(1921.6127093829382,828.5788069863945,716.4549688439663,2878.4123486931753,844.1673521914792,593.2069356357943),c(31.40221085443916,41.29130267374059,57.502893377932224,69.41328884440952,8.399675146183872,25.09721650766822),c(273.50312679672817,33.95062664285337,40.40743858989832,6.717415049458985,8.399675146183872,633.1343255343573),c(652.3556061373813,210.12685138414656,156.19029147249157,155.62011531246648,332.8371276675359,214.46712288371023),c(470.0201882728958,345.92935795556,151.5278947121187,81.72854976841765,11.549553326002824,269.22468617316815),c(501.422399127335,218.38511191889467,89.36260457381358,86.20682646805697,299.23842708280046,87.84025777683877),c(583.4733371663534,345.92935795556,194.26653168220346,235.10952673106448,595.3269759857819,468.86163566598356),c(563.2138462925217,638.6388146871877,345.01736026759335,333.6316141231296,2050.570695062138,1084.8842226723852),c(1621.7722444502288,1497.497910300992,1408.8208877593395,703.0894418433738,3231.775012494245,749.4941475244555),c(1015.0004927789689,1882.8834019225708,892.0719134846782,1072.5472695636179,570.1279505472303,610.3186741637498),c(30.389236310747574,109.19255595944733,48.17809985718645,5.597845874549154,3.149878179818952,54.757563289457934),c(1967.1965638490597,1785.619444513315,1565.011179231831,2142.8554007774164,681.4236462341667,814.5187539306868),c(659.4464279432224,1603.9377127488567,1465.5467150105428,1410.657160386387,566.9780723674114,1014.1557034235021),c(3.0389236310747574,10.093429542469922,137.54070443100005,16.793537623647463,7.349715752910888,29.660346781789713),c(2234.6218433836384,1202.9532845616425,1463.9925827570853,1165.471511081134,1707.233973461872,1775.0576766332613),c(184.3613669518686,628.5453851447178,719.5632333508815,455.66465418830114,82.94679206856574,659.372324610556),c(1580.240288158874,2005.8397254399317,1694.781222395543,640.3935680484233,783.2697073816461,1748.8196775570627),c(718.1989514773343,409.2426887219623,343.4632280141357,185.84848303503193,980.662073316967,809.9556236565653),c(422.4103847193913,460.6274209381728,197.3747961891187,150.02226943791734,340.18684342044685,343.3755531276425),c(560.174922661447,278.9456891737142,292.95392977676283,63.81544296986036,826.3180425058384,143.7386036348271),c(903.5732929728945,372.5393085675262,188.82706879510175,1463.276911607149,239.39074166624036,134.61234308658408),c(427.4752574378492,557.8913783474284,182.61053978127126,122.03304006517156,703.4727934928993,385.58450816326626),c(1341.1782958476597,1567.2343325944205,1866.5128364026107,1242.7217841499123,718.172224998721,1445.3715143279833),c(545.9932790497647,163.33004168724054,135.98657217754243,520.5996663330714,574.3277881203222,576.0951971078387),c(907.6251911476609,1445.1955935809206,1641.9407257779835,971.7860438217332,1609.5877498874845,431.21581090448126),c(210.69870508784985,137.6376755791353,151.5278947121187,148.90270026300752,1064.6588247788059,191.65147151310276),c(1015.0004927789689,1425.9263189998417,615.4363723692205,216.07685075759736,427.33347306210453,668.498585158799),c(577.3954899042039,85.33535885906389,46.62396760372883,94.0438106924258,127.04508658603108,61.60225870064018),c(928.8976565651842,451.45157589956375,310.8264506915255,341.4685983474984,214.19171622768874,384.4437255947359),c(817.4704567591098,800.1336873667065,324.8136409726442,249.6639260048923,421.0337167024666,638.8382383770092),c(1006.8966964294362,641.3915681987704,292.95392977676283,246.3052184801628,1055.209190239349,880.6841429054484),c(679.7059188170541,696.4466384304246,379.98533597038994,202.6420206586794,196.34240654204802,434.63815861007237),c(1599.486804489014,1413.99772044965,1176.478115867424,1565.1577065239435,1076.2083781048086,1243.4529996981073),c(1558.9678227413506,1151.568552345432,673.7163318738816,304.522815575474,1146.5556574540985,1615.3481170390091),c(971.4425874002308,1327.7447770867252,853.9956732749664,219.43555828232684,701.3728747063533,456.31302741214944),c(932.9495547399505,478.0615265115299,287.5144668896611,261.97918692890045,1013.2108145084296,612.6002393008106),c(567.2657444672881,493.6604630771653,211.36198647023735,344.8273058722279,38.84849755110041,495.09963474218216),c(1247.9846378280338,206.45651336870293,206.69958970986448,278.7727245525479,403.18440701682584,172.25816784808643),c(2103.9481272474236,2406.8241536271457,1875.8376299233566,2066.724696883548,1395.3960336597959,1008.4517905808503),c(850.898616700932,580.830990943951,794.1615815168477,460.1429308879405,606.8765293117848,846.4606658495372),c(686.7967406228952,94.5112038976729,34.19090957606781,58.217597095311206,292.93867072316255,200.77773206134577),c(101.29745436915857,746.9137861427741,545.5004209636273,336.9903216478591,1097.2075659702684,358.20572651853735),c(545.9932790497647,649.6498287335186,289.0685991431187,218.315989107417,622.6259202108795,217.88947058930137),c(973.468536487614,998.3319402006613,880.415921583746,1278.5479977470268,2713.0950722173907,736.9455392706213),c(498.3834754962602,628.5453851447178,331.0301699864747,257.5009102292611,698.2229965265344,116.35982199009811),c(1397.9048702943885,1302.05241097862,891.2948473579495,669.5023665960789,1245.251840421759,914.9076199613596),c(1118.3238962355108,713.8807440037817,460.8002131501866,669.5023665960789,2368.708391223852,1543.4788152215956),c(2138.3892617329375,1389.2229388454055,1111.2045612222037,979.623028046102,1276.7506222199486,2149.234359111224),c(2830.250875074291,1880.1306484109882,1062.2493952382886,609.045631150948,1958.1742684541152,1260.564738226063),c(2071.532941849293,812.0622859168982,442.15062610869506,397.44705709298995,1456.293678469629,642.2605860826003),c(863.0543112252311,706.5400679728945,681.4869931411697,498.20828283487475,164.8436247438585,700.4404970776494),c(2013.7933928588725,2128.7960489572924,2509.1465232073397,1822.6586167532046,1028.9602054075244,1186.4138712715885),c(5775.980848129422,4454.872766244679,3583.8289764732895,2773.172846251651,2053.7205732419566,3922.0104706074244),c(739.4714168948576,568.9023923937592,224.5721106246272,137.7070085139092,524.979696636492,880.6841429054484),c(1065.6492199635481,713.8807440037817,314.71178132516957,378.41438111952283,555.4285190414085,752.9164952300466),c(2754.277784297422,1244.244587235383,1007.8547663672715,686.2959042197264,4796.214508470991,2266.7349636698523),c(1139.596361653034,946.0296234805899,1394.056631351492,610.1652003258579,2916.7871945123497,1813.8442839632942),c(691.8616133413531,674.4246103377629,662.8374060996782,391.8492112184408,974.3623169573292,1462.483252855939),c(1654.1874298483597,390.89099864474423,225.349176751356,223.91383498196618,1096.1576065769952,484.8325916254088),c(2372.386381325694,1888.3889089457361,1463.9925827570853,696.3720267939148,206.84200047477785,785.9991897174274),c(201.58193419462557,265.18192161580066,120.44524964296615,68.29371966949968,1470.9931099754506,294.3219026808364),c(2255.8943088011615,1035.9529048589584,542.3921564567121,207.1202973583187,443.0828639611993,1146.4864813730255),c(845.8337439824742,560.644131859011,398.6349230118815,257.5009102292611,2423.3062796740473,406.118594396813),c(3340.79004509485,2317.818456752638,2711.1837161568315,3556.871268688533,7161.773021515024,1601.6587262166445),c(192.4651633014013,55.05507023165412,115.00578675586445,669.5023665960789,254.09017317206215,107.23356144185512),c(307.9442612822421,1197.447777538477,488.7745937124239,231.750819206335,68.24736056274396,265.80233846757704),c(897.495445710745,299.132548258654,99.46446422128817,39.184921121844084,264.589767104792,94.68495318802101),c(284.64584677733563,618.451955602248,210.58492034350854,59.33716627022103,503.98050877103236,118.64138712715885),c(542.9543554186899,434.01747032620665,178.72520914762717,54.85888957058171,175.34321867658832,181.3844283963294),c(160.04997790327056,368.8689705520826,136.76363830427124,254.1422027045316,221.54143198059964,116.35982199009811),c(999.8058746235952,1360.7778192257176,731.2192252518138,333.6316141231296,352.7863561397226,949.1310970172708),c(535.8635336128489,273.44018215054876,153.08202696557632,76.1307038938685,563.8281941875924,240.70512195990884),c(721.2378751084091,604.6881880443344,209.03078809005092,43.66319782148341,71.39723874256292,135.75312565511447),c(1906.4180912275644,906.5734898145712,1080.89898227978,418.7188714162767,3028.082890199286,962.8204878396353),c(310.98318491331685,803.8040253821501,485.66632920550865,619.1217537251365,269.8395640711569,394.7107687115093),c(132.69966522359775,575.3254839207855,524.5196355419494,542.991049831268,899.8152000349473,315.9967714829135),c(2455.450293908404,2969.3034544938787,2982.3797943851873,5596.7263053742445,1375.446805187609,860.1500566719017),c(161.06295244696213,478.9791110153908,364.4440134358137,118.67433254044207,369.5857064320904,233.8604265487266),c(929.9106311088758,942.3592854651463,494.2140565995256,182.48977551030242,689.8233213803505,342.23477055911206),c(1997.5858001598071,1958.1253312391648,1621.7370064830345,1195.6998788036994,1147.6056168473715,1439.6676014853315),c(1077.8049144878473,747.8313706466352,296.8392604104069,223.91383498196618,1873.1275575990035,1097.4328309262194),c(1286.477670488314,1342.4261291484995,498.87645335989845,274.29444785290855,1446.8440439301721,287.4772072696542),c(454.82557011752203,177.0938092451541,158.52148985267803,397.44705709298995,392.68481308409605,177.96208069073828),c(18.233541786448544,143.1431826023007,52.84049661755934,68.29371966949968,235.19090409314842,161.99112473131305),c(1331.0485504107437,715.7159130115035,355.1192199150679,545.2301881810877,97.64622357438752,491.67728703659105),c(584.486311710045,406.48993521037954,170.95454788033905,22.391383498196618,128.09504597930405,28.51956421325934),c(147.89428337897152,400.0668436833532,345.79442639432216,443.34939326429304,650.9748238292501,365.05042192971956),c(2285.2705705682174,1631.4652478646838,971.3326584110173,1135.2431433585684,3811.352597580932,2184.5986187356657),c(2489.891428393918,2338.922900341439,2771.7948740416787,1199.0585863284289,3464.8659978008473,2036.296884826717),c(1334.0874740418185,1744.3281418395745,712.5696382103223,676.2197816455379,1035.2599617671622,1112.2630043171143),c(345.42431939883073,338.5886819246728,310.8264506915255,146.66356191318783,1068.8586623518977,460.876157686271),c(796.1979913415864,734.0676030887215,338.023765127034,154.50054613755665,824.2181237192925,423.2303329247686),c(751.6271114191567,555.1386248358457,490.3287259658815,663.9045207215297,3531.013439577045,1443.0899491909227),c(3013.599267482468,2606.8575754688222,3116.8122343092723,2185.3990294239898,6359.604045054464,2583.8725177212964),c(373.78760662219514,149.566274129327,62.1652901383051,50.380612870942386,1310.349322804684,203.0592971984065),c(225.89332324322362,101.85187992856012,93.24793520745766,336.9903216478591,2331.9598124592976,577.2359796763691),c(638.173962525699,105.52221794400373,116.55991900932207,225.033404156876,539.6791281423137,365.05042192971956),c(2429.1129557724225,1806.723888102116,1694.781222395543,2766.455431202192,2974.534961142364,1202.3848272310138),c(721.2378751084091,1446.1131780847816,1080.1219161530512,812.8072209845373,2254.2628173570965,390.1476384373878),c(504.4613227584097,608.358526059778,414.9533116731866,162.33753036192547,591.12713841269,304.58894579760977),c(472.046137360279,232.1488794768082,171.73161400706786,85.08725729314715,594.277016592509,142.59782106629672),c(948.1441728953243,634.0508921678833,466.2396760372883,719.8829794670213,1734.5329176869695,811.0964062250956),c(162.07592699065373,203.70375985712025,145.31136569828817,116.43519419062241,265.639726498065,131.18999538099297),c(557.1359990303722,653.3201667489622,286.7374007629323,77.25027306877833,1468.8931911889047,205.34086233546725),c(444.69582468060617,138.5552600829962,72.26714978577968,113.07648666589292,963.8627230245994,386.72529073179663),c(45.58385446612136,200.0334218416766,7058.868695204545,218.315989107417,257.2400513518811,150.58329904600933),c(2136.3633126455543,2000.3342184167664,15537.437203942633,3373.2619240033205,2602.8493359237273,3053.87493595581),c(1535.669408236444,523.0231672007142,4029.0878670888997,535.1540656068992,713.9723874256291,546.434850326049),c(1477.9298592460236,697.3642229342855,2831.6289657997977,229.51168085651534,687.7234025938045,592.0661530672639),c(1160.8688270705572,995.5791866890786,3203.0665743761706,1005.3731190690281,669.8740929081638,782.5768420118363),c(37.48005811658867,197.28066833009393,3291.6521128232553,426.5558556406456,15.749390899094761,5.703912842651868),c(1027.156187303268,1880.1306484109882,9306.143933704274,658.3066748469805,1065.7087841720788,731.2416264279695),c(216.77655234999935,44.04405618532329,2150.1419726586278,450.066808313752,183.7428938227722,252.11294764521259),c(813.4185585843434,243.159893523139,289.0685991431187,171.29408376120412,1205.3533834773857,219.03025315783174),c(3371.1792814055975,2709.6270399012433,2352.956231734848,1842.8108619015816,670.9240523014369,1995.2287123596234),c(166.12782516542006,125.70907702894357,87.03140619362715,57.09802792040138,276.1393204307948,101.52964859920326),c(1141.622310740417,1047.8815034091501,385.4247988574916,697.4915959688246,1699.884257708961,698.1589319405887),c(1297.6203904689214,1082.7497145558643,576.5830660327798,269.81617115326924,2050.570695062138,918.3299676669508),c(1029.182136390651,939.6065319535636,660.5062077194917,761.307038938685,346.48659978008476,315.9967714829135),c(752.6400859628483,435.85263933392844,178.72520914762717,59.33716627022103,145.9443556649448,169.97660271102566),c(345.42431939883073,440.44056185323296,223.01797837116956,482.5343143861371,306.5881428357113,190.5106889445724),c(848.8726676135489,779.9468282817667,371.437608576373,171.29408376120412,1111.90699747609,508.78902556454665),c(2294.387341461442,1202.0357000577815,704.0219108163053,475.81689933667815,934.4638600129558,393.5699861429789),c(374.80058116588674,569.8199768976201,425.05517132066115,230.63125003142517,116.54549265330122,201.91851462987614),c(860.0153875941563,1034.1177358512366,1091.7779080539833,1162.1128035564045,726.5719001449049,741.5086695447428),c(587.5252353411198,637.7212301833268,271.97314435508486,41.42405947166374,301.3383458693464,155.1464293201308),c(1012.9745436915858,687.2707933918156,422.7239729404747,619.1217537251365,301.3383458693464,689.0326713923457),c(717.1859769336428,1421.338396480537,1000.0841050999834,1055.7537319399705,561.7282754010465,1031.2674419514578),c(2458.489217539479,1177.2609184535372,1569.673575992204,924.7641384755203,323.3874931280791,806.5332759509741),c(244.1268650296722,14.681352061774431,3.885330633644069,1.1195691749098309,0.0,0.0),c(175.24459605864433,322.0721608551766,119.66818351623732,51.50018204585222,115.49553326002824,144.87938620335746),c(688.8226897102784,479.89669551925175,225.349176751356,163.4570995368353,855.716905517482,214.46712288371023),c(2841.393595054898,2289.3733371329504,2920.991570373611,1982.7570087653105,2088.3692332199653,2482.342869122093),c(1466.7871392654163,991.908848673635,1199.0130335425597,966.188197947184,745.4711692238187,1824.1113270800674),c(514.5910681953255,156.90695016021422,150.75082858538988,70.53285801931935,448.3326609275642,213.32634031517986),c(1515.4099173626123,1124.958601733466,1369.9675814228988,1700.625576688033,2848.5398339496055,2611.2512993660253),c(924.8457583904178,401.9020126910751,223.01797837116956,162.33753036192547,174.29325928331536,389.00685586885743),c(503.4483482147181,423.0064562798758,195.8206639356611,160.09839201210582,201.59220350841292,256.6760779193341),c(956.247969244857,649.6498287335186,490.3287259658815,286.6097087769167,216.2916350142347,228.15651370607472),c(1605.5646517511634,1377.294340295214,1280.6049768490852,948.2750911486268,996.4114642160619,1097.4328309262194),c(198.5430105635508,284.4511961968796,294.50806203022046,225.033404156876,3484.815226273034,854.4461438292499),c(1113.2590235170528,1200.2005310500597,804.2634411643223,690.7741809193657,297.1385082962545,495.09963474218216),c(1593.4089572268645,1894.8120004727625,1670.6921724669496,727.71996369139,1395.3960336597959,1263.987085931654),c(1107.1811762549032,111.94530947103004,46.62396760372883,89.56553399278647,876.7160933829417,347.93868340176397),c(826.587227652334,736.8203566003043,304.609921677695,136.58743933899936,926.0641848667719,645.6829337881915),c(408.2287411077091,245.91264703472172,107.2351254885763,996.4165656697495,325.48741191462506,70.72851924888316),c(137.76453794205565,53.21990122393231,37.299174082983065,71.65242719422918,198.442325328594,207.622427472528),c(1962.1316911306017,1440.607671061616,817.4735653187121,1237.1239382753631,701.3728747063533,552.1387631687008),c(0.0,20.186859084939844,6.993595140559324,5.597845874549154,4.199837573091936,3.422347705591121),c(1425.2551829740612,983.6505881388869,550.1628177240002,597.8499394018497,1146.5556574540985,319.4191191885046),c(1585.3051608773317,1226.810481662026,563.3729418783901,1144.199696757847,1309.2993634114112,864.7131869460233),c(1004.8707473420532,1548.8826425172026,1301.585762270763,1007.6122574188478,1835.3290194411761,570.3912842651869),c(2469.631937520086,1164.4147353994845,504.3159162470002,300.0445388758347,364.3359094657255,733.5231915650303),c(495.34455186518545,617.534371098387,453.80661800962724,382.89265781916214,1329.2485918835978,742.6494521132732),c(332.2556503308401,754.2544621736614,359.00455054871196,180.25063716048277,933.4139006196829,579.5175448134298),c(1509.332070100463,1862.696542837631,1913.9138701330685,1271.830582697568,411.5840821630097,2513.143998472413),c(1408.0346157313043,689.1059623995374,329.47603773301705,104.11993326661427,1331.3485106701437,335.39007514792985),c(904.5862675165861,1118.5355102064395,686.9264560282714,418.7188714162767,432.5832700284694,304.58894579760977),c(235.0100941364479,87.17052786678569,38.85330633644069,34.70664442220476,58.797726023287105,45.631302741214945),c(2101.9221781600404,2888.5560181541196,2600.063260034611,2346.6169906110053,967.0126012044183,1186.4138712715885),c(1568.0845936345747,1195.6126085307553,1021.8419566483901,419.83844059118655,390.5848942975501,576.0951971078387),c(541.9413808749983,506.5066461312179,235.45103639883058,59.33716627022103,1716.6836080013288,258.95764305639483),c(769.8606532056052,950.6175459998944,602.2262482148307,625.8391687745955,365.38586885899844,343.3755531276425),c(1520.4747900810703,1525.0254454168191,774.7349283486274,315.71850732457233,2431.705954820231,914.9076199613596),c(1216.5824269735945,1906.7405990229543,1104.2109660816445,909.0901700267826,1706.184014068599,1435.10447121121),c(1335.10044858551,727.6445115616953,889.7407151044919,315.71850732457233,191.0926095756831,400.4146815541611),c(643.238835244157,134.8849220675526,49.732232110644084,95.16337986733562,1440.5442875705342,286.3364247011238),c(1490.0855537703228,1362.6129882334394,1036.6062130562377,3176.2177492191904,700.3229153130803,1422.555862957376),c(2844.432518685973,2146.2301545306495,1696.3353546490005,1506.9401094286325,2347.709203358392,2549.649040665385),c(363.6578611852793,629.4629696485788,390.86426174459336,425.43628646573575,582.7274632665061,779.1544943062452),c(692.8745878850447,1246.9973407469658,598.3409175811867,696.3720267939148,150.1441932380367,297.7442503864275),c(42.5449308350466,576.2430684246465,223.79504449789837,15.673968448737632,27.298944225097586,180.24364582779904),c(1904.3921421401812,745.9962016389132,299.94752491732214,97.40251821715529,37.79853815782742,361.62807422412845),c(757.7049586813062,776.2764902663231,549.3857515972713,278.7727245525479,458.83225486029403,795.1254502656705),c(342.385395767756,111.94530947103004,61.38822401157629,107.47864079134376,354.8862749262686,101.52964859920326),c(1227.725146954202,781.7819972894885,508.20124688064425,2232.4209347702026,1721.9334049676938,477.98789621422657),c(1801.0687386836396,1342.4261291484995,806.5946395445087,385.13179616898185,700.3229153130803,1601.6587262166445),c(328.2037521560738,459.70983643431185,170.17748175361024,576.578125078563,742.3212910439997,106.09277887332475),c(1488.0596046829396,1755.3391558859055,2370.051686522882,1905.5067356965321,1556.0398208305623,2031.7337545525954),c(1062.6102963324736,523.0231672007142,243.22169766611873,316.83807649948216,581.6775038732331,163.13190729984342),c(707.0562314967269,781.7819972894885,520.6343049083052,213.8377124077777,655.174661402342,854.4461438292499),c(2642.8505844913475,1181.8488409728418,1150.0578675586444,531.7953580821696,1277.8005816132215,1088.3065703779764),c(1627.8500917123783,1634.2180013762663,1056.032866224458,946.0359527988071,572.2278693337763,1830.9560224912498),c(1134.5314889345761,1027.6946443242102,616.9905046226781,214.95728158268753,390.5848942975501,635.4158906714181),c(287.6847704084104,523.0231672007142,254.10062344032212,156.73968448737634,1053.109271452803,434.63815861007237),c(1790.9389932467236,2175.5928586541986,981.4345180584918,1049.0363168905114,3734.705561872004,859.0092741033714),c(3654.8121536392414,1306.6403334979243,1337.3308041002886,987.4600122704709,4364.681197835795,1808.1403711206422),c(459.89044283597997,1424.0911499921199,751.422944546763,826.2420510834552,1251.551596781397,392.42920357444854),c(130.67371613621458,485.4022025424171,255.65475569377975,91.80467234260612,519.7298996701271,161.99112473131305),c(1703.8231824892473,2037.9551830750631,1887.4936218242888,2236.899211469842,2307.810746414019,1446.5122968965138),c(1116.2979471481276,757.924800189105,722.6714978577968,879.9813714791271,1479.3927851216345,1147.6272639415558),c(427.4752574378492,286.2863652046014,116.55991900932207,45.90233617130306,344.3866809935388,232.71964398019622),c(2173.843370762143,1475.4758822083304,693.9200511688307,509.403974583973,591.12713841269,909.2037071187078),c(1799.0427895962564,2292.126090644533,1910.0285394994244,1204.656432202978,2834.890361837057,1597.095595942523),c(57.73954899042039,59.642992750958626,77.70661267288138,144.42442356336818,266.68968589133794,376.4582476150233),c(31.40221085443916,328.4952523822029,168.62334950015259,419.83844059118655,161.69374656403954,239.56433939137847),c(1948.9630220626111,1323.1568545674206,1077.7907177728648,2489.9218449994637,2485.2538838771534,1306.196040967278),c(1394.8659466633137,1537.8716284708717,799.6010444039495,736.6765170906688,1465.7433130090858,1152.1903942156773),c(1307.7501359058372,1436.9373330461724,801.1551766574071,2168.6054918003424,1603.2879935278465,812.237188793626),c(629.0571916324748,861.6118491253869,529.1820323023222,588.893386002571,2536.7018941475294,890.9511860222218),c(1710.9140042950885,1155.2388903608755,630.9776949037968,1099.416929761454,186.89277200259116,304.58894579760977),c(1326.9966522359773,1000.1671092083832,641.8566206780002,184.7289138601221,2421.206360887501,822.5042319103994),c(1435.3849284109772,3748.3326982717845,4339.914317780425,3418.0446909997136,4399.329857813803,3227.273886372427),c(160.04997790327056,191.7751613069285,106.45805936184749,60.45673544513087,754.9208037632756,319.4191191885046),c(1926.6775821013962,1869.1196343646573,1510.616550360814,2094.7139262562937,2226.963873131999,3739.485259642565),c(1495.1504264887806,1171.7554114303719,684.595257648085,353.78385927150657,562.7782347943195,633.1343255343573),c(220.8284505247657,745.0786171350524,586.6849256802544,703.0894418433738,369.5857064320904,1063.2093538703082),c(350.48919211728867,386.3030761254397,293.73099590349165,201.52245148376954,192.14256896895608,1055.2238758905955),c(1556.9418736539674,683.600455376372,455.36075026308487,96.28294904224546,661.4744177619799,434.63815861007237),c(1351.3080412845754,1340.5909601407777,801.1551766574071,784.8179916117914,996.4114642160619,957.1165749969834),c(141.81643611682202,273.44018215054876,88.58553844708477,67.17415049458985,111.29569568693631,168.8358201424953),c(321.1129303502327,122.95632351736086,103.34979485493224,120.91347089026173,222.59139137387263,325.12303203115647),c(408.2287411077091,969.8868205809733,500.4305856133561,201.52245148376954,845.2173115847521,1154.4719593527382),c(632.0961152635496,913.9141658454583,627.0923642701528,923.6445693006104,2629.098320755552,1297.0697804190347),c(419.3714610883165,1125.8761862373267,663.614472226407,380.6535194693425,31.498781798189523,165.4134724369042),c(2268.0500033254607,1045.1287498975673,452.2524857561696,523.9583738578009,552.2786408615896,2312.3662664110675),c(555.110049942989,506.5066461312179,293.73099590349165,928.1228460002498,3220.225459168242,822.5042319103994),c(1121.3628198665854,836.8370675211426,657.3979432125765,7802.277579946612,1162.3050483531933,879.5433603369181),c(236.0230686801395,363.3634635289172,1488.0816326856784,144.42442356336818,71.39723874256292,124.34529996981072),c(605.7587771275684,468.8856814729209,6478.40029853812,303.40324640056417,1237.9021246688483,706.1444099203013),c(841.7818458077078,542.2924417817931,2012.6012682276278,345.9468750471377,627.8757171772445,785.9991897174274),c(2798.8486642198513,1347.014051667804,2490.496936165848,923.6445693006104,590.077179019417,1128.2339602765396),c(2677.2917189768614,1072.6562850133944,3593.153769994035,303.40324640056417,1388.046317906885,793.98466769714),c(2735.0312679672816,1466.3000371697212,2937.309959034916,509.403974583973,2694.195803138477,1176.1468281548152),c(962.3258165070065,1082.7497145558643,404.851452025712,169.05494541138447,2221.714076165634,764.3243209153503),c(122.56991978668188,608.358526059778,305.3869878044238,137.7070085139092,1790.1807655304378,500.803547584834),c(1488.0596046829396,1992.0759578820182,2098.855608294526,1768.9192963575329,3197.1263525162362,2663.7272975184223),c(2064.4421200434517,1190.1071015075897,1659.8132466927464,2246.9753340440307,1720.8834455744209,2749.2859901582005),c(88.12878530116797,350.51728047486455,142.20310119137292,34.70664442220476,485.08123969211863,203.0592971984065),c(535.8635336128489,200.0334218416766,115.78285288259326,99.64165656697494,383.23517854463915,265.80233846757704),c(1571.1235172656495,817.5677929400637,511.3095113875595,52.619751220762055,24.149066045278634,148.30173390894856),c(935.9884783710253,1068.0683624940898,406.4055842791696,94.0438106924258,206.84200047477785,154.00564675160044),c(1422.2162593429864,1251.5852632662702,621.652901383051,710.9264260677426,1541.3403893247405,2475.4981737109106),c(508.51322093317606,1246.0797562431048,756.0853413071359,1006.492688243938,328.637290094444,622.867282417584),c(520.6689154574751,88.08811237064658,62.1652901383051,61.5763046200407,282.4390767904327,120.9229522642196),c(1752.4459605864433,2624.29168104218,1355.98039114178,2564.9329797184228,4369.930994802159,1403.1625592923597),c(586.5122607974282,591.8420049902818,379.2082698436611,191.44632890958107,379.0353409715472,314.85598891438315),c(2946.742947598823,1851.6855287913002,1429.0246070542887,1969.3221786663926,1535.0406329651028,2218.822095791577),c(167.14079970911166,359.69312551347355,139.8719028111865,88.44596481787664,12.599512719275808,55.89834585798831),c(813.4185585843434,907.4910743184321,477.11860181149166,474.69733016176826,738.1214534709078,1076.8987446926726),c(2046.2085782570034,1815.899733140725,1770.1566366882378,850.8725729314715,1810.1299940026245,2548.5082580968547),c(2850.5103659481224,2296.7140131638375,1804.3475462643057,2936.6299457884866,689.8233213803505,1080.3210923982638),c(1221.6472996920525,1376.376755791353,938.6958810884071,283.2510012521872,463.03209243338597,273.7878164472897),c(536.8765081565405,232.1488794768082,105.68099323511868,57.09802792040138,478.7814833324807,118.64138712715885),c(1182.1412924880806,817.5677929400637,578.1371982862374,642.6327063982429,2421.206360887501,751.7757126615162),c(7.0908218058411006,2.7527535115827058,268.08781372144074,27.989229372745772,5.24979696636492,6.844695411182242),c(1641.018760780369,410.1602732258232,749.8688122933054,789.2962683114308,722.372062571813,979.9322263675909),c(827.6002021960256,414.7481957451277,191.935333302017,126.51131676481089,526.029656029765,339.9532054220513),c(1646.0836334988269,774.4413212586013,527.6279000488646,431.0341323402849,758.0706819430944,1577.7022922775068),c(1168.97262342009,719.3862510269471,502.7617839935425,313.4793689747527,3707.406617646907,1550.3235106327777),c(1548.8380773044346,695.5290539265637,739.7669526458308,1344.602579066707,642.5751486830662,512.2113732701378),c(1971.248462023826,787.2875043126538,404.07438589898317,286.6097087769167,813.7185297865626,447.1867668639065),c(1032.2210600217259,567.0672233860374,198.15186231584752,111.95691749098309,398.98456944373396,160.85034216278268),c(595.6290316906525,980.8978346273042,487.9975275856951,433.27327069010454,1058.359068419168,334.2492925793995),c(2267.037028781769,1135.0520312759356,1481.865103671848,306.76195392529365,780.1198292018271,633.1343255343573),c(1929.716505732471,1340.5909601407777,1130.631214390424,375.05567359479335,375.8854627917283,1074.617179555612),c(424.4363338067744,678.0949483532065,453.80661800962724,184.7289138601221,185.84281260931817,1746.538112420002),c(2622.5910936175155,557.8913783474284,291.39979752330515,341.4685983474984,598.4768541656009,212.1855577466495),c(3198.973608978028,1736.0698813048266,1425.1392764206446,698.6111651437345,2537.7518535408026,1184.1323061345279),c(1358.3988630904166,978.1450811157215,788.722118629746,535.1540656068992,1202.2035052975668,515.6337209757289),c(2634.7467881418147,1479.146220223774,611.5510417355765,529.55621973235,3282.1730633713482,1448.7938620335744),c(101.29745436915857,244.99506253086082,131.32417541716953,59.33716627022103,454.6324172872021,65.0246064062313),c(3157.441652686673,1060.7276864632026,1310.9105557915088,1081.5038229628967,545.9788845019517,1381.4876904902824),c(2409.8664394422826,1353.4371431948305,1188.1341077683562,2813.477336548405,5927.020775025995,3609.436046830102),c(420.3844356320081,114.69806298261274,89.36260457381358,41.42405947166374,497.68075241139445,130.0492128124626),c(473.0591119039706,422.0888717760149,163.9609527397797,78.36984224368817,229.9411071267835,441.4828540212546),c(909.6511402350441,514.764906665966,160.85268823286447,54.85888957058171,82.94679206856574,75.29164952300466),c(875.2100057495302,825.8260534748117,1097.9944370678138,1393.8636227627394,1711.433811034964,1502.410642754502),c(1265.2052050707907,596.4299275095863,292.95392977676283,153.38097696264683,489.28107726521057,467.7208530974532))
targetgene="safe_target"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1959.0927674995269,635.886061175605,255.65475569377975,466.8603459373995,746.5211286170917,606.8963264581588),c(803.2888131474275,272.52259764668787,578.9142644129663,85.08725729314715,285.5889549702517,203.0592971984065),c(1552.889975479201,674.4246103377629,958.1225342566274,1012.0905341184871,586.927300839598,216.748688020771),c(2474.696810238544,2886.7208491463975,2506.8153248271533,1794.6693873804588,1775.481334024616,762.0427557782896),c(656.4075043121476,1034.1177358512366,1264.2865881877801,487.0125910857764,3106.8298446947597,1182.9915235659976),c(1147.7001580025667,576.2430684246465,764.6330687011528,705.3285801931935,2824.3907679043273,683.3287585496938),c(778.9774240988295,602.8530190366126,397.85785688515267,397.44705709298995,260.38992953170003,394.7107687115093),c(1628.86306625607,1781.9491064978715,1498.183492333153,925.8837076504301,264.589767104792,970.805965819348),c(771.8866022929884,1755.3391558859055,1986.958086045577,906.851031676963,419.9837573091936,1514.9592510083362),c(2694.512286219618,2681.1819202815554,1799.6851495039327,728.8395328662999,371.68562521863635,3329.9443175401607),c(790.120144079437,912.0789968377366,1038.937411436424,1728.6148060607788,461.98213304011296,1287.9435198707918),c(2718.8236752682164,1750.751233366601,2112.842798575645,950.5142294984464,1887.8269891048253,1994.087929791093),c(360.61893755420454,1035.9529048589584,1934.8946555547464,3027.3150489561826,1016.3606926882486,508.78902556454665),c(446.72177376798936,630.3805541524397,523.7425694152205,238.468234255794,110.24573629366333,106.09277887332475),c(1010.9485946042026,1011.1781232547139,781.7285234891867,522.838804682891,2508.352990529159,1424.8374280944367),c(13.168669067990615,180.7641472605977,136.76363830427124,40.30449029675391,10.49959393272984,256.6760779193341),c(250.2047122918217,349.59969597100365,157.7444237259492,216.07685075759736,82.94679206856574,55.89834585798831),c(904.5862675165861,1068.9859469979508,1586.7690307802377,1382.6679310136412,4934.809148383025,1626.7559427243127),c(1520.4747900810703,1184.6015944844244,609.9969094821189,554.1867415803663,2376.0581069767627,1449.934644602105),c(119.53099615560713,670.7542723223194,842.3396813740342,1515.896662827911,249.8903355989702,1300.4921281246259),c(81.03796349532686,422.0888717760149,582.7995950466103,126.51131676481089,33.59870058473549,215.60790545224063),c(513.578093651634,1110.2772496716914,1058.3640646046445,671.7415049458986,862.0166618771199,342.23477055911206),c(776.9514750114463,703.7873144613118,474.7874034313052,752.3504855394063,198.442325328594,67.30617154329204),c(993.7280273614457,667.0839343068757,747.5376139131189,606.8064928011283,12.599512719275808,126.62686510687148),c(877.2359548369133,865.2821871408305,462.35434540364423,1093.8190838869048,314.9878179818952,573.8136319707779),c(1344.2172194787343,1040.5408273782627,991.5363777059664,191.44632890958107,1310.349322804684,2028.3114068470043),c(602.7198534964936,782.6995817933494,592.1243885673562,251.90306435471194,1789.1308061371649,1408.8664721350115),c(1923.6386584703214,1839.7569302411084,1136.8477434042545,2148.4532466519654,2818.091011544689,1287.9435198707918),c(3049.0533765116734,1941.6088101696685,1553.3551873308988,951.6337986733563,1308.2494040181382,1455.6385574447568),c(367.70975936004567,274.35776665440966,241.6675654126611,334.75118329803945,171.1433811034964,112.93747428450699),c(21.2724654175233,401.9020126910751,286.7374007629323,115.31562501571258,8.399675146183872,31.94191191885046),c(554.0970753992974,1234.151157692913,977.5491874248478,2288.399393515694,288.7388331500706,237.2827742543177),c(604.7458025838768,664.331180795293,1080.89898227978,1149.7975426323962,1347.0979015692385,357.0649439500069),c(1411.073539362379,1313.0634250249507,900.6196408786952,1025.525364217405,1630.5869377529443,470.0024182345139),c(1678.4988188969576,1099.2662356253607,860.2122022887969,665.0240898964396,2086.2693144334194,1164.7390024695114),c(1674.4469207221914,1776.4435994747062,1022.619022775119,772.5027306877834,1902.5264206106472,2461.8087828885464),c(494.33157732149385,363.3634635289172,604.5574465950172,55.978458745491544,108.14581750711736,28.51956421325934),c(1624.8111680813035,2467.3847308819654,2495.93639905295,2656.7376520610287,1245.251840421759,2402.488089324967),c(1594.421931770556,991.908848673635,586.6849256802544,1267.3523059979286,2254.2628173570965,1720.3001133438033),c(466.98126464182104,1636.9707548878491,766.9642670813392,221.67469663214652,406.3342851966448,779.1544943062452),c(1381.697277595323,1002.9198627199659,787.9450525030172,719.8829794670213,397.93461005046095,322.84146689409573),c(3144.2729836186822,1840.6745147449694,2189.772345121797,2268.2471483673175,2760.343244914675,1268.5502162057755),c(399.1119702144848,513.8473221621051,219.1326477375255,284.37057042709705,304.48822404916535,180.24364582779904),c(1735.2253933436864,1481.8989737353565,1960.5378377367972,2126.0618631537686,2346.6592439651195,3715.5288257034267),c(362.64488664158773,438.6053928455111,181.83347365454244,156.73968448737634,535.4792905692219,219.03025315783174),c(3120.974569113776,3427.1781219204686,3360.81099810212,2966.8583135110516,6291.35668449172,4728.543746558399),c(4257.5320071357355,7066.318264232806,7613.693909688917,9665.24068699657,5160.550417936716,4769.611919025492),c(1009.935620060511,240.40714001155632,218.3555816107967,128.75045511463054,91.34646721474961,219.03025315783174),c(438.61797741845663,525.7759207122969,299.94752491732214,113.07648666589292,781.1697885951002,613.741021869341),c(870.1451330310722,1280.0303828859583,1071.5741887590343,1493.5052793297143,429.4333918486505,707.2851924888316),c(82.05093803901845,435.85263933392844,345.01736026759335,150.02226943791734,1194.853789544656,1001.607095169668),c(1721.0437497320042,749.6665396543569,606.1115788484748,1006.492688243938,1306.149485231592,1250.2976951092894),c(670.5891479238298,955.2054685191989,482.5580646985934,438.8711165646537,207.89195986805083,561.2650237169438),c(61.79144716518673,318.401822839733,329.47603773301705,147.78313108809766,164.8436247438585,253.25373021374295),c(1676.4728698095744,1717.7181912276085,1080.89898227978,640.3935680484233,1573.889130516203,2402.488089324967),c(1762.5757060233593,868.0349406524133,760.7477380675087,1721.89739101132,752.8208849767295,678.7656282755723),c(469.00721372920424,534.9517657509058,356.6733521685255,166.8158070615648,400.0345288370069,187.0883412389813),c(435.5790537873819,955.2054685191989,655.8438109591189,2066.724696883548,791.66938252783,402.6962466912219),c(953.2090456137822,878.1283701948831,721.1173656043392,895.6553399278647,1657.8858819780419,520.1968512498504),c(1268.2441287018655,823.073299963229,781.7285234891867,461.26250006285034,96.59626418111453,675.3432805699812),c(2836.32872233644,2480.230913936018,2352.1791656081195,2019.7027915373349,1161.2550889599204,1605.0810739222356),c(399.1119702144848,241.32472451541722,99.46446422128817,26.86966019783594,1.049959393272984,11.407825685303736),c(522.6948645448583,491.82529406944343,271.97314435508486,111.95691749098309,45.14825391073831,220.1710357263621),c(1208.478630624062,1760.8446629090708,1965.2002344971702,1475.592172531157,681.4236462341667,1496.7067299118503),c(1029.182136390651,741.4082791196088,1050.5934033373562,472.4581918119486,1150.7554950271906,1154.4719593527382),c(330.229701243457,525.7759207122969,179.50227527435598,61.5763046200407,376.93542218500124,61.60225870064018),c(1061.597321788782,882.7162927141877,865.6516651758985,1930.1372575445484,1252.60155617467,1566.294466592203),c(808.3536858658855,1156.1564748647365,1824.5512655592547,2843.7057042709703,3316.8217233493565,654.8091943364344),c(3667.980822707232,2687.605011808582,2652.1266905254415,1792.4302490306393,1967.623902993572,2741.3005121784877),c(729.3416714579417,783.6171662972102,1338.8849363537463,976.2643205213725,2219.6141573790883,814.5187539306868),c(2726.927471617749,1644.3114309187363,2259.7082965273908,2392.519326782309,1583.33876505566,3587.761178028025),c(1486.0336555955564,442.27573086095475,4964.675483670391,356.0229976213262,1041.5597181268001,1039.2529199311705),c(2249.816461539012,658.8256737721276,713.346704337051,476.936468511588,2726.7445443299393,1392.8955161755862),c(738.458442351166,621.2047091138306,1470.2091117709158,441.1102549144734,766.4703570892783,407.2593769653434),c(2450.385421189946,928.5955179072328,1533.9285341626785,706.4481493681033,978.5621545304211,824.7857970474602),c(1142.6352852841087,793.7105958396802,690.0347205351867,677.3393508204476,2937.7863823778093,1256.0016079519414),c(68.88226897102783,337.6710974208119,169.4004156268814,44.782766996393235,146.99431505821778,19.39330366501635),c(719.2119260210259,304.63805528181945,104.12686098166105,285.4901396020069,194.24248775550205,246.4090348025607),c(1779.7962732661163,2773.8579551715065,2398.0260670851194,2043.2137442104413,1640.0365722924012,1294.788215281974),c(1611.642499013313,2779.363462194672,1369.19051529617,1486.7878642802555,1554.9898614372894,2809.74746629031),c(554.0970753992974,1043.2935808898455,818.250631445441,579.9368326032924,80.84687328201977,180.24364582779904),c(1246.9716632843422,1077.244207532699,1322.5665476924412,1335.6460256674281,330.73720888098995,1217.2150006219088),c(421.3974101756997,787.2875043126538,599.8950498346443,254.1422027045316,260.38992953170003,424.371115493299),c(502.4353736710266,668.0015188107366,421.9469068137459,114.19605584080276,1505.641769953459,224.7341660004836),c(1139.596361653034,991.908848673635,501.2076517400849,429.91456316537506,710.8225092458102,595.488500772855),c(75.97309077686893,467.0505124651991,209.03078809005092,163.4570995368353,360.13607189263354,82.1363449341869),c(1135.5444634782677,1155.2388903608755,1536.2597325428649,1873.039229624147,2243.763223424367,1331.2932574749461),c(1942.8851748004615,1183.6840099805636,1260.401257554136,751.2309163644965,298.18846768952744,1226.3412611701517),c(1007.9096709731278,1045.1287498975673,1740.628123872543,1401.7006069871084,220.49147258732665,144.87938620335746),c(2086.727560004667,1526.860614424541,2114.3969308291025,2683.6073122588646,690.8732807736235,4798.131483238752),c(405.1898174766343,310.14356230498487,201.26012682276277,182.48977551030242,459.882214253567,95.82573575655138),c(808.3536858658855,349.59969597100365,460.8002131501866,339.22945999767876,207.89195986805083,433.497376041542),c(869.1321584873806,1273.607291358932,978.3262535515765,388.49050369371133,779.0698698085541,411.82250723946487),c(1071.7270672256977,1776.4435994747062,1863.4045718956954,738.9156554404884,785.3696261681921,1557.16820604396),c(276.5420504278029,1101.1014046330824,1184.2487771347123,1034.4819176166836,3103.679966514941,1080.3210923982638),c(976.5074601186888,661.5784272837103,1237.8663398790004,2896.3254554917326,278.23923921734075,546.434850326049),c(847.8596930698573,944.1944544728681,1163.2679917130342,634.7957221738741,1145.5056980608256,833.9120575957031),c(236.0230686801395,30.280288627409764,42.73863697008476,3.3587075247294926,0.0,0.0),c(2379.477203131535,3487.7386991752883,9958.102414029749,7575.005037439916,2817.0410521514164,3512.46952850502),c(372.7746320785036,536.7869347586277,1956.652507103153,1332.2873181426987,116.54549265330122,379.8805953206144),c(566.2527699235965,456.95708292272917,8467.689582963883,2198.833859522908,247.79041681242424,528.182329229563),c(191.4521887577097,497.33080109260885,3993.342825259374,214.95728158268753,619.4760420310606,95.82573575655138),c(1880.0807530915831,1746.1633108472963,7265.56828491441,1967.0830403165728,1872.0775982057305,1601.6587262166445),c(1319.9058304301363,1226.810481662026,2465.630820110526,4096.5036109950715,1158.1052107801013,1968.9907132834248),c(745.5492641570072,445.02848437253743,2329.644247932984,156.73968448737634,124.9451677994851,327.4045971682172),c(644.2518097878485,688.1883778956765,8679.82863556085,1831.6151701524834,314.9878179818952,166.55425500543456),c(1604.5516772074718,1257.0907702894356,17055.824415570733,3435.957797798271,1729.2831207206048,2951.2045047880765),c(2145.4800835387787,626.710216136996,5604.977972094934,953.872937023176,171.1433811034964,1899.4029766030721),c(387.96925023387735,316.5666538320112,907.6132360192545,179.13106798557294,328.637290094444,276.0693815843504),c(326.17780306869065,216.54994291117285,401.74318751879673,55.978458745491544,4.199837573091936,25.09721650766822),c(2730.979369792515,2198.5324712507213,1478.7568391649327,431.0341323402849,1909.8761363635579,2162.9237499335886),c(3331.6732742016256,2211.3786543047736,11337.394788973394,4539.853004259364,2783.442351566681,1845.7861958821445),c(414.3065883698586,447.7812378841202,1284.4903074827291,269.81617115326924,1208.5032616572046,764.3243209153503),c(830.6391258271003,1091.0079750906125,13941.343379641648,360.50127432096554,3712.6564146132714,785.9991897174274),c(279.5809740588777,275.2753511582706,4772.740150368374,998.6557040195692,39.89845694437339,44.49052017268457),c(4408.465214145781,4459.460688763984,5796.913305396951,6772.273939029567,2613.3489298564573,4252.837415481233),c(2696.5382353070013,1080.9145455481425,1296.1462993836615,2154.051092526515,5890.2721962614405,2116.151664623843),c(1716.9918515572379,1596.5970367179693,4712.906058610256,963.9490595973643,1322.9488355239598,949.1310970172708),c(3577.826088318681,2076.493732237221,3670.8603826669164,1634.5709953683531,1796.4805218900758,1133.9378731191914),c(1429.3070811488276,1627.7949098492402,9417.264389826494,3994.6228160782766,4570.4732389173,3687.009261490168),c(405.1898174766343,1836.0865922256648,4669.390355513442,1537.1684771511977,2777.1425952070426,422.08955035623825),c(1817.276331382705,1232.3159886851913,1498.960558459882,2466.4108923263575,135.44476173221494,608.0371090266891),c(603.7328280401852,481.73186452697354,1885.939489570831,816.1659285092667,550.1787220750437,492.8180696051214))
targetgene="non_target"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1070.7140926820061,1263.513861816462,1052.9246017175426,3743.8393208984744,3002.8838647607345,2176.613140755953),c(690.8486387976615,1622.2894028260746,2864.265743122408,1477.8313108809768,2279.4618427956484,670.7801502958597),c(1382.7102521390145,2071.905809717917,874.1993925699155,398.5666262678998,969.1125199909643,910.3444896872381),c(639.1869370693906,416.5833647528495,507.42418075391544,88.44596481787664,47.24817269728428,863.5724043774928),c(2436.2037775782637,1288.2886434207064,686.9264560282714,424.3167172908259,699.2729559198074,1351.8273437084927),c(1109.2071253422864,1458.959361138834,1212.2231576969496,1225.9282465262647,300.2883864760734,2735.596599335836),c(412.2806392824754,315.6490693281503,120.44524964296615,96.28294904224546,751.7709255834566,175.68051555367754),c(120.54397069929871,91.75845038609019,65.27355464522036,51.50018204585222,31.498781798189523,177.96208069073828),c(795.1850167978948,272.52259764668787,333.3613683666611,132.10916263936005,314.9878179818952,213.32634031517986),c(414.3065883698586,612.9464485790825,278.96673949564416,33.587075247294926,101.84606114747945,114.07825685303736),c(849.8856421572405,748.748955150496,400.1890552653391,123.1526092400814,117.59545204657421,120.9229522642196),c(1316.8669067990616,1401.1515373955972,1310.9105557915088,479.17560686140763,2903.137722399801,1092.869700652098),c(1131.4925653035014,478.0615265115299,326.3677732261018,649.3501214477019,655.174661402342,1347.2642134343712),c(2392.6458721995255,1273.607291358932,457.69194864327136,614.6434770254972,905.0649970013122,710.7075401944228),c(151.94618155373786,346.8469424594209,177.94814302089836,70.53285801931935,337.03696524062786,216.748688020771),c(948.1441728953243,758.8423846929659,292.95392977676283,105.23950244152411,827.3680018991114,827.0673621845209),c(1152.7650307210247,680.8477018647892,285.96033463620347,139.94614686372887,310.78798040880326,163.13190729984342),c(1403.9827175565379,1340.5909601407777,683.8181915213562,532.9149272570795,734.9715752910888,1514.9592510083362),c(694.9005369724279,442.27573086095475,153.08202696557632,98.52208739206512,312.88789919534923,94.68495318802101),c(518.6429663700919,683.600455376372,687.7035221550002,379.53395029443266,275.0893610375218,722.1153658797265),c(148.90725792266312,32.11545763513157,10.878925774203394,130.98959346445022,2.099918786545968,6.844695411182242),c(962.3258165070065,462.4625899458946,425.05517132066115,279.89229372745774,1332.3984700634167,1366.6575170993876),c(835.7039985455583,543.210026285654,402.52025364552554,138.82657768881904,311.8379398020763,411.82250723946487),c(943.0793001768664,969.8868205809733,369.1064101961866,695.252457619005,472.4817269728428,603.4739787525676),c(864.0672857689227,454.2043294111465,383.870666604034,274.29444785290855,1143.4057792742797,262.37999076198594),c(107.37530163130809,244.99506253086082,112.674588375678,22.391383498196618,1.049959393272984,179.10286325926867),c(479.1369591661201,508.3418151389397,188.82706879510175,117.55476336553224,841.0174740116602,982.2137915046517),c(1774.7314005476583,2246.246865451488,2513.031853840984,2212.2686896218256,1486.7425008745454,1581.124639983098),c(1457.670368372192,1624.1245718337964,2438.433505675018,3001.5649579332567,1988.623090859032,2514.2847810409435),c(1706.862106120322,1050.6342569207327,772.403729968441,690.7741809193657,407.3842445899178,1383.7692556273432),c(2924.457507637608,1722.306113746913,1939.5570523151193,1388.2657768881902,1848.978491553725,2618.0959947772076),c(540.9284063313069,1597.5146212218303,1345.1014653675768,622.4804612498659,1470.9931099754506,832.7712750271728),c(1295.5944413815382,883.6338772180486,1258.0700591739496,794.8941141859799,275.0893610375218,714.1298879000138),c(318.0740067191579,141.3080135945789,98.68739809455936,91.80467234260612,551.2286814683166,83.27712750271728),c(846.8467185261658,348.68211146714276,182.61053978127126,45.90233617130306,732.8716565045429,236.14199168578733),c(456.8515192049052,430.347132310763,444.4818244888815,211.59857405795805,450.43257971411015,258.95764305639483),c(980.559358293455,262.429168104218,142.20310119137292,172.41365293611395,775.9199916287353,417.5264200821168),c(346.43729394252233,557.8913783474284,1597.6479565544412,289.9684163016462,808.4687328201977,354.7833788129462))
targetgene="Atrx"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1115.284972604436,1127.7113552450485,3534.873810489374,1111.732190685462,675.1238898745287,2200.5695746950905),c(1516.422891906304,3699.7007195671567,5621.296360756239,1687.1907465891152,3729.455764905639,1953.0197573239996),c(1745.3551387806024,1776.4435994747062,6434.884595441307,1216.971693126986,3242.2746064269745,3674.4606532363337),c(1097.0514308179875,899.2328137836839,4294.0674163034255,1898.789320647073,687.7234025938045,1909.6700197198454),c(2262.9851306070027,2028.7793380364542,7037.887909782867,1278.5479977470268,526.029656029765,1428.2597758000277),c(829.6261512834087,782.6995817933494,1629.5076677503225,366.0991201955147,793.769301314376,271.50625131022895),c(613.862573477101,281.6984426852969,1428.2475409275598,475.81689933667815,23.09910665200565,171.11738527955603),c(1373.5934812457904,1208.4587915848078,2712.737848410289,323.5554915489411,426.2835136688315,472.28398337157466),c(649.3166825063065,290.8742877239059,5318.240571332001,1165.471511081134,1078.3082968913545,176.8212981222079),c(1775.7443750913499,2261.8458020171233,1453.1136569828818,2226.8230888956537,4499.076000174737,1881.150455506586),c(2280.2056978497594,1237.8214957083567,10198.215847188952,979.623028046102,360.13607189263354,435.77894117860274),c(953.2090456137822,1304.8051644902025,4395.086012778171,467.9799151123093,384.28513793791217,634.2751081028878),c(1877.0418294605086,1280.947967389819,5227.32383450473,2139.496693252687,1183.304236218653,1767.0721986535489),c(3258.7391070558315,2086.587161779691,7638.56002574424,3025.075910606363,2387.607660302766,2359.138351720813),c(822.5353294775676,1145.1454608184056,1288.3756381163732,563.1432949796449,1226.3525713428453,1265.1278685001844),c(140.80346157313042,662.4960117875712,2920.991570373611,197.04417478413023,51.448010270376216,392.42920357444854),c(610.8236498460262,461.5450054420337,8360.454457475307,482.5343143861371,582.7274632665061,1071.1948318500208),c(1560.9937718287338,778.1116592740449,13660.822507892546,2239.138349819662,1588.588562022025,1375.7837776476306),c(1308.7631104495288,583.5837444555336,9312.360462718105,245.18564930525295,1194.853789544656,473.42476594010503),c(1919.586760295555,662.4960117875712,6192.4399639019175,510.52354375888285,1789.1308061371649,1146.4864813730255),c(1398.9178448380799,967.1340670693907,10431.335685207596,696.3720267939148,682.4736056274396,271.50625131022895),c(388.98222477756894,1309.393087009507,2893.017189811374,342.58816752240824,326.537371307898,467.7208530974532))
targetgene="Tshr"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1348.2691176535006,1963.6308382623301,4913.38911930629,4004.698938652465,1096.1576065769952,1887.9951509177683),c(714.147053302568,522.1055826968532,2460.1913572234243,1644.6471179425416,1469.9431505821776,1600.5179436481142),c(394.0470974960269,143.1431826023007,1227.7644802315258,61.5763046200407,48.29813209055727,179.10286325926867),c(511.55214456425085,487.23737155013896,2463.29962173034,52.619751220762055,192.14256896895608,317.1375540514439),c(241.08794139859742,322.0721608551766,1725.8638674646954,161.21796118701565,1016.3606926882486,108.3743440103855),c(464.9553155544379,560.644131859011,1229.3186124849835,385.13179616898185,1314.549160377776,504.22589529042517),c(4036.7035566109694,2964.7155319745743,3092.723184380679,2761.977154502553,5315.944408141118,5114.128254721665),c(1305.7241868184542,457.87466742659007,3562.0711249248825,588.893386002571,111.29569568693631,80.99556236565653),c(997.779925536212,1229.5632351736085,4585.467213826731,1354.6787016408953,467.2319300064779,719.8338007426657),c(823.5483040212592,778.1116592740449,1870.3981670362548,431.0341323402849,1226.3525713428453,1558.3089886124903),c(590.5641589721945,975.3923276041388,1029.6126179156784,497.0887136599649,384.28513793791217,519.05606868132),c(1582.266237246257,2150.8180770499544,3444.7341397888317,1467.7551883067883,401.08448823027993,796.2662328342008),c(1061.597321788782,1299.2996574670372,3513.115958940967,2070.083404408277,374.83550339845533,1371.220647373509),c(4293.999090708632,3237.238129621262,8480.899707118275,7440.656736450736,4468.62717776982,3325.381187266039),c(735.4195187200913,479.89669551925175,2910.8897107261364,399.6861954428096,2558.751041406262,568.109719128126),c(2775.550249714945,1935.1857186426423,4099.8008846212215,827.3616202583651,260.38992953170003,969.6651832508176),c(1585.3051608773317,2168.2521826233115,12116.792114082395,845.2747270569223,806.3688140336517,965.1020529766961),c(2508.1249701803663,2181.0983656773637,4480.56328671834,3003.8040962830764,529.179534209584,669.6393677273293),c(1376.6324048768652,1900.3175074959279,2188.9952789950685,2198.833859522908,589.0272196261441,239.56433939137847),c(915.7289874971935,774.4413212586013,1634.1700645106955,1596.5056434214189,1942.4248775550204,2870.20894242242),c(645.2647843315401,435.85263933392844,853.9956732749664,980.7425972210118,235.19090409314842,1090.5881355150373),c(1708.8880552077053,1292.8765659400108,3798.299227450442,1356.917839990715,1348.1478609625115,1433.9636886426797),c(140.80346157313042,30.280288627409764,126.66177865679666,13.43483009891797,1.049959393272984,23.956433939137845),c(792.14609316682,812.0622859168982,2019.5948633681871,1088.2212380123556,1858.4281260931818,1509.2553381656844),c(1932.7554293635458,1654.4048604612062,3392.670709298001,2075.6812502828266,1438.4443687839882,608.0371090266891),c(1119.3368707792024,2086.587161779691,3609.47215865534,5195.920540756525,1695.6844201358692,2113.8700994867822))
targetgene="Phox2b"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(4666.773722787136,2575.6597023375516,14399.03532828492,1960.365625267114,1856.3282073066357,1461.3424702874086),c(2755.2907588411135,1730.564374281661,7277.224276815341,410.88188719190794,1265.2010688939458,352.50181367588544),c(1598.4738299453224,1502.0858328202964,8428.836276627444,2061.1268510089985,592.177097805963,1209.2295226421961),c(978.5334092060718,1078.1617920365597,1064.580593618475,597.8499394018497,1101.4074035433603,609.1778915952195),c(732.3805950890165,983.6505881388869,1681.571098241153,2711.5965416316103,379.0353409715472,1275.3949116169576),c(2189.037988917517,2551.802505237168,8193.385240228612,1287.5045511463054,2674.24657466629,2950.0637222195464),c(2166.7525489563022,1374.5415867836311,8578.032972959376,971.7860438217332,583.7774226597792,694.7365842349975),c(2004.6766219656483,1100.1838201292214,4318.9335323587475,1317.732918868871,884.0658091358525,1412.2888198406026),c(168.15377425280323,179.84656275673677,1049.8163372106274,193.68546725940075,403.18440701682584,183.66599353339015),c(3117.935645482701,2034.2848450596196,2303.223999624204,1888.7131980728848,1002.7112205756997,1007.3110080123199),c(2486.852504762843,1169.92024242265,5305.030447177612,1214.7325547771666,1817.4797097555354,1221.7781308960302),c(1597.4608554016309,1607.6080507643003,9533.824308835816,1107.2539139858227,1774.431374631343,669.6393677273293),c(814.431533128035,569.8199768976201,5790.696776383121,1520.3749395275504,888.2656467089445,579.5175448134298),c(67.86929442733624,467.0505124651991,310.8264506915255,94.0438106924258,101.84606114747945,459.73537511774055),c(2056.338323693919,938.6889474497027,4557.492833264493,1445.3638048085916,389.53493490427707,1872.024194958343),c(2551.6828755591046,2087.504746283552,5599.538509207832,1753.2453279087952,4331.082497251059,2102.4622738014787),c(416.33253745724176,1413.080135945789,4555.161634884306,387.3709345188015,300.2883864760734,687.8918888238153),c(2184.9860907427505,2217.8017458318,4943.694698248713,1199.0585863284289,1200.1035865110207,694.7365842349975),c(1351.3080412845754,1810.3942261175596,2085.6454841401364,612.4043386756775,1566.5394147632921,1235.4675217183947),c(1815.2503822953217,1550.7178115249244,13156.506591645546,1581.951244147591,430.48335124192346,687.8918888238153),c(3837.147571503727,3385.886819246728,14135.609911323852,1874.158798799057,1838.478897620995,2395.6433939137846),c(2640.8246354039643,1681.9323955770333,3786.64323554951,2075.6812502828266,3422.867622069928,2845.111725914752),c(1818.2893059263965,1450.701100604086,4164.297373139713,3353.1096788549435,4981.007361687036,5341.143985859209),c(2330.854425034339,1139.6399537952402,8111.793296922087,2208.9099820970964,3209.725865235512,1514.9592510083362),c(1170.9985725074732,906.5734898145712,1266.6177865679665,564.2628641545548,329.687249487717,823.6450144789297),c(1189.2321142939218,980.8978346273042,5485.3097885786965,439.99068573956356,89.24654842820364,945.7087493116798),c(681.7318679044372,576.2430684246465,2907.7814462192214,494.84957531014527,1255.751434354489,447.1867668639065),c(1832.4709495380787,1593.8442832063868,5767.384792581256,821.7637743838159,3580.3615310608757,1569.7168142977941),c(2206.2585561602737,1720.4709447391913,2851.055618968018,1939.093810943827,2316.2104215602026,2205.132704969212),c(1448.5535974789677,1622.2894028260746,5636.060617164087,2080.1595269824656,1833.2291006546302,1808.1403711206422),c(534.8505590691573,690.9411314072591,13063.258656438089,1410.657160386387,416.8338791293747,479.12867878275694),c(432.54013015630716,534.0341812470449,1277.49671234217,115.31562501571258,758.0706819430944,215.60790545224063),c(2795.809740588777,2293.9612596522547,1904.5890766123227,1054.6341627650606,3367.21977422646,1917.655497699558),c(3263.8039797742895,3788.7064164416643,10655.907795832223,3475.142718920115,1034.2100023738892,2431.0076535382264),c(2299.4522141799,1391.0581078531275,10519.921223654681,4251.004157132628,5440.889575940603,2399.065741619376),c(2032.026934645321,1480.0638047276348,4534.957915589357,2495.519690874013,1090.9078096106305,1705.4699399529086),c(2507.1119956366747,1519.5199383936535,3293.206245076713,1430.8094055347638,2347.709203358392,887.5288383166306),c(1364.476710352566,778.1116592740449,5551.360409350646,461.26250006285034,254.09017317206215,441.4828540212546),c(1107.1811762549032,926.760348899511,2072.4353599857463,635.915291348784,1335.5483482432358,2154.9382719538758),c(412.2806392824754,256.92366108105256,204.36839132967802,154.50054613755665,284.53899557697866,265.80233846757704),c(793.1590677105116,869.8701096601351,1343.547333114119,517.2409588083418,1069.9086217451706,748.3533649559251),c(749.6011623317735,1818.6524866523077,2545.668631163594,3185.174302618469,451.48253910738316,2196.0064444209693),c(192.4651633014013,365.19863253663897,294.50806203022046,616.8826153753168,212.09179744114277,297.7442503864275),c(715.1600278462596,1323.1568545674206,2334.3066446933567,447.82766996393235,1620.0873438202143,513.3521558386682))
targetgene="Ctcf"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2366.3085340635444,1970.9715142932173,1788.8062237297295,785.9375607867013,3112.0796416611247,1259.4239556575326),c(906.6122166039693,510.1769841466615,864.8745990491698,70.53285801931935,1001.6612611824268,315.9967714829135),c(809.3666604095771,1046.0463344014283,554.8252144843731,667.2632282462592,186.89277200259116,528.182329229563),c(973.468536487614,1023.1067218049056,1157.8285288259326,546.3497573559974,2463.2047366184206,1058.6462235961867),c(1804.1076623147144,616.6167865945262,449.1442212492544,457.90379253812085,940.7636163725937,1348.4049960029017),c(4091.404181970315,2430.681350727529,5315.132306825087,2232.4209347702026,2023.2717508370401,2653.460254401649),c(966.3777146817729,453.2867449072856,773.1807960951697,2040.9746058606218,842.0674334049332,562.4058062854742),c(2830.250875074291,1786.537029017176,3184.416987334679,1438.6463897591327,1183.304236218653,806.5332759509741),c(3025.7549620067666,2511.428787067289,4005.7758832870354,7614.18995856176,2975.5849205356367,1844.6454133136142),c(1164.9207252453236,981.8154191311651,985.3198486921359,1242.7217841499123,1193.803830151383,734.6639741335606),c(108.38827617499967,226.6433724536428,139.09483668445768,110.83734831607326,133.34484294566897,13.689390822364484),c(1774.7314005476583,1829.6635006986385,1166.3762562199495,682.9371966949968,2379.207985156582,1188.6954364086494),c(2961.937565754197,3209.710594505435,3950.6041882892896,2660.0963595857584,8915.205208280908,2788.072597488233),c(6076.834287605823,3812.5636135420477,5531.156690055696,4538.733435084454,4323.732781498148,5222.5025987320505),c(5444.738172342274,3036.2871232757248,3351.486204581374,1219.2108314768059,1177.0044798590152,3943.6853394095015),c(1651.1485062172849,2215.048992320217,2196.7659402623567,2068.9638352333673,1939.2749993752016,1503.5514253230324),c(4209.92220358223,3022.5233557178112,3779.6496404089503,2806.759921498946,2780.2924733868617,2346.5897434669787),c(3076.403689191346,2590.3410543993264,1537.8138647963226,563.1432949796449,477.73152393920776,520.1968512498504),c(3042.975529249524,4095.1796407312054,4063.2787766649676,2330.943022162268,2163.96630953562,1957.5828875981213),c(8592.05007959203,6561.64678710931,9139.851782584308,7161.884011898188,9650.176783571997,6246.925345272326),c(1968.2095383927513,1615.8663112990484,2267.4789577946785,3055.3042783289284,1166.5048859262852,705.0036273517709),c(802.2758386037359,933.1834404265373,1355.98039114178,1186.7433254044208,585.8773414463251,1180.7099584289367),c(1962.1316911306017,2202.202809266165,1976.8562263981023,2072.322542758097,2903.137722399801,4395.43523654753),c(2533.4493337726562,2366.450435457266,2804.431651364289,1821.539047578295,4598.8221425356705,2092.195230684705),c(2766.4334788217207,1510.3440933550446,2835.514296433442,928.1228460002498,3720.0061303661823,889.8104034536914),c(1098.064405361679,939.6065319535636,447.59008899579675,283.2510012521872,394.784731870642,735.804756702091),c(1202.4007833619123,403.73718169879686,135.98657217754243,129.87002428954037,87.14662964165768,244.12746966549994),c(1770.6795023728919,2052.6365351368377,2253.4917675135603,1425.2115596602148,773.8200728421892,1420.2742978203153),c(972.4555619439224,542.2924417817931,1294.5921671302037,3863.6332226138265,1922.4756490828338,1380.346907921752),c(3530.2162847651766,3178.5127213741644,5007.4141206404765,6242.717719297217,7904.094312559024,6583.456202988787),c(751.6271114191567,749.6665396543569,481.7809985718646,319.0772148493018,712.9224280323562,293.181120112306),c(632.0961152635496,255.08849207333074,646.5190174383731,1720.77782183641,526.029656029765,958.2573575655139),c(993.7280273614457,1546.1298890056198,1606.195683948458,3379.9793390527793,935.5138194062288,1622.1928124501912),c(1810.1855095768638,1090.0903905867515,941.0270794685936,1347.9612865914364,432.5832700284694,278.35094672141116),c(253.24363592289646,564.3144698744547,472.4562050511188,143.30485438845835,392.68481308409605,287.4772072696542),c(408.2287411077091,472.5560194883645,206.69958970986448,79.489411418598,157.4939089909476,284.054859564063),c(974.4815110313056,1043.2935808898455,425.05517132066115,160.09839201210582,914.5146315407691,978.7914437990606),c(116.49207252453236,901.9855672952666,355.1192199150679,157.85925366228616,1172.8046422859231,311.433641208792),c(1040.3248563712586,1222.2225591427214,1376.1841104367293,2439.5412321285216,1282.0004191863136,1473.8910785412427),c(1064.6362454198568,1068.0683624940898,722.6714978577968,494.84957531014527,1072.0085405317168,520.1968512498504),c(2135.3503381018627,1150.650967841571,677.6016625075256,985.2208739206512,2554.5512038331703,1170.4429153121634),c(2770.485376996487,3392.3099107737544,2665.336814679831,2733.987925129807,1382.79652094052,3083.5352827376),c(580.4344135352786,592.7595894941427,211.36198647023735,141.0657160386387,3217.075580988423,503.08511272189475),c(907.6251911476609,612.9464485790825,630.9776949037968,199.2833131339499,280.3391580038867,1301.6329106931564),c(949.157147439016,1634.2180013762663,3419.8680237335097,2558.2155646689635,3138.3286264929493,1336.997170317598),c(1426.2681575177528,1413.99772044965,1204.4524964296613,2064.485558533728,2385.5077415162195,1959.8644527351819),c(1687.615589790182,1848.9327752797174,2599.286193907882,1861.8435378750487,1365.9971706481522,1601.6587262166445),c(915.7289874971935,1253.420432273992,1423.5851441671869,724.3612561666606,732.8716565045429,633.1343255343573),c(756.6919841376146,2131.5488024688752,1753.8382480269327,2408.1932952310462,278.23923921734075,960.5389227025746),c(1468.8130883527995,1932.4329651310595,1187.3570416416276,690.7741809193657,2376.0581069767627,1381.4876904902824),c(2834.302773249057,2162.746675600146,1742.1822561260005,796.0136833608898,1287.2502161526784,1498.988295048911),c(252.23066137920486,388.13824513316155,363.6669473090849,688.535042569546,48.29813209055727,60.4614761321098),c(522.6948645448583,434.93505483006754,571.1436031456782,1108.3734831607326,1385.946399120339,732.3824089964999),c(456.8515192049052,885.4690462257704,557.9334789912883,86.20682646805697,234.14094469987543,487.1141567624695),c(1674.4469207221914,2182.9335346850858,1704.8830820430176,3055.3042783289284,2109.368421085425,2550.7898232339153),c(954.2220201574738,1660.8279519882326,2244.1669739928143,1523.7336470522798,442.03290456792627,2839.4078130721),c(505.4742973021013,507.4242306350788,365.2210795625425,148.90270026300752,377.98538157827426,378.73981275208405),c(789.1071695357454,559.7265473551502,367.55227794272895,132.10916263936005,482.98132090557266,195.0738192186939),c(1305.7241868184542,801.9688563744284,937.9188149616783,438.8711165646537,2085.219355040146,1564.0129014551424),c(534.8505590691573,270.6874286389661,268.08781372144074,217.19641993250718,1533.9906735718296,1003.8886603067288),c(823.5483040212592,444.11089986867654,155.41322534576275,114.19605584080276,285.5889549702517,460.876157686271),c(940.0403765457916,894.6448912643795,831.4607555998308,901.2531858024139,889.3156061022174,999.3255300326073),c(2102.935152703732,1688.3554871040596,829.1295572196443,493.73000613523544,620.5260014243336,1035.8305722255793),c(744.5362896133156,656.072920260545,812.8111685583392,855.3508496311108,601.6267323454199,326.26381459968684),c(2283.244621480834,1717.7181912276085,3069.4112005788147,2161.8880767508836,701.3728747063533,1696.3436794046656),c(1223.6732487794357,1609.443219772022,1269.7260510748818,2133.898847378138,1038.4098399469813,1955.3013224610604),c(822.5353294775676,456.95708292272917,523.7425694152205,630.3174454742348,364.3359094657255,357.0649439500069),c(807.3407113221939,823.9908844670899,689.2576544084578,1721.89739101132,1561.2896177969274,1064.3501364388385),c(869.1321584873806,946.9472079844509,667.4998028600511,587.7738168276612,1847.9285321604518,998.184747464077),c(873.184056662147,1002.9198627199659,822.9130282058138,1297.580673720494,623.6758796041526,352.50181367588544),c(830.6391258271003,734.9851875925825,284.40620238274585,90.6851031676963,108.14581750711736,169.97660271102566),c(931.9365801962589,680.8477018647892,401.74318751879673,594.4912318771202,1892.0268266779171,1167.0205676065723),c(2630.6948899670483,1767.2677544360972,1101.879767701458,688.535042569546,926.0641848667719,1395.177081312647),c(1175.0504706822396,1249.7500942585484,889.7407151044919,850.8725729314715,2329.8598936727517,613.741021869341),c(1038.2989072838755,835.9194830172817,1154.7202643190174,401.92533379262926,406.3342851966448,563.5465888540045),c(1874.0029058294338,1288.2886434207064,1008.6318324940004,1775.6367114069917,1098.2575253635414,2865.645812148299),c(1382.7102521390145,2271.9392315595933,2743.8204934794417,1409.537591211477,337.03696524062786,778.0137117377149),c(389.99519932126054,115.61564748647365,1526.9349390221191,88.44596481787664,132.294883552396,95.82573575655138),c(1707.8750806640137,1833.333838714082,3262.1236000075605,1122.9278824345604,1083.5580938577195,2700.232339711394),c(1322.9447540612111,1801.2183810789506,1044.3768743235257,549.708464880727,1983.3732938926669,947.9903144487405),c(143.8423852042052,252.33573856174803,444.4818244888815,127.63088593972071,390.5848942975501,262.37999076198594))
targetgene="Epha3"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(930.9236056525673,784.5347508010711,4248.997580953154,2042.0941750355314,422.0836760957396,354.7833788129462),c(844.8207694387826,798.2985183589847,1640.386593524526,288.84884712673636,392.68481308409605,629.7119778287663),c(1681.5377425280324,1435.1021640384506,10271.260063101461,2878.4123486931753,2689.995965565385,1125.9523951394788),c(720.2249005647175,652.4025822451013,578.1371982862374,133.22873181426988,367.4857876455444,213.32634031517986),c(2082.6756618299005,1910.4109370383978,15725.487206611006,798.2528217107094,2214.3643604127233,799.6885805397919),c(924.8457583904178,185.3520697799022,2560.4328875714414,163.4570995368353,161.69374656403954,290.8995549752453))
targetgene="Phf6"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2170.804447131068,1194.6950240268943,5618.965162376053,729.9591020412097,1473.0930287619967,1946.1750619128175),c(1232.7900196726598,2217.8017458318,4506.206468900391,1597.6252125963288,745.4711692238187,1371.220647373509),c(424.4363338067744,788.2050888165148,6251.496989533307,2008.5070997882367,181.64297503622623,1645.0084638207989),c(2625.6300172485903,3853.8549162157883,14286.360739909242,3781.9046728454086,1328.1986324903248,989.0584869158339),c(3823.9789024357365,5483.48499507275,8248.55693522636,4764.886408416241,4868.661706606827,2794.9172928994153),c(2582.072111869852,3636.3873888007543,5200.903586195951,2748.5423244036347,2512.5528281022507,1811.5627188262333),c(1128.4536416724266,533.116596743184,754.5312090536783,1077.0255462632574,131.244924159123,1149.9088290786167),c(2717.810700724525,5231.149256511002,26706.208643415874,13206.437987236364,4180.938304013022,4076.016117359025),c(833.6780494581751,1118.5355102064395,13865.967965348953,3719.2087990504583,1797.5304812833488,2134.404185720329),c(1687.615589790182,1528.6957834322627,2120.613459842933,879.9813714791271,1661.0357601578608,1432.8229060741494),c(1367.5156339836408,962.5461445500862,1577.444237259492,853.1117112812912,1814.3298315757165,375.31746504649294),c(531.8116354380826,1024.0243063087667,1012.5171631276444,133.22873181426988,404.23436641009886,386.72529073179663),c(728.3286969142501,1403.90429090718,5869.180455182731,368.3382585453344,355.9362343195416,961.6797052711049),c(572.330617185746,810.2271169091764,6105.40855770829,501.56699035960423,170.09342171022342,172.25816784808643),c(1827.4060768196207,2493.9946814939317,6291.127361996477,1484.5487259304357,2760.343244914675,1540.0564675160044),c(1618.7333208191542,1395.6460303724318,2244.1669739928143,762.4266081135949,1035.2599617671622,1010.7333557179111),c(667.550224292755,1024.0243063087667,4748.651100439781,2082.3986653322854,2132.4675277374304,871.5578823572055),c(4.051898174766343,14.681352061774431,3983.2409656119,179.13106798557294,4.199837573091936,30.80112935032009),c(668.5631988364466,706.5400679728945,4883.083540363866,1655.8428096916398,182.69293442949922,602.3331961840373),c(1984.4171310918166,2853.687807007405,4703.5812650895095,1796.9085257302786,2636.448036508463,3399.5320542205136),c(1947.9500475189195,1581.915684656195,9218.335461383918,4603.6684472292245,741.2713316507268,1251.43847767782),c(564.2268208362133,975.3923276041388,4177.507497294103,787.057129961611,526.029656029765,500.803547584834),c(1445.514673847893,850.6008350790561,3317.2952950053063,1036.7210559665034,1414.2953027387096,942.2864016060886),c(565.2397953799049,1553.470565036507,4069.495305678798,1828.2564626277538,1624.2871813933064,895.5143162963433),c(719.2119260210259,773.5237367547403,2390.255405817831,810.5680826347176,2658.4971837671956,1615.3481170390091),c(3659.8770263576994,2505.0056955402624,3401.2184366920183,3871.4702068381953,1904.626339397193,4248.2742852071115),c(3238.479616182,2888.5560181541196,6779.9019557089005,6181.141414677177,3195.0264337296903,1927.9225408163315),c(108.38827617499967,757.924800189105,1075.4595193926782,557.5454491050958,554.3785596481356,647.9644989252522),c(1508.3190955567713,1561.7288255712551,7914.418500732969,3948.7204799069737,3553.062586835778,2614.6736470716164),c(3462.3469903378405,2499.500188517097,5010.522385147391,1467.7551883067883,4029.744151381713,1447.6530794650441),c(1107.1811762549032,1636.0531703839881,7344.05196371402,3553.512561163803,605.8265699185118,2198.28800955803),c(1458.6833429158835,2053.5541196406984,6009.052357993917,1594.266505071599,2737.2441382626694,2200.5695746950905),c(1462.7352410906499,1311.228256017229,1038.1603453096952,420.95800976609644,1483.5926226947265,773.4505814635933),c(1263.1792559834075,1268.1017843357665,4014.3236106810523,3154.9459348959035,1844.778653980633,1723.7224610493945),c(1415.1254375371454,954.287884015338,1394.8336974782208,1043.4384710159625,606.8765293117848,2064.8164490399763),c(671.6021224675213,476.2263575038081,1976.0791602713734,848.6334345816518,1667.3355165174987,398.1331164171004),c(2281.218672393451,2818.8195958606907,2419.0068525067973,2279.4428401164155,2060.0203296015948,1263.987085931654),c(901.5473438855114,1079.9969610442815,526.073767795407,148.90270026300752,749.6710067969107,207.622427472528),c(1348.2691176535006,857.9415111099433,5024.50957542851,557.5454491050958,2587.0999450246327,1917.655497699558),c(1165.9336997890152,2259.0930485055405,5173.706271760442,1274.0697210473875,1354.4476173221494,2269.0165288069134),c(1829.432025907004,1883.8009864264318,10837.741269486767,1434.1681130594934,3763.0544654903747,2198.28800955803),c(935.9884783710253,729.479680569417,1707.9913465499328,913.568446726422,1995.9728066119426,544.1532851889882),c(363.6578611852793,2231.5655133897135,5880.836447083663,555.3063107552762,785.3696261681921,1378.0653427846914),c(1760.5497569359761,869.8701096601351,9247.086908072884,756.8287622390457,1951.8745120944773,593.2069356357943),c(912.6900638661187,1065.3156089825072,5859.855661661985,796.0136833608898,407.3842445899178,2059.1125361973245),c(1853.743414955602,708.3752369806164,6903.455469858782,2051.05072843481,522.8797778499461,265.80233846757704),c(2915.340736744384,2321.488794768082,8408.632557332494,3499.7732407681315,1105.607241116452,1556.0274234754297),c(529.7856863506994,677.1773638493456,1803.5704801375769,343.70773669731807,192.14256896895608,831.6304924586424),c(970.4296128565392,512.0121531543833,2287.6826770896278,939.3185377493481,1047.859474486438,1010.7333557179111),c(915.7289874971935,669.8366878184585,1714.9849416904922,544.1106190061778,1584.3887244489329,816.8003190677475),c(3530.2162847651766,2083.8344082681083,9941.006959241715,1609.9404735203368,2640.647874081555,840.7567530068853),c(766.8217295745304,2304.972273698586,6677.329226980697,1262.8740292982893,738.1214534709078,1269.6909987743059),c(1985.4301056355082,1302.05241097862,8351.906730081291,1324.45033391833,2302.560949447654,1089.4473529465067),c(1845.6396186060692,1784.7018600094543,16756.65395678014,605.6869236262185,1893.0767860711903,1279.9580418910791),c(1107.1811762549032,1235.986326700635,5183.808131407917,3712.491384000999,2224.8639543454533,1546.9011629271865),c(1051.467576351866,784.5347508010711,9399.391868911733,3028.4346181310925,910.3147939676771,991.3400520528946),c(1361.4377867214912,887.3042152334922,4136.322992577476,1786.83240315609,854.6669461242091,1841.223065608023),c(3416.763135871719,4130.04785187792,5896.377769618239,4320.4174459770375,4282.784365160502,4773.034266731083),c(2413.918337617049,1762.6798319167926,3548.0839346437638,6268.467810320143,2012.7721569043104,5002.331563005689),c(2028.9880110142462,2994.995820601984,6621.380465856222,8134.789624894831,2336.1596500323894,708.425975057362),c(1481.98175742079,2961.9627784629915,4587.021346080188,3470.664442220476,2896.837966040163,1883.4320206436469),c(3434.9966776581673,2810.5613353259428,3422.9762882404248,3385.5771849273287,1350.2477797490574,2566.7607791933406),c(1331.0485504107437,1785.619444513315,8048.073874530324,1146.4388351076668,1827.9793036882652,869.2763172201447),c(627.0312425450916,478.0615265115299,2199.8742047692717,394.08834956826047,314.9878179818952,333.1085100108691),c(1607.5906008385466,1572.7398396175859,2848.7244205878314,1346.8417174165265,899.8152000349473,860.1500566719017),c(392.0211484086437,374.374477575248,1756.9465125338481,970.6664746468234,1424.7948966714393,1601.6587262166445),c(123.58289433037346,71.57159130115035,1747.6217190131022,141.0657160386387,736.0215346843618,130.0492128124626),c(427.4752574378492,712.0455749960599,11785.761944095919,518.3605279832517,342.2867622069928,155.1464293201308),c(2988.274903890178,2042.5431055943677,11011.804081874021,4244.286742083169,2532.5020565744376,2227.94835633982),c(878.2489293806049,549.6331178126803,5615.856897869137,2363.410528234653,1977.073537533029,1909.6700197198454),c(1189.2321142939218,1772.7732614592626,7936.176352281375,772.5027306877834,1392.2461554799768,727.8192787223784),c(712.1211042151848,737.7379411041652,2323.4277189191534,1088.2212380123556,2342.459406392027,1870.8834123898127),c(1372.5805067020988,2073.7409787256383,2490.496936165848,3882.6658985872937,4843.462681168276,5708.4759729259895),c(770.8736277492968,787.2875043126538,1247.968199526475,444.46896243920287,1154.9553326002824,326.26381459968684),c(1240.8938160221926,2220.5544993433828,4458.028369043205,1439.7659589340426,3186.6267585835067,1435.10447121121),c(1258.1143832649495,1130.4641087566313,5340.775489007137,1664.7993630909184,463.03209243338597,1566.294466592203),c(1394.8659466633137,891.8921377527967,2828.520701292882,1671.5167781403775,375.8854627917283,1225.2004786016212),c(419.3714610883165,562.479300866733,15748.79919041287,530.6757889072599,72.4471981358359,609.1778915952195),c(1285.4646959446225,1203.8708690655033,3113.703969802357,1517.0162320028207,1473.0930287619967,1634.7414207040254),c(1412.0865139060706,826.7436379786726,2522.3566473617298,911.3293083766023,361.1860312859065,1464.7648179929997),c(1361.4377867214912,733.1500185848606,993.090509959424,416.4797330664571,387.4350161177311,662.7946723161471),c(1221.6472996920525,1770.9380924515408,6834.296584579917,3035.1520331805514,1464.6933536158128,2524.551824157717),c(422.4103847193913,423.9240407837367,791.0533170099325,871.0248180798484,809.5186922134707,322.84146689409573),c(808.3536858658855,585.4189134632554,1352.8721266348648,1834.9738776772128,1173.854601679196,2693.3876443002123),c(360.61893755420454,769.8533987392967,563.3729418783901,1364.7548242150838,1047.859474486438,1958.7236701666516),c(797.210965885278,635.886061175605,693.9200511688307,705.3285801931935,112.3456550802093,352.50181367588544),c(934.9755038273337,1336.9206221253341,1733.6345287319837,269.81617115326924,244.64053863260528,271.50625131022895),c(1343.2042449350427,683.600455376372,864.8745990491698,555.3063107552762,1291.4500537257704,309.15207607173124),c(2256.907283344853,2551.802505237168,4315.825267851832,4226.373635284612,2256.362736143643,3118.8995423620413),c(2978.1451584532624,1871.87238787624,2056.1169713244412,1227.0478157011746,1729.2831207206048,2867.9273772853594),c(3589.98178284298,5033.868588180908,11387.904087210767,9247.641384755203,2533.5520159677103,4240.288807227399),c(1885.145625810041,2910.578046246781,7616.025108069104,4296.906493303931,6856.234838072586,3830.747865124995))
targetgene="Pik3cg"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1052.4805508955576,634.0508921678833,1070.7971226323054,435.5124090399242,1019.5105708680675,513.3521558386682),c(2371.3734067820023,2081.0816547565255,2280.6890819490686,2854.9013960200687,2845.389955769787,2279.2835719236864),c(529.7856863506994,796.4633493512629,1012.5171631276444,665.0240898964396,57.74776663001412,1300.4921281246259),c(2626.642991792282,1909.493352534537,3286.9897160628825,584.4151093029317,43.04833512419235,285.19564213259343),c(508.51322093317606,306.47322428954124,2237.950444978984,737.7960862655785,211.0418380478698,1112.2630043171143),c(2849.497391404431,4007.0915283605586,2927.9851655141706,3111.28273707442,3035.432605952197,1603.9402913537053),c(1501.2282737509302,1778.278768482428,2161.79796455956,1316.613349693961,995.3615048227889,2807.4659011532494),c(1004.8707473420532,1115.7827566948567,1402.604358745509,504.9256978843337,163.7936653505855,543.0125026204579),c(1043.3637800023334,1603.0201282449957,1204.4524964296613,1587.5490900221403,61.94760420310606,379.8805953206144),c(1751.4329860427517,2018.6859084939842,2811.4252465048485,2264.888440842588,1292.5000131190434,997.0439648955465),c(2918.3796603754586,3493.244206198454,5002.751723880103,4443.570055217118,1034.2100023738892,1915.3739325624974))
targetgene="Hist1h3g"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Notch1","Cdkn2a","Irs1","Gnas","Notch3","Ptprs","Prdm14","Ercc2","Msi2","Egfr")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='d15_rep1,d15_rep2,d15_rep3_vs_input_rep1,input_rep2,input_rep3 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(237.0360432238311,555.1386248358457,481.7809985718646,425.43628646573575,58.797726023287105,78.71399722859579),c(1280.3998232261645,1892.9768314650407,1398.7190281118649,1547.2445997253863,3332.5711142484515,2124.1371426035557),c(748.5881877880819,240.40714001155632,292.95392977676283,304.522815575474,2453.755102078964,638.8382383770092),c(1941.87220025677,2680.2643357776947,3723.700879284476,7339.895510708851,2633.298158328644,2897.587724067149),c(1137.570412565651,676.2597793454847,1124.4146853765935,2223.464381370924,108.14581750711736,674.2024980014509),c(836.7169730892499,868.9525251562742,871.0911280630003,1632.3318570185334,2350.8590815382113,966.2428355452265),c(1243.9327396532674,1188.271932499868,1271.2801833283395,2530.2263352962177,1160.2051295666474,2288.4098324719293),c(964.3517655943897,312.89631581656755,363.6669473090849,148.90270026300752,109.19577690039034,311.433641208792),c(1878.0548040042002,935.93619393812,911.4985666528986,1134.1235741836588,2586.0499856313595,1592.5324656684015),c(996.7669509925204,595.5123430057254,294.50806203022046,143.30485438845835,1591.7384402018438,685.6103236867546),c(876.2229802932217,1370.8712487681876,1394.056631351492,3375.5010623531402,839.9675146183872,1252.5792602463503),c(828.6131767397172,400.9844281872142,649.6272819452884,1387.1462077132805,763.3204789094594,1065.490919007369),c(886.3527257301375,1218.5522211272778,2509.9235893340688,3452.7513354219186,2910.4874381527115,1955.3013224610604),c(1283.4387468572393,1436.0197485423116,2400.3572654653058,2702.6399882323317,727.6218595381779,1598.2363785110535),c(1234.815968760043,1045.1287498975673,995.4217083396105,3851.3179616898183,899.8152000349473,1263.987085931654),c(1777.770324178733,2404.071400115563,2798.9921884771875,2766.455431202192,1902.5264206106472,2110.447751781191),c(2332.880374121722,2191.1917952198337,2623.3752438364754,3091.130491926043,2672.1466558797442,1370.0798648049788),c(1691.6674879649484,2397.648308588537,2643.5789631314246,5881.096875801341,1864.7278824528196,3475.9644863120484),c(830.6391258271003,804.721609886011,881.9700538372036,1294.2219661957645,1787.0308873506187,2006.6365380449272),c(553.0841008556058,907.4910743184321,695.4741834222883,1293.1023970208546,1906.726258183739,271.50625131022895),c(2137.376287189246,2571.989364322108,4226.462663278018,5328.029703395885,4886.5110162924675,2313.5070489795976),c(2397.7107449179834,2023.2738310132888,1269.7260510748818,2931.032099913937,7083.02606701955,2421.8813929899834),c(1880.0807530915831,1905.8230145190935,1409.5979538860684,1934.6155342441878,2018.0219538706754,1080.3210923982638),c(1688.6285643338736,1185.5191789882854,1005.523567987085,2006.267961438417,446.2327421410182,2208.5550526748034),c(998.7929000799036,917.5845038609019,648.0731496918307,450.066808313752,305.53818344243837,763.18353834682),c(1457.670368372192,1503.9210018280182,2028.142590762204,1158.7540960316749,1144.4557386675526,2461.8087828885464),c(1346.2431685661174,2645.3961246309805,2956.7366122031367,4302.50433917848,3771.454140636559,3981.331164171004),c(4387.192748728258,3449.2001500131305,2802.8775191108316,5183.605279832517,3183.4768804036876,3487.372311997352),c(2149.531981713545,1160.744397384041,1340.4390686072038,2401.4758801815874,1249.451677994851,1274.2541290484273),c(415.31956291355016,100.93429542469922,195.8206639356611,286.6097087769167,381.1352597580932,358.20572651853735),c(1080.8438381189221,1499.3330793087139,1208.3378270633054,4023.7316146259323,3120.4793168073084,1708.8922876584998),c(2440.25567575303,2358.192174922518,2453.974828209594,1389.3853460631,1442.64420635708,1314.1815189469903),c(1926.6775821013962,2272.856816063454,2851.8326850947465,1070.3081312137983,952.3131696985965,1981.539321537259),c(3016.6381911135427,3398.7330023007808,4088.1448927202896,3093.3696302758626,2608.0991328900923,4000.7244678360203),c(1939.8462511693867,2082.9168237642475,1847.0861832343903,5405.279976464663,4391.980142060892,5875.030227931425),c(1427.2811320614444,1430.5142415191463,1391.7254329713055,2029.7789141115234,1167.5548453195584,1877.728107800995),c(4801.4993370981165,3579.4971495613786,3209.283103390001,2507.8349517980214,1770.2315370582512,1400.8809941552988),c(1739.2772915184528,2076.493732237221,3501.459967040035,3687.860862152983,2713.0950722173907,1780.7615894759133),c(3421.828008590177,3968.552979198401,7966.4819312238,6468.870692629002,3936.2977653804173,2792.6357277623547),c(3777.3820734259234,2929.84732082786,3604.8097618949673,2716.07481833125,1821.6795473286272,2565.6199966248105),c(2212.3364034224232,1764.5150009245144,1167.1533223466784,685.1763350448165,1243.151921635213,1015.2964859920326),c(5595.6713793523195,4572.323582738874,4259.099440600628,1997.3114080391383,2765.59304188104,5810.0056215251925),c(619.9404207392505,1087.337637075169,1418.922747406814,2676.8898972094057,2430.6559954269583,1558.3089886124903),c(284.64584677733563,372.5393085675262,194.26653168220346,732.1982403910293,1503.5418511669131,659.372324610556),c(1520.4747900810703,879.045954698744,756.0853413071359,1829.3760318026636,4173.5885882601115,2394.502611345254),c(3606.1893755420456,2165.4994291117287,4953.7965578961885,3062.021693378387,2536.7018941475294,2230.2299214768805),c(3154.4027290555982,2505.0056955402624,2861.934544742221,5126.507251912116,2258.462654930189,5397.042331717198),c(519.6559409137835,933.1834404265373,861.7663345422545,924.7641384755203,172.1933404967694,209.90399260958876),c(1563.019720916117,488.15495605399985,574.2518676525934,2214.5078279716454,990.111707856424,1485.2989042265465),c(2952.8207948609725,1561.7288255712551,1366.0822507892547,1918.94156579545,5844.0739829574295,3261.4973634283383),c(1736.238367887378,1543.377135494037,1450.7824586026954,1805.8650791295572,607.9264887050577,2591.857995701009),c(2246.777537907937,3550.1344454378295,4425.391591720595,3701.295692251901,3623.409866185068,3179.3610184941513),c(586.5122607974282,966.2164825655298,1159.3826610793901,2467.5304615012674,1549.7400644709244,2429.866870969696),c(4393.270595990408,3583.167487576822,6036.249672429426,9793.991142111201,3245.4244846067936,6315.372299384148),c(2098.8832545289656,2483.9012519514617,2089.5308147737805,4348.406675349783,5484.987870458069,5978.841441667688),c(3234.4277180072336,2059.059626663864,2902.3419833321195,3035.1520331805514,6601.094705507251,4228.8809815420955),c(383.917352059111,292.7094567316277,376.1000053367459,464.6212075875798,862.0166618771199,936.5824887634368),c(973.468536487614,1847.0976062719956,696.2512495490172,251.90306435471194,379.0353409715472,570.3912842651869),c(2407.8404903548994,3004.171665640593,2495.159332926221,2488.802275824554,867.2664588434848,1694.0621142676048),c(2499.0081992871424,2077.411316741082,2431.4399105344582,1693.908161638574,613.1762856714226,880.6841429054484),c(2673.239820802095,1658.9927829805108,1223.8791495978817,386.2513653438917,843.1173927982062,644.5421512196612),c(1646.0836334988269,1859.9437893260483,1896.0413492183056,2375.725789158661,2131.4175683441576,2572.4646920359924),c(2934.587253074524,3144.562094731311,3199.1812437425265,2864.977518594257,1010.0609363286106,2897.587724067149),c(3336.7381469200836,2221.4720838472435,1912.3597378796107,1668.158070615648,1436.344449997442,871.5578823572055),c(5154.014478302788,3087.6718554919353,4490.665146365815,7334.297664834302,7507.209661901836,6987.2932322485385),c(2287.2965196556006,2362.7800974418224,1834.6531252067293,1220.3304006517158,746.5211286170917,716.4114530370747),c(1187.2061652065386,708.3752369806164,857.8810039086104,803.8506675852585,569.0779911539573,1461.3424702874086),c(1213.5435033425197,1135.0520312759356,583.5766611733392,181.3702063353926,3342.0207487879084,1014.1557034235021),c(1131.4925653035014,1290.1238124284282,746.76054778639,577.6976942534727,2733.0443006895775,2056.8309710602634),c(11.142719980607444,122.95632351736086,104.12686098166105,10.076122574188478,41.99837573091936,540.7309374833972),c(1511.358019187846,1903.9878455113715,2821.527106152323,7656.733587208333,4279.634486980683,2772.1016415288077),c(1527.5656118869115,1170.8378269265108,1005.523567987085,924.7641384755203,3282.1730633713482,1427.1189932314974),c(2022.9101637520969,995.5791866890786,1782.589694715899,2945.586499187765,3699.0069425007227,1909.6700197198454),c(1700.7842588581725,702.8697299574509,1359.0886556486953,2703.7595574072416,1662.0857195511337,1913.0923674254366),c(644.2518097878485,569.8199768976201,585.9078595535257,4455.885316141127,1793.3306437102567,2000.9326252022754),c(614.8755480207926,480.81428002311264,367.55227794272895,1466.6356191318785,1739.7827146533346,955.9757924284531),c(407.2157665640175,927.6779334033719,986.8739809455935,1130.7648666589291,625.7757983906985,2339.7450480557964),c(1892.2364476158823,1992.993542385879,2252.714701386831,2089.1160803817443,6455.150349842306,3188.487279042394),c(475.0850609913537,955.2054685191989,557.9334789912883,779.2201457372423,1664.1856383376796,1078.0395272612031),c(900.5343693418198,697.3642229342855,240.11343315920348,965.0686287722742,952.3131696985965,1119.1076997282964),c(535.8635336128489,619.3695401061088,419.61570843355946,201.52245148376954,345.43664038681175,955.9757924284531),c(1305.7241868184542,1561.7288255712551,1582.8837001465938,4618.222846503052,206.84200047477785,1654.1347243690418),c(1062.6102963324736,675.3421948416238,565.7041402585764,1141.9605584080275,286.63891436352463,399.27389898563075),c(560.174922661447,405.57235070651865,864.8745990491698,1862.9631070499586,2884.238453320887,1400.8809941552988),c(2070.5199673056013,1571.822255113725,1673.8004369738649,2141.7358316025066,3107.879804088033,1430.5413409370885),c(1804.1076623147144,1878.2954794032662,3047.6533490304078,4238.68889620862,3285.322941551167,1799.0141105723992),c(1238.8678669348094,1910.4109370383978,3987.9033623722726,5736.672452237974,3627.60970375816,3217.0068432556536),c(820.5093803901844,1496.580325797131,1190.4653061485428,637.0348605236937,1093.0077283971764,1003.8886603067288),c(600.6939044091104,900.1503982875448,1568.1194437387462,2620.9114384639142,874.6161745963957,823.6450144789297),c(1126.4276925850434,898.315229279823,2223.963254697865,4347.287106174873,3849.1511357387594,2924.966505711878),c(74.96011623317735,173.42347122971046,126.66177865679666,270.93574032817907,23.09910665200565,200.77773206134577),c(472.046137360279,785.452335304932,655.8438109591189,1013.210103293397,2485.2538838771534,1600.5179436481142),c(2252.8553851700867,1817.7349021484467,1833.8760590800007,1115.0908982101917,3472.215713553758,2037.4376673952472),c(641.2128861567738,761.5951382045487,1123.6376192498649,448.9472391388422,1234.7522464890292,1105.418308905932),c(3824.991876979428,1948.0319016966948,1902.2578782321361,4210.699666835874,3126.7790731669465,3650.5042192971955),c(2242.7256397331707,1306.6403334979243,1532.3744019092208,2199.953428697818,1207.4533022639316,2906.713984615392),c(1730.1605206252286,1719.5533602353303,1718.0932061974074,3646.436802681319,1919.325770903015,1462.483252855939),c(370.7486829911204,1028.612228828071,582.0225289198816,2791.0859530502084,2520.952503248435,1257.1423905204717),c(1143.6482598278003,1271.77212235121,1202.8983641762038,1378.1896543140017,1363.8972518616063,1793.3101977297474),c(1580.240288158874,1072.6562850133944,1765.494239927865,3118.000152123879,2694.195803138477,2489.1875645332752),c(2219.4272252282644,1020.353968293323,1591.4314275406107,3356.468386379673,2352.959000324757,2645.4747764219364),c(285.6588213210272,548.7155333088193,380.76240209711875,756.8287622390457,102.89602054075243,297.7442503864275),c(1628.86306625607,2249.917203466932,3882.999435263883,3101.2066145002314,1261.0012313208538,1399.7402115867685),c(489.2667046030359,913.9141658454583,884.3012522173901,1055.7537319399705,1876.2774357788226,698.1589319405887),c(810.3796349532686,1311.228256017229,1551.801055077441,2349.975698135735,1825.8793849017193,851.0237961236587),c(828.6131767397172,584.5013289593945,1263.5095220610513,1633.4514261934432,769.6202352690973,1184.1323061345279),c(1192.2710379249966,1268.1017843357665,929.3710875676613,811.6876518096274,531.27945299613,1584.546987688689),c(1486.0336555955564,836.8370675211426,1781.8126285891701,399.6861954428096,263.539807711519,425.51189806182936),c(148.90725792266312,813.8974549246201,1122.860553123136,712.0459952426525,1388.046317906885,697.0181493720582),c(2149.531981713545,2755.5062650942887,1456.998987616526,2615.313592589365,1521.3911608525539,3066.423544209644),c(2179.9212180242926,1759.9270784052098,1641.9407257779835,2732.868355954897,881.9658903493066,1493.2843822062591),c(1990.4949783539662,2285.702999117507,2035.9132520294922,2028.6593449366135,3382.969165125555,1943.8934967757566),c(496.35752640887705,654.237751252823,812.0341024316104,965.0686287722742,867.2664588434848,352.50181367588544),c(802.2758386037359,964.381313557808,2291.568007723272,1909.9850123961714,796.9191794941949,459.73537511774055),c(1527.5656118869115,1262.5962773126012,629.4235626503391,1606.5817659956074,328.637290094444,457.4538099806798),c(1291.5425432067718,1006.5902007354094,632.5318271572545,1858.4848303503193,1847.9285321604518,1248.0161299722288),c(2830.250875074291,2797.71515227189,4877.644077476764,11450.95352097775,5264.496397870742,2856.5195516000554),c(1075.7789654004641,1004.7550317276877,1047.485138830441,1159.8736652065847,113.39561447348228,391.28842100591817),c(3269.881827036439,2616.0334205074314,2816.0876432652212,2358.9322515350136,2484.20392448388,1513.8184684398059),c(1354.3469649156502,1281.86555189368,1751.5070496467463,963.9490595973643,1805.9301564295326,846.4606658495372),c(2582.072111869852,2965.633116478435,3137.79301973095,5063.811378117165,3466.965916587393,3153.1230194179525),c(2328.8284759469557,2260.9282175132626,2959.067810583323,2385.8019117328495,946.0134133389586,1825.2521096485978),c(1480.9687828770984,899.2328137836839,1240.1975382591868,1649.125394642181,702.4228340996264,1491.0028170691983),c(812.4055840406518,400.9844281872142,956.5684020031698,1549.483738075206,1373.346886401063,3437.177878982016),c(1052.4805508955576,784.5347508010711,561.8188096249324,921.4054309507908,4721.667391548609,3329.9443175401607),c(2043.1696546259286,1302.9699954824807,1376.9611765634581,810.5680826347176,2707.8452752510257,1064.3501364388385),c(927.8846820214926,960.7109755423644,410.2909149128137,592.2520935273005,156.44394959767462,629.7119778287663),c(735.4195187200913,808.3919479014546,476.34153568476285,512.7626821087025,1344.9979827826926,576.0951971078387),c(1107.1811762549032,1062.5628554709244,1238.6434060057293,1892.0719055976142,3779.8538157827425,2465.2311305941375),c(1840.5747458876115,1704.8720081735557,1613.9663452157463,1110.6126215105523,1701.9841764955072,1935.908018796044),c(1912.495938489714,1306.6403334979243,1503.6229552202547,3615.088865783844,1838.478897620995,1388.3323859014647),c(706.0432569530353,309.225977801124,289.84566526984753,528.4366505574402,1200.1035865110207,471.1432008030443),c(1334.0874740418185,1381.8822628145183,1333.4454734666444,2441.780370478341,4180.938304013022,2071.6611444511586),c(2345.0360686460212,2596.7641459263527,2216.969659557306,1456.55949655769,2603.8992953170005,3717.810390840488),c(4991.938551312135,3128.963158165676,5172.152139506985,1874.158798799057,4669.16942188496,5878.452575637015),c(1422.2162593429864,1358.9426502179958,1094.8861725608986,2813.477336548405,921.86434729368,998.184747464077),c(508.51322093317606,474.39118849608633,1309.3564235380513,1503.5814019039028,2662.6970213402874,765.4651034838807),c(497.37050095256865,863.4470181331087,1132.9624127706106,788.1766991365209,2186.0154567943528,823.6450144789297))
targetgene="Notch1"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1036.2729581964923,1785.619444513315,3416.7597592265943,11012.082404413097,3788.2534909289266,3010.525198351656),c(445.70879922429776,1324.0744390712816,1859.5192412620515,1186.7433254044208,172.1933404967694,659.372324610556),c(2417.9702357918154,2060.8947956715856,3371.689923876323,14331.605008020744,4601.972020715489,5027.428779513357),c(1880.0807530915831,2230.6479288858527,8378.32697839007,3909.5355587851295,2030.621466589951,2702.5139048484552),c(1094.0125071869127,846.0129125597516,2536.3438376428485,1585.3099516723205,1943.4748369482934,947.9903144487405),c(407.2157665640175,1079.9969610442815,2780.342601435696,849.7530037565616,976.4622357438751,674.2024980014509),c(31.40221085443916,697.3642229342855,1361.419854028882,31.347936897475265,61.94760420310606,52.47599815239719),c(649.3166825063065,779.9468282817667,2847.947354461103,3053.0651399791086,329.687249487717,691.3142365294065),c(2117.1167963154144,4374.125329904919,3679.4081100609333,5315.714442471877,1203.2534646908398,3540.9890927182796),c(345.42431939883073,1275.4424603666537,3192.964714728696,5517.236893955646,836.8176364385682,349.07946597029434),c(1321.9317795175195,3278.5294322950026,9637.17410369075,3585.9800672361885,2835.94032123033,6268.600214074403),c(944.092274720558,874.4580321794396,1207.5607609365766,3072.0978159525757,1952.9244714877502,1018.7188336976236),c(1837.5358222565367,2010.427647959236,4395.086012778171,7879.52785301539,2307.810746414019,2051.1270582176116),c(1317.8798813427532,1946.196732688973,1301.585762270763,2819.075182422954,992.2116266429699,1367.798299667918),c(1336.1134231292017,777.194074770184,585.9078595535257,1518.1358011777306,698.2229965265344,1101.9959612003408),c(1232.7900196726598,1412.1625514419281,4430.831054607696,1817.0607708786556,2954.585732670177,3063.001196504053),c(1268.2441287018655,1936.103303146503,1373.852912056543,3227.7179312650424,4852.912315707732,1947.3158444813478),c(1216.5824269735945,752.4192931659396,1729.7491980983395,2052.17029760972,853.616986730936,1230.9043914442732),c(1078.817889031539,1489.239649766244,2370.828752649611,3830.0461473665314,1545.5402268978326,2547.367475528324),c(1325.9836776922857,3455.623241540157,11997.123930566157,8131.430917370101,8596.01755272592,4060.0451613995997),c(983.5982819245298,1678.2620575615897,1926.3469281607295,4757.049424191871,1687.2847449896854,3596.887438576268),c(1119.3368707792024,1384.635016326101,2064.664698718458,5413.116960689033,3758.854627917283,2791.494945193824),c(392.0211484086437,334.0007594053683,1230.0956786117122,984.1013047457413,363.28595007245247,598.9108484784462),c(1420.1903102556032,1091.0079750906125,4062.5017105382385,2822.433889947684,2325.66005609966,1736.2710693032286),c(1432.3460047799024,2233.4006823974355,3188.302317968323,7733.9838602771115,5362.142621445129,3732.6405642313825))
targetgene="Cdkn2a"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(740.4843914385492,609.2761105636389,586.6849256802544,1999.5505463889579,1751.3322679793373,1204.6663923680746),c(2632.7208390544315,1989.3232043704354,3318.8494272587636,5025.746026170231,1942.4248775550204,1908.529237151315),c(872.1710821184554,943.2768699690072,1467.1008472640005,1576.3533982730419,926.0641848667719,2165.2053150706492),c(1207.4656560803703,877.2107856910222,488.7745937124239,2231.3013655952927,258.29001074515406,2565.6199966248105),c(202.59490873831714,395.47892116404876,582.7995950466103,452.30594666357166,453.58245789392913,773.4505814635933),c(505.4742973021013,1556.2233185480898,1767.0483721813225,965.0686287722742,200.54224411513997,1243.4529996981073),c(206.6468069130835,735.9027720964434,578.9142644129663,1449.8420815082309,2376.0581069767627,1981.539321537259),c(738.458442351166,396.39650566790965,315.4888474518984,8616.20437010606,169.04346231695044,1075.7579621241423),c(1695.7193861397145,423.0064562798758,235.45103639883058,929.2424151751596,144.8943962716718,581.7991099504906),c(1106.1682017112116,631.2981386563006,591.3473224406273,2132.779278203228,1743.9825522264266,1836.6599353339016),c(1156.816928895791,618.451955602248,836.9002184869324,503.8061287094239,942.8635351591397,638.8382383770092),c(1065.6492199635481,2108.6091898723525,3031.3349603691026,2822.433889947684,1735.5828770802427,1457.9201225818174),c(927.8846820214926,1500.2506638125747,1157.0514626992037,1133.004005008749,1037.3598805537083,1266.2686510687147),c(1931.7424548198542,1959.9605002468866,1774.8190334486108,1969.3221786663926,3071.1312253234782,2979.724069001336),c(2168.778498043685,1968.2187607816347,2464.0766878570685,2973.575728560511,3531.013439577045,2165.2053150706492),c(2009.7414946841063,2199.450055754582,1979.9644909050176,2196.594721173088,2274.2120458292834,2756.130685569383),c(1716.9918515572379,1446.1131780847816,816.6964991919833,587.7738168276612,1340.7981452096005,349.07946597029434),c(2406.827515811208,3088.589439995796,4293.290350176696,6792.426184177944,4215.586963991031,3045.8894579760977),c(1330.035575867052,1074.4914540211162,1546.3615921903395,2768.6945695520117,1006.9110581487917,1903.9661068771936),c(1879.0677785478917,2326.0767172873866,2776.457270802052,1483.4291567555258,1511.941526313097,1137.3602208247826),c(603.7328280401852,1324.0744390712816,1903.8120104855939,1808.1042174793768,410.53412276973677,692.4550190979368),c(441.6569010495314,599.182681021169,641.0795545512714,1118.449605734921,1126.606428981912,800.8293631083222),c(1656.2133789357429,2050.8013661291156,1372.2987798030852,2585.0852248667993,951.2632103053236,1232.0451740128035),c(1360.4248121777998,1490.1572342701047,1066.1347258719325,2324.225607112809,1017.4106520815216,2562.1976489192193),c(470.0201882728958,1616.7838958029092,1185.8029093881698,7032.013987608648,464.0820518266589,3261.4973634283383),c(2438.229726665647,1755.3391558859055,1428.2475409275598,1168.8302186058634,438.88302638810734,731.2416264279695),c(2958.898642123122,4043.794908514995,4030.6419993423574,9033.803672347425,3519.4638862510424,5559.033456448511),c(1183.1542670317722,854.2711730944998,843.8938136274918,1939.093810943827,1438.4443687839882,1120.248482296827),c(1823.3541786448545,1251.5852632662702,1376.9611765634581,3577.02351383691,2664.7969401268333,2697.9507745743335),c(581.4473880789702,529.4462587277404,437.4882293483222,924.7641384755203,908.2148751811312,991.3400520528946),c(216.77655234999935,728.5620960655561,770.0725315882545,1718.5386834865903,1455.2437190763558,2061.394101334385),c(1471.8520119838743,1881.96581741871,1854.0797783749497,1878.6370754986963,1048.909433879711,1241.1714345610465),c(513.578093651634,634.0508921678833,453.80661800962724,242.9465109554333,513.4301433104891,59.320693563579425),c(1657.2263534794345,2044.3782746020895,2882.9153301638994,2454.095631402349,1678.8850698435015,1468.187165698591))
targetgene="Irs1"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(986.6372055556045,1658.9927829805108,3331.2824852864246,4242.047603733349,2436.955751786596,2512.003215903883),c(193.47813784509287,396.39650566790965,212.13905259696617,464.6212075875798,2050.570695062138,587.5030227931425),c(1094.0125071869127,2000.3342184167664,1965.2002344971702,1646.8862562923612,2642.747792868101,1732.8487215976375),c(2616.513246355366,2878.4625886116496,4799.160398677154,9738.012683365709,2926.2368290518066,5313.76520421448),c(2767.4464533654123,1743.4105573357137,1978.41035865156,4488.352822213512,1353.3976579288765,2043.1415802378992),c(484.201831884578,549.6331178126803,836.9002184869324,2529.106766121308,2593.3997013842704,1258.283173089002),c(898.5084202544366,628.5453851447178,636.4171577908985,2239.138349819662,520.7798590634001,2634.066950736633),c(1853.743414955602,979.9802501234433,1064.580593618475,1515.896662827911,2150.3168374230713,1659.8386372116936),c(1203.413757905604,990.9912641697741,1352.095060508136,1387.1462077132805,174.29325928331536,1076.8987446926726),c(2628.668940879665,3088.589439995796,3412.87442859295,6150.913046954611,3881.699876930222,3402.9544019261048),c(2322.750628684806,1949.8670707044166,1597.6479565544412,1346.8417174165265,1290.4000943324975,1811.5627188262333),c(1544.7861791296684,1305.7227489940635,1125.9688176300513,1145.319265932757,3125.7291137736734,3028.777719448142),c(1179.1023688570058,1849.8503597835784,1349.7638621279496,915.8075850762417,585.8773414463251,2606.6881690919035),c(1000.8188491672868,1278.1952138782365,996.9758405930681,1168.8302186058634,1865.7778418460925,962.8204878396353),c(396.07304658341,1516.767184882071,1111.9816273489325,1982.7570087653105,2371.858269403671,1133.9378731191914),c(1087.934659924763,688.1883778956765,685.3723237748138,456.784223363211,1565.4894553700192,1389.473168469995),c(1511.358019187846,938.6889474497027,941.8041455953223,358.2621359711459,218.39155380078068,823.6450144789297),c(272.49015225303657,487.23737155013896,724.2256301112544,417.5993022413669,200.54224411513997,256.6760779193341),c(1613.6684481006962,1329.579946094447,1488.0816326856784,1128.5257283091096,767.5203164825514,1023.2819639717452),c(938.0144274584085,1413.99772044965,2640.470698624509,3048.5868632794695,803.2189358538328,2788.072597488233),c(1109.2071253422864,796.4633493512629,868.7599296828139,1092.6995147119949,1508.7916481332782,2638.630081010754),c(893.4435475359787,1812.2293951252814,2345.18557046756,2433.943386253972,1443.694165750353,889.8104034536914),c(1537.6953573238272,319.31940734359387,198.92892844257634,1063.5907161643393,1472.0430693687235,959.3981401340442),c(681.7318679044372,787.2875043126538,746.76054778639,1449.8420815082309,217.3415944075077,625.1488475546447),c(992.7150528177541,550.5507023165412,545.5004209636273,410.88188719190794,404.23436641009886,1146.4864813730255),c(953.2090456137822,557.8913783474284,285.18326850947466,294.4466930012855,327.587330701171,173.3989504166168),c(2003.6636474219567,2084.751992771969,1674.5775031005937,1829.3760318026636,1094.0576877904493,2213.1181829489246),c(745.5492641570072,1104.771742648526,748.3146800398476,1506.9401094286325,997.4614236093348,1775.0576766332613),c(1846.6525931497608,811.1447014130373,1017.9566260147461,1326.6894722681495,4414.029289319625,2673.994340635196),c(617.9144716518673,584.5013289593945,1057.5869984779156,1304.298088769953,2658.4971837671956,444.9052017268457))
targetgene="Gnas"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3249.622336162607,3706.123811094183,4582.358949319815,3836.7635624159902,1797.5304812833488,4425.095583329319),c(2431.1389048598057,4008.9266973682807,6713.074268810223,4769.364685115879,2421.206360887501,3951.6708173892143),c(837.7299476329415,1190.1071015075897,1182.6946448812546,1025.525364217405,1490.9423384476374,1114.544569454175),c(1257.101408721258,1057.057348447759,1801.2392817573905,2868.336226118987,1991.7729690388508,1229.7636088757429),c(2153.5838798883115,1910.4109370383978,1822.9971333057972,5217.192355079812,1543.4403081112866,1129.37474284507),c(2257.9202578885447,1860.861373829909,2636.585367990865,2945.586499187765,2605.9992141035464,4520.921319085871),c(335.2945739619149,401.9020126910751,477.89566793822047,1458.7986349075097,1521.3911608525539,548.7164154631097),c(1150.7390816336415,723.0565890423908,469.34794054420354,413.1210255417276,311.8379398020763,752.9164952300466),c(1227.725146954202,1317.6513475442553,1282.1591091025427,473.57776098685844,1927.7254460491988,1784.1839371815045),c(938.0144274584085,579.9134064400901,525.2967016686781,1056.8733011148804,1145.5056980608256,1497.8475124803806),c(1206.4526815366787,556.9737938435675,497.3223211064408,644.8718447480626,1024.7603678344324,2354.575221446691),c(1070.7140926820061,2330.664639806691,1113.5357596023903,2196.594721173088,3406.0682717775603,2112.729316918252),c(1012.9745436915858,734.9851875925825,1069.2429903788477,1734.212651935328,2849.5897933428787,742.6494521132732),c(1572.1364918093411,771.6885677470185,623.9840997632375,4184.949575812948,908.2148751811312,1613.0665519019483),c(2252.8553851700867,1769.102923443819,871.8681941897291,1190.1020329291503,2264.7624112898266,1267.409433637245),c(1406.008666643921,552.385871324263,469.34794054420354,676.2197816455379,1843.72869458736,1043.816050205292),c(1244.945714196959,968.0516515732515,1902.2578782321361,1782.3541264564508,3371.4196117995516,3019.651458899899),c(2066.468069130835,4528.2795265535515,6281.025502349002,4785.038653564618,450.43257971411015,3958.5155128003967),c(2712.745828006067,1200.2005310500597,949.5748068626104,1960.365625267114,2827.540646084146,1544.619597790126),c(1222.660274235744,521.1879981929923,804.2634411643223,1173.3084953055027,1043.659636913346,1064.3501364388385),c(591.5771335158861,1114.865172190996,1948.881845835865,9793.991142111201,1544.4902675045596,2621.5183424827987),c(2321.7376541411145,1743.4105573357137,1521.4954761350175,4860.049788283576,1256.801393747762,3091.5207607173124),c(587.5252353411198,604.6881880443344,856.3268716551528,649.3501214477019,459.882214253567,367.3319870667803),c(1754.4719096738265,2176.5104431580594,2023.4801940018313,4820.864867161732,3182.426921010415,6657.60706994326),c(1248.9976123717254,992.8264331774959,1251.0764640333903,1002.0144115442986,421.0337167024666,1349.545778571432),c(683.7578169918204,1534.201290455428,1216.8855544573223,809.4485134598077,234.14094469987543,268.0839036046378),c(252.23066137920486,904.7383208068493,509.7553791341019,183.60934468521225,975.4122763506022,497.3811998792429),c(1351.3080412845754,1256.1731857855748,1449.2283263492377,3877.0680527127442,964.9126824178724,2129.8410554462075),c(2322.750628684806,2395.813139580815,2239.5045772324415,6475.588107678462,6448.850593482668,7549.699038534012),c(999.8058746235952,1181.8488409728418,792.6074492633901,1081.5038229628967,1541.3403893247405,1268.5502162057755),c(1237.8548923911178,1930.5977961233377,2392.5866041980175,3218.7613778657637,2980.8347175020017,1881.150455506586),c(1527.5656118869115,1080.9145455481425,1097.9944370678138,1929.0176883696386,1583.33876505566,1297.0697804190347),c(595.6290316906525,634.9684766717442,466.2396760372883,1238.243507450273,125.99512719275809,370.7543347723714),c(1430.3200556925192,680.8477018647892,527.6279000488646,419.83844059118655,3983.5459380777015,1435.10447121121),c(1999.6117492471903,1113.947587687135,1354.4262588883225,413.1210255417276,188.99269078913713,306.8705109346705),c(304.9053376511673,1185.5191789882854,1759.2777109140345,1553.9620147748453,344.3866809935388,1057.5054410276564),c(964.3517655943897,715.7159130115035,292.17686365003397,1315.4937805190514,172.1933404967694,750.6349300929859),c(109.40125071869127,425.7592097914585,860.9892684155257,1092.6995147119949,2405.4569699884064,1398.599429018238),c(1211.5175542551367,779.9468282817667,776.289060602085,929.2424151751596,1379.646642760701,1857.1940215674483),c(3623.4099427848023,3300.5514603876645,5807.7922311711545,4318.178307627218,4844.512640561548,5588.693803230301),c(1205.439706992987,1066.233193486368,810.4799701781528,1015.4492416432166,2556.6511226197163,1516.1000335768665),c(1594.421931770556,1401.1515373955972,704.7989769430342,1281.9067052717564,2048.470776275592,866.994752083084),c(121.5569452429903,605.6057725481953,310.0493845647967,1369.233100914723,453.58245789392913,1468.187165698591),c(1750.4200114990604,2245.329280947627,2170.345691953577,2530.2263352962177,5142.701108251076,5227.065729006172),c(1692.68046250864,1249.7500942585484,1015.6254276345596,1813.702063353926,1704.084095282053,4848.325916254088),c(2217.4012761408812,1870.0372188685183,1697.8894869024582,2334.3017296869975,1799.6304000698947,3420.06614045406),c(1085.9087108373799,525.7759207122969,683.8181915213562,368.3382585453344,140.69455869857987,602.3331961840373),c(1073.753016313081,1388.3053543415447,1899.9266798519498,3065.380400903117,2924.1369102652607,2867.9273772853594),c(1642.0317353240605,1877.3778948994054,2710.4066500301024,2641.0636836122912,1480.4427445149074,903.4997942760559),c(560.174922661447,1064.3980244786462,1077.013651646136,2214.5078279716454,1545.5402268978326,2655.74181953871),c(697.9394606035027,1230.4808196774695,1021.8419566483901,1449.8420815082309,272.98944225097586,1350.6865611399624),c(629.0571916324748,645.0619062142141,425.05517132066115,420.95800976609644,422.0836760957396,508.78902556454665),c(898.5084202544366,481.73186452697354,1076.236585519407,454.5450850133913,429.4333918486505,188.22912380751166),c(1709.901029751397,1610.3608042758829,1348.9867960012207,1605.4621968206975,401.08448823027993,2151.5159242482846),c(771.8866022929884,1689.2730716079204,1469.432045644187,2252.5731799185796,949.1632915187776,860.1500566719017),c(1202.4007833619123,1699.3665011503904,1672.2463047204074,2044.3333133853512,1768.131618271705,791.7031025600793),c(1170.9985725074732,1418.5856429689545,1951.9901103427803,1604.3426276457876,1141.3058604877338,2044.2823628064295),c(956.247969244857,2323.323963775804,2272.1413545550517,1889.8327672477944,435.73314820828836,951.4126621543317),c(1605.5646517511634,2295.7964286599768,2671.553343693662,5542.986984978573,659.374498975434,1273.113346479897),c(1740.2902660621444,3001.41891212901,4135.545926450747,4735.7776098685845,2986.0845144683667,2351.1528737411),c(829.6261512834087,2103.1036828491874,5645.385410684832,5378.410316266828,1533.9906735718296,1156.7535244897988),c(3010.560343851393,2826.160271891578,2926.431033260713,1390.50491523801,3701.1068612872687,1836.6599353339016),c(1371.5675321584072,2403.153815611702,3659.204390765984,2620.9114384639142,540.7290875355868,984.4953566417124),c(1209.4916051677535,1203.8708690655033,711.0155059568647,925.8837076504301,946.0134133389586,1297.0697804190347),c(1186.193190662847,1982.900112843409,1516.8330793746445,4984.321966698567,3485.865185666307,3109.7732818137983),c(2844.432518685973,3108.776299080736,3148.6719455051534,5285.486074749311,2888.4382908939792,2498.313825081518),c(1505.2801719256965,1449.7835161002251,1699.4436191559157,1847.2891386012209,1323.9987949172328,1335.8563877490676),c(1351.3080412845754,1324.0744390712816,1682.348164367882,4253.243295482447,1467.8432317956317,2638.630081010754),c(680.7188933607456,2238.9061894206006,1347.4326637477632,2177.562045199621,2744.5938540155803,2211.9774003803946),c(2095.844330897891,1805.806303598255,1058.3640646046445,1660.321086391279,2425.4061984605933,2493.750694807397),c(773.9125513803715,1048.799087913011,1175.7010497406952,2772.0532770767413,1995.9728066119426,4631.577228233317),c(89.14175984485955,404.65476620265775,197.3747961891187,709.8068568928328,258.29001074515406,131.18999538099297),c(651.3426315936897,1159.8268128801801,905.2820376390681,1145.319265932757,1525.590998425646,1070.0540492814905),c(1573.1494663530327,2164.581844607868,1446.1200618423225,1596.5056434214189,386.38505672445814,1747.6788949885324),c(3337.7511214637752,4234.652485318063,4788.281472902951,5578.813198575687,2731.9943412963044,1918.7962802680884),c(921.806834759343,1316.7337630403943,1617.0746097226615,4771.603823465699,3574.0617747012375,1623.3335950187218),c(1215.5694524299029,830.4139759941163,1372.2987798030852,896.7749091027746,544.9289251086788,966.2428355452265),c(1885.145625810041,1131.381693260492,782.5055896159155,2342.1387139113663,2857.9894684890623,2165.2053150706492),c(2415.944286704432,3396.897833293059,2561.987019824899,1464.3964807820587,2986.0845144683667,1659.8386372116936),c(1445.514673847893,539.5396882702104,648.0731496918307,979.623028046102,62.997563596379045,472.28398337157466),c(771.8866022929884,238.5719710038345,368.32934406945776,212.71814323286787,119.69537083312018,27.378781644728967),c(1809.1725350331722,1796.630458559646,2164.906229066475,4771.603823465699,3847.0512169522135,3595.746656007738),c(928.8976565651842,2563.73110378736,1479.5339052916615,640.3935680484233,1738.7327552600616,1386.0508207644039),c(753.6530605065399,897.3976447759621,487.9975275856951,547.4693265309073,301.3383458693464,1227.482043738682),c(685.7837660792036,232.1488794768082,177.17107689416954,754.589623889226,266.68968589133794,293.181120112306),c(2680.330642607936,2460.0440548510783,2945.857686428933,5227.268477654,2552.4512850466244,4239.148024658868),c(486.2277809719612,497.33080109260885,434.37996484140695,1335.6460256674281,506.08042755757833,434.63815861007237),c(2094.831356354199,2039.7903520827851,2523.1337134884584,3655.3933560805976,2287.861517941832,1116.8261345912358),c(557.1359990303722,1345.1788826600823,1144.6184046715427,881.1009406540369,862.0166618771199,1313.04073637846),c(319.0869812628495,63.31333076640224,27.197314435508485,311.24023062493296,132.294883552396,296.6034678178971),c(1273.3090014203233,728.5620960655561,411.06798103954253,531.7953580821696,2464.2546960116933,843.0383181439461),c(315.0350830880832,340.4238509323946,157.7444237259492,155.62011531246648,401.08448823027993,1140.7825685303737),c(36.46708357289709,298.21496375479313,299.17045879059333,364.97955102060484,22.049147258732663,20.534086233546724),c(225.89332324322362,875.3756166833004,1332.6684073399156,3025.075910606363,2525.1523408215266,788.2807548544881),c(534.8505590691573,615.6992020906653,345.79442639432216,535.1540656068992,2276.3119646158293,821.363449341869),c(2532.4363592289646,1632.3828323685445,1653.5967176789159,2354.4539748353745,2931.4866260181716,3240.9632771947913),c(3109.8318491331684,2816.066842349108,3561.294058798154,5981.858101543226,3285.322941551167,2630.6446030310417),c(903.5732929728945,1766.3501699322362,1732.8574626052548,3079.934800176945,1703.0341358887802,3582.057265185373),c(1883.119676722658,1793.8777050480633,2548.7768956705095,6027.76043771453,548.0788032884976,2201.710357263621),c(1651.1485062172849,3168.4192918316944,2833.960164179984,5766.900819960539,1222.1527337697535,2875.912855265072),c(1461.7222665469583,903.8207363029884,1931.0093249211022,2448.4977855278003,2347.709203358392,2647.756341558997),c(833.6780494581751,1892.9768314650407,2271.3642884283227,2793.325091400028,1902.5264206106472,1460.2016877188782),c(1095.0254817306043,2032.4496760518978,855.549805528424,1597.6252125963288,361.1860312859065,1441.9491666223923),c(1225.6991978668188,968.0516515732515,2061.556434211543,5352.660225243902,1532.9407141785566,1880.0096729380557),c(775.9385004677547,1344.2612981562213,1184.2487771347123,1654.7232405167301,1847.9285321604518,900.0774465704648),c(348.4632430299055,280.780858181436,782.5055896159155,413.1210255417276,382.1852191513662,785.9991897174274),c(899.5213947981282,1169.92024242265,1087.1155112936106,1005.3731190690281,878.8160121694876,1279.9580418910791),c(444.69582468060617,382.6327381099961,167.84628337342377,915.8075850762417,481.9313615122997,381.0213778891448),c(762.7698313997641,612.9464485790825,651.9584803254747,1109.4930523356425,2043.220979309227,1041.534485068231),c(1335.10044858551,1580.0805156484732,1572.7818404991192,2407.0737260561364,675.1238898745287,531.6046769351541),c(603.7328280401852,335.83592841309013,509.7553791341019,583.2955401280219,185.84281260931817,166.55425500543456),c(1355.3599394593418,1598.4322057256911,1047.485138830441,956.1120753729956,1220.0528149832076,791.7031025600793),c(1575.175415440416,2102.186098345326,4688.817008681663,4731.299333168945,792.7193419211029,2727.6111213561235),c(1537.6953573238272,1130.4641087566313,1702.551883662831,772.5027306877834,380.0853003648202,913.7668373928293))
targetgene="Notch3"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3947.5617967661096,4693.444737248514,7291.21146709646,11653.59554163643,3032.2827277723777,3134.8704983214666),c(2376.4382795004603,1743.4105573357137,1989.2892844257633,2944.4669300128553,957.5629666649614,968.5244006822873),c(1507.3061210130797,1406.6570444187628,1920.9074652736278,864.3074030303894,1069.9086217451706,878.4025777683877),c(437.6050028747651,614.7816175868043,822.9130282058138,1281.9067052717564,5346.393230546035,1817.266631668885),c(1567.0716190908831,1053.3870104323155,1702.551883662831,1851.7674153008602,432.5832700284694,2076.22427472528),c(882.3008275553713,703.7873144613118,675.2704641273392,641.513137223333,1034.2100023738892,1027.8450942458667),c(1057.5454236140156,878.1283701948831,1687.7876272549836,882.2205098289468,374.83550339845533,755.1980603671074),c(354.541090292055,1131.381693260492,780.9514573624579,673.9806432957182,2792.8919861061377,1340.419518023189),c(1223.6732487794357,1635.1355858801273,3210.0601695167297,1365.8743933899937,618.4260826377875,1027.8450942458667),c(466.98126464182104,1637.88833939171,1697.8894869024582,1134.1235741836588,206.84200047477785,1238.8898694239858),c(1689.6415388775652,1660.8279519882326,2945.0806203022044,3531.1211776656064,1404.8456681992527,2420.740610421453),c(2590.175908219385,2032.4496760518978,2477.2868120114586,3658.7520636053273,535.4792905692219,962.8204878396353),c(1956.053843868452,1969.1363452854955,1397.1648958584071,2532.4654736460375,837.8675958318413,477.98789621422657),c(3253.6742343373735,2622.456512034458,3698.0576971024248,4581.277063731028,2506.253071742613,3368.730924870193),c(2507.1119956366747,1787.4546135210371,1275.9425800887122,3704.6543997766303,635.2254329301553,963.9612704081658),c(355.5540648357466,412.91302673740586,782.5055896159155,2296.2363777400633,952.3131696985965,250.9721650766822),c(2012.780418315181,1625.0421563376574,1899.9266798519498,3112.4023062493297,1368.0970894346983,2437.852348949408),c(1552.889975479201,1344.2612981562213,1582.106634019865,2118.2248789294,3147.778261032406,1206.9479575051353),c(692.8745878850447,534.0341812470449,494.2140565995256,687.4154733946361,1026.8602866209783,830.489709890112),c(334.2815994182233,835.9194830172817,652.7355464522036,939.3185377493481,492.4309554450295,588.6438053616728),c(1536.6823827801356,2995.913405105845,3609.47215865534,2448.4977855278003,2048.470776275592,4234.584894384747),c(388.98222477756894,276.1929356621315,265.7566153412543,684.0567658699067,1967.623902993572,687.8918888238153),c(900.5343693418198,881.7987082103268,621.652901383051,1149.7975426323962,754.9208037632756,1608.5034216278268),c(379.8654538843447,376.2096465829698,305.3869878044238,688.535042569546,674.0739304812557,1276.5356941854882),c(1554.9159245665842,1246.9973407469658,2066.995897098645,1536.0489079762879,1152.8554138137365,851.0237961236587),c(664.5113006616803,1113.947587687135,981.4345180584918,1221.4499698266254,6061.415577364937,2290.6913976089904),c(873.184056662147,746.9137861427741,823.6900943325427,2100.3117721308427,1062.55890599226,2585.0133002898265),c(1801.0687386836396,2587.5883008877436,3827.050674139408,3823.3287323170725,2481.054046304061,1190.97700154571),c(1924.651633014013,2535.2859841676723,4587.021346080188,3373.2619240033205,2027.4715884101322,5054.807561158085),c(1268.2441287018655,1486.4868962546611,3001.806447553408,1720.77782183641,2343.5093657853004,1592.5324656684015),c(898.5084202544366,620.2871246099697,2105.0721373083566,1893.191474772524,186.89277200259116,458.5945925492102),c(1231.7770451289684,2687.605011808582,2568.2035488387296,3032.912894830732,1792.2806843169838,1358.672039119675),c(1149.72610708995,790.0402578242366,659.729141592763,528.4366505574402,488.23111787193756,1227.482043738682),c(1174.037496138548,1243.327002731522,1446.8971279690513,1884.2349213732455,2691.045924958658,2250.764007710427),c(864.0672857689227,1264.431446320323,829.9066233463732,3214.2831011661247,431.5333106351964,3255.7934505856865),c(1325.9836776922857,1630.5476633608228,2197.5430063890853,3463.9470271710165,2822.290849117781,2350.01209117257),c(1607.5906008385466,1964.5484227661912,1763.9401076744073,2896.3254554917326,893.5154436753094,2623.7999076198594),c(159.03700335957896,479.89669551925175,676.8245963807968,386.2513653438917,870.4163370233038,277.2101641528808),c(3133.1302636380747,2806.890997310499,5777.48665222873,9021.488411423417,2757.193366734856,1865.179499547161),c(286.6717958647188,661.5784272837103,933.2564182013053,3527.762470140877,317.0877367684412,823.6450144789297),c(1694.7064115960231,1564.481579082838,1732.080396478526,1098.297360586544,4622.971208580949,1262.8463033631235),c(183.34839240817703,233.98404848453,412.62211329300015,832.9594661329141,1919.325770903015,1564.0129014551424),c(347.45026848621393,222.05544993433827,188.82706879510175,167.93537623647464,27.298944225097586,233.8604265487266),c(1205.439706992987,1784.7018600094543,1833.8760590800007,2740.705340179266,4155.7392785744705,3237.5409294892),c(1490.0855537703228,1963.6308382623301,1711.099611056848,1642.4079795927219,450.43257971411015,1318.744649221112),c(1121.3628198665854,1413.99772044965,1228.5415463582547,1237.1239382753631,293.98863011643556,626.2896301231751),c(736.4324932637828,2055.3892886484205,2243.3899078660857,597.8499394018497,306.5881428357113,1963.286800440773),c(1293.568492294155,2322.406379271943,3279.2190547955943,1969.3221786663926,349.6364779599037,3485.0907468602913),c(2747.1869624915807,1500.2506638125747,1477.9797730382038,384.01222699407197,678.2737680543477,1173.8652630177544),c(1393.852972119622,787.2875043126538,984.5427825654072,602.328216101489,828.4179612923845,580.6583273819601),c(614.8755480207926,432.1823013184848,1122.860553123136,676.2197816455379,1119.256713229001,398.1331164171004),c(437.6050028747651,331.2480058937856,481.7809985718646,638.1544296986036,575.3777475135953,293.181120112306),c(950.1701219827074,1302.05241097862,1028.0584856622206,998.6557040195692,2144.0170810634336,2361.4199168578734),c(2285.2705705682174,2308.6426117140295,2611.719251935543,2997.086681233617,1742.9325928331534,1927.9225408163315),c(591.5771335158861,596.4299275095863,1021.8419566483901,1286.3849819713957,810.5686516067436,596.6292833413854),c(827.6002021960256,1027.6946443242102,1394.056631351492,1937.9742417689172,687.7234025938045,1039.2529199311705),c(1306.7371613621456,1974.641852308661,1414.260350646441,791.5354066612505,2014.8720756908565,1925.6409756792707),c(8.103796349532686,77.07709832431577,111.12045612222038,127.63088593972071,4.199837573091936,4.5631302741214945),c(866.0932348563058,704.7048989651727,1000.0841050999834,2270.486286717137,340.18684342044685,181.3844283963294),c(1470.8390374401827,863.4470181331087,1693.2270901420852,2037.615898335892,3408.168190564106,2077.3650572938104),c(1215.5694524299029,838.6722365288643,596.0097192010002,1387.1462077132805,2105.168583512333,2246.2008774363057),c(1037.2859327401839,1755.3391558859055,1024.1731550285765,542.991049831268,1773.38141523807,455.17224484361907),c(2233.608868839947,1372.7064177759094,1422.0310119137293,1667.0385014407382,4953.708417461939,1650.7123766634506),c(922.8198093030346,1643.3938464148755,1324.1206799458987,1471.1138958315178,1062.55890599226,484.8325916254088),c(1508.3190955567713,2261.8458020171233,4109.902744268697,5385.127731316286,2092.569070793057,5600.101628915604),c(647.2907334189233,728.5620960655561,941.8041455953223,1654.7232405167301,190.0426501824101,118.64138712715885),c(85.0898616700932,501.9187236119134,306.94112005788145,910.2097392016925,201.59220350841292,131.18999538099297),c(2180.934192567984,3221.639193055627,2742.266361225984,3260.1854373374276,482.98132090557266,1496.7067299118503),c(1006.8966964294362,1283.7007209014018,700.1365801826612,890.0574940533155,1312.44924159123,2822.296074544144),c(2604.357551831067,1172.6729959342326,2757.0306176338313,1545.0054613755667,5447.189332300241,3409.7990973372866),c(873.184056662147,602.8530190366126,1683.9022966213395,1762.2018813080738,922.914306686953,1567.4352491607333),c(912.6900638661187,1113.0300031832742,1664.4756434531191,1331.1677489677888,1691.4845825627774,1054.0830933220652),c(1131.4925653035014,276.1929356621315,168.62334950015259,99.64165656697494,752.8208849767295,108.3743440103855),c(1791.9519677904152,1886.5537399380144,2216.192593430577,2903.0428705411914,1446.8440439301721,1923.3594105422098),c(590.5641589721945,932.2658559226763,526.8508339221357,830.7203277830945,2132.4675277374304,1367.798299667918),c(594.6160571469609,807.4743633975937,923.1545585538308,2233.5405039451125,1327.1486730970519,936.5824887634368),c(315.0350830880832,209.20926688028564,157.7444237259492,317.957645674392,499.7806711979404,136.89390822364484),c(1848.678542237144,1471.8055441928868,1279.8279107223564,2164.127215100703,602.6766917386929,845.3198832810068),c(257.29553409766277,177.0938092451541,285.96033463620347,592.2520935273005,429.4333918486505,927.4562282151937),c(957.2609437885486,868.9525251562742,3947.495923782374,1241.6022149750024,1236.852165275575,946.8495318802101),c(522.6948645448583,302.80288627409766,533.8444290626951,157.85925366228616,1919.325770903015,360.4872916555981),c(1318.8928558864447,489.07254055786075,1551.801055077441,422.07757894100627,207.89195986805083,295.46268524936676),c(1772.705451460275,1781.9491064978715,5623.627559136426,3563.5886837379917,1270.4508658603106,514.4929384071985),c(715.1600278462596,368.8689705520826,8847.674918934274,897.8944782776844,251.99025438551618,483.6918090568784),c(1902.366193052798,1791.1249515364807,1919.35333302017,2165.2467842756128,3748.355033984553,2370.5461774061164),c(183.34839240817703,1108.4420806639696,1618.6287419761193,531.7953580821696,543.8789657154057,1105.418308905932),c(1050.4546018081744,438.6053928455111,820.5818298256274,1706.2234225625823,1097.2075659702684,710.7075401944228),c(669.5761733801382,666.1663498030148,2220.85499019095,653.8283981473412,2607.0491734968195,2411.61434987321),c(3838.1605460474184,2020.521077501706,2242.6128417393566,4018.133768751383,6034.116633139839,1779.6208069073828),c(816.4574822154182,2282.0326611020632,3241.9198807126113,2714.95524915634,1456.293678469629,1752.242025262654),c(515.6040427390171,848.7656660713343,5336.890158373493,1878.6370754986963,3240.1746876404286,3780.5534321096584),c(377.8395047969615,356.94037200189086,2442.318836308662,836.3181736576437,281.38911739715974,668.498585158799),c(850.898616700932,926.760348899511,926.2628230607461,1679.3537623647462,936.5637787995017,1261.7055207945932),c(797.210965885278,1146.0630453222666,2316.434123778594,1631.2122878436237,629.9756359637904,840.7567530068853),c(1164.9207252453236,1287.3710589168454,2091.862013153967,1770.0388655324425,3462.7660790143013,1132.797090550661),c(739.4714168948576,1169.002657918789,2202.982469276187,1393.8636227627394,1483.5926226947265,888.6696208851611),c(1061.597321788782,1074.4914540211162,3612.5804231622556,2295.1168085651534,392.68481308409605,446.0459842953761),c(507.50024638948446,165.16521069496235,1710.3225449301192,412.00145636681776,1053.109271452803,638.8382383770092),c(706.0432569530353,345.0117734516991,2710.4066500301024,380.6535194693425,25.199025438551615,244.12746966549994),c(899.5213947981282,1189.189517003729,1407.2667555058817,2026.420206586794,1728.2331613273318,1065.490919007369),c(128.64776704883138,500.0835546041916,996.1987744663393,171.29408376120412,246.74045741915126,385.58450816326626),c(887.3657002738291,881.7987082103268,12133.110502743699,2504.4762442732917,4263.885096081588,1671.2464628969974),c(706.0432569530353,1532.3661214477063,2212.3072627969327,2683.6073122588646,520.7798590634001,1465.90560056153),c(1794.99089142149,1803.9711345905332,4886.96887099751,3116.8805829489693,2805.491498825413,2373.9685251117075),c(681.7318679044372,1151.568552345432,930.925219821119,1530.451062101739,878.8160121694876,2029.4521894155346),c(2624.6170427048987,2954.6221024321044,4492.219278619273,4711.147088020568,5811.525241765967,4775.315831868144),c(737.4454678074744,450.53399139570286,194.26653168220346,128.75045511463054,10.49959393272984,55.89834585798831),c(696.926486059811,935.0186094342591,1035.8291469295089,462.38206923776016,71.39723874256292,204.20007976693688),c(1898.314294878032,1731.481958785522,24598.0282416006,3762.8719968719415,3003.933824154007,1471.609513404182),c(53.687650815654045,186.2696542837631,1694.781222395543,375.05567359479335,50.39805087710323,328.5453797367476),c(972.4555619439224,1172.6729959342326,2628.8147067235773,3058.662985853658,3500.5646171721287,3746.329955053747),c(1082.8697872063053,1947.114317192834,2064.664698718458,1912.2241507459912,1352.3476985356035,2184.5986187356657),c(1104.1422526238284,1898.482338488206,1391.7254329713055,3152.7067965460838,1971.8237405666641,2218.822095791577),c(1480.9687828770984,1258.9259392971576,650.4043480720171,733.3178095659392,678.2737680543477,2035.1561022581866),c(601.706878952802,756.0896311813832,1471.7632440243733,2173.083768499982,628.9256765705175,3894.6316889626955),c(735.4195187200913,778.1116592740449,857.8810039086104,1231.526092400814,1170.7047234993772,1201.2440446624835),c(474.0720864476622,633.1333076640224,801.9322427841358,1781.234557281541,1073.0584999249897,724.3969310167872),c(2246.777537907937,2685.76984280086,4592.460808967289,4755.9298550169615,5425.140185041509,1967.8499307148945),c(1268.2441287018655,1227.7280661658867,6476.069100157934,2382.4432042081203,2054.7705326352298,2685.4021663204994),c(832.6650749144835,1024.9418908126274,2098.0785421677974,1107.2539139858227,1827.9793036882652,1399.7402115867685),c(752.6400859628483,870.787694163996,1772.4878350684244,1171.0693569556831,443.0828639611993,2273.5796590810346),c(888.3786748175207,1419.5032274728153,1524.6037406419327,699.7307343186443,686.6734432005316,1637.0229858410862),c(2822.147078724758,4274.108618984082,5209.451313589968,5823.99884788094,1349.1978203557844,2262.171833395731),c(5484.2441795462455,4822.824152292901,6140.376533411087,4183.830006638038,2414.9066045278632,4989.782954751854),c(1508.3190955567713,1375.459171287492,2025.8113923820176,1733.0930827604182,2972.435042355818,2920.4033754377565),c(2211.3234288787316,2359.109759426379,5131.744700917086,12026.412076881403,6347.004532335189,6802.486456146618),c(2742.1220897731228,3415.249523370277,6330.757734459646,5057.093963067706,5351.643027512399,4276.793849420371),c(986.6372055556045,602.8530190366126,3702.720093862798,1828.2564626277538,1000.6113017891538,355.92416138147655),c(874.1970312058386,1218.5522211272778,3416.7597592265943,2929.9125307390273,824.2181237192925,1489.862034500668),c(2847.4714423170476,5564.23243141251,7097.722001540986,10283.242871546796,7167.022818481389,6578.893072714664),c(1239.880841478501,1980.1473593318265,2556.5475569377973,5752.346420686711,678.2737680543477,3240.9632771947913),c(2152.57090534462,1852.603113295161,2323.4277189191534,5590.008890324785,1617.9874250336684,3308.2694487380836),c(1997.5858001598071,1624.1245718337964,1719.647338450865,781.459284087062,431.5333106351964,655.9499769049648),c(1259.1273578086411,2015.9331549824017,1699.4436191559157,1674.875485665107,636.2753923234284,3733.781346799913),c(1262.166281439716,531.2814277354622,491.88285821933914,1184.504187054601,793.769301314376,1164.7390024695114),c(848.8726676135489,1260.7611083048794,874.1993925699155,310.12066145002314,578.5276256934142,1590.250900531341),c(2111.038949053265,3856.607669727371,4425.391591720595,2448.4977855278003,625.7757983906985,2081.9281875679317),c(251.2176868355133,466.13292796133817,247.8840944264916,156.73968448737634,573.2778287270493,240.70512195990884),c(2397.7107449179834,4887.055067563164,2559.6558214447127,1784.5932648062703,592.177097805963,2796.058075467946),c(2730.979369792515,2165.4994291117287,3524.7719508418995,5219.431493429632,3052.2319562445646,5413.013287676623),c(705.0302824093437,504.67147712349606,1701.7748175361023,997.5361348446593,373.7855440051823,700.4404970776494),c(2376.4382795004603,1249.7500942585484,1142.2872062913564,4278.993386505374,1175.9545204657422,2642.0524287163453),c(575.3695408168207,1022.1891373010448,1378.5153088169156,925.8837076504301,117.59545204657421,420.9487677877079),c(267.42527953457864,729.479680569417,1060.6952629848308,498.20828283487475,108.14581750711736,110.65590914744624),c(475.0850609913537,509.2593996428006,409.51384878608485,1224.808677351355,391.63485369082304,546.434850326049),c(83.06391258271003,708.3752369806164,669.0539351135087,349.30558257186726,78.7469544954738,174.53973298514717),c(1884.1326512663495,1948.0319016966948,1674.5775031005937,2046.572451735171,1288.3001755459513,1542.338032653065))
targetgene="Ptprs"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(561.1878972051385,1260.7611083048794,930.1481536943901,286.6097087769167,1208.5032616572046,863.5724043774928),c(1169.9855979637816,1215.799467615695,1152.389065938831,920.285861775881,2052.670613848684,618.3041521434625),c(1612.6554735570046,1347.014051667804,1035.05208080278,662.7849515466198,997.4614236093348,815.6595364992171),c(3324.5824523957845,2841.7592084572134,1645.0489902848988,884.4596481787664,719.2221843919941,1172.724480449224),c(1073.753016313081,1308.475502505646,1028.0584856622206,2002.9092539136875,4725.867229121701,2534.81886727449),c(2090.7794581794333,3599.6840086463185,3865.9039804758486,4155.840777265292,5097.552854340338,6964.477580877931),c(1507.3061210130797,1368.1184952566048,2314.879991525136,4420.059102544013,3370.369652406279,3056.156501092871),c(788.0941949920538,839.5898210327252,620.8758352563223,426.5558556406456,1831.129181868084,1668.9648977599365),c(1299.6463395563046,655.155335756684,367.55227794272895,275.4140170278184,322.33753373480613,473.42476594010503),c(453.81259557383044,793.7105958396802,1350.5409282546784,1503.5814019039028,403.18440701682584,436.9197237471331),c(2280.2056978497594,1903.0702610075107,1787.2520914762717,5707.563653690318,3550.962668049232,4872.282350193226),c(2542.56610466588,2655.4895541734504,5622.073426882968,7561.5702073409975,2112.518299265244,6308.527603972966),c(1566.0586445471915,1398.3987838840146,1099.5485693212715,5826.23798623076,7729.801053275709,6776.248457070419),c(199.5559851072424,690.0235469033983,737.4357542656443,626.9587379495053,188.99269078913713,29.660346781789713),c(635.1350388946242,1027.6946443242102,1077.013651646136,2609.715746714816,1216.9029368033885,628.5711952602359),c(2069.5069927619097,3378.546143215841,2479.618010391645,4808.549606237723,2276.3119646158293,3675.6014358048637),c(2940.6651003366737,3464.7990865787656,4783.619076142578,7292.873605362638,2862.1893060621546,6297.1197782876625))
targetgene="Prdm14"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(398.0989956707932,1002.9198627199659,547.8316193438137,519.4800971581615,887.2156873156715,505.36667785895554),c(71.9211926021026,136.72009107527438,198.15186231584752,1364.7548242150838,377.98538157827426,118.64138712715885),c(1675.459895265883,728.5620960655561,1416.5915490266275,1841.6912927266717,682.4736056274396,501.9443301533644),c(1983.404156548125,3078.496010453326,3311.8558321182045,3138.152397272256,2161.866390749074,3195.3319744535765),c(1750.4200114990604,1068.9859469979508,1399.4960942385937,1730.8539444105986,382.1852191513662,426.6526806303597),c(583.4733371663534,102.76946443242102,105.68099323511868,193.68546725940075,703.4727934928993,205.34086233546725),c(2859.627136841347,2219.636914839522,2985.488058892103,8390.051396774272,6836.285609600399,4795.8499181016905),c(646.2777588752317,1103.854158144665,1645.8260564116276,611.2847695007677,726.5719001449049,1406.5849069979506),c(1270.2700777892485,2164.581844607868,1325.6748121993564,1270.711013522658,1804.8801970362595,1805.8588059835815),c(1348.2691176535006,1245.162171739244,1524.6037406419327,5728.835468013604,3137.278667099676,2877.0536378336024),c(1110.220099885978,406.48993521037954,1296.9233655103903,1362.5156858652642,233.09098530660245,146.02016877188782),c(2365.2955595198528,973.557158596417,1135.293611150797,2327.5843146375382,1976.023578139756,3264.9197111339295),c(801.2628640600443,534.9517657509058,982.2115841852207,4411.1025491447335,6038.316470712931,3626.547785358058),c(1279.3868486824729,1405.7394599149018,1348.9867960012207,2847.0644117957,4220.836760957396,2286.1282673348687),c(373.78760662219514,568.9023923937592,1223.8791495978817,1382.6679310136412,606.8765293117848,936.5824887634368),c(1978.339283829667,1649.8169379419016,2149.364906531899,2130.540139853408,1659.9858007645878,1398.599429018238),c(417.34551200093335,606.5233570520562,424.27810519393233,1065.829854514159,468.28188939975087,404.97781182828265),c(2415.944286704432,2854.605391511266,3979.3556349782557,4042.7642905993994,2998.6840271876426,6900.59375704023),c(740.4843914385492,1048.799087913011,714.9008365905087,1168.8302186058634,2996.5841084010963,1733.989504166168),c(773.9125513803715,610.1936950674998,1029.6126179156784,356.0229976213262,4991.506955619766,983.3545740731821),c(1897.3013203343403,1126.7937707411877,1285.267373609458,2009.6266689631464,403.18440701682584,2313.5070489795976),c(303.8923631074757,668.0015188107366,474.0103373045764,669.5023665960789,248.84037620569723,139.17547336070558),c(4016.444065737138,2745.4128355518187,4109.902744268697,3985.666262678998,3662.258363736168,2923.8257231433477),c(537.8894827002321,266.09950611966156,188.82706879510175,29.108798547655603,220.49147258732665,98.10730089361213),c(822.5353294775676,668.9191033145976,494.2140565995256,526.1975122076205,3100.530088335122,694.7365842349975),c(404.17684293294275,523.0231672007142,802.7093089108647,686.2959042197264,2391.8074978758577,1704.3291573843783),c(1787.9000696156488,1117.6179257025785,442.9276922354239,1490.146571804985,2195.4650913338096,2334.0411352131446),c(1298.633365012613,2422.4230901927813,1931.786391047831,1370.352670089633,1965.5239842070262,2022.6074940043525),c(2010.7544692277977,1553.470565036507,2140.040113011153,2879.531917868085,1308.2494040181382,2060.2533187658546),c(840.7688712640162,1652.5696914534844,1427.470474800831,1739.8104978098772,432.5832700284694,1137.3602208247826),c(2156.6228035193863,2335.2525623259953,2942.749421922018,3374.3814931782304,1151.8054544204635,3311.691796443675),c(5091.21005659391,4481.482716856645,5538.150285196256,5247.420722802377,4590.422467389486,3099.5062386970253),c(1397.9048702943885,1603.0201282449957,1724.309735211238,3225.4787929152226,3201.3261900893285,1496.7067299118503),c(954.2220201574738,1198.365362042338,1673.8004369738649,2703.7595574072416,2916.7871945123497,1271.9725639113667),c(1255.0754596338747,1338.755791133056,1288.3756381163732,2618.6723001140945,1930.8753242290177,1030.1266593829273),c(2953.833769404664,1813.1469796291424,1016.4024937612885,2507.8349517980214,1973.92365935321,3271.764406545112),c(629.0571916324748,616.6167865945262,883.5241860906613,345.9468750471377,280.3391580038867,550.9979806001704),c(1352.321015828267,868.0349406524133,1215.3314222038648,635.915291348784,2070.5199235343243,1200.1032620939532),c(1044.376754546025,1410.3273824342064,1680.7940321144242,2169.7250609752523,2487.3538026636993,3561.5231789518266),c(1079.8308635752305,1955.372577727582,1317.1270848053393,2005.148392263507,795.8692201009219,1793.3101977297474),c(602.7198534964936,706.5400679728945,651.181414198746,1394.9831919376493,1521.3911608525539,846.4606658495372),c(894.4565220796702,1256.1731857855748,1711.876677183577,815.0463593343569,1111.90699747609,1295.9289978505044),c(1793.9779168777984,1838.8393457372474,2116.728129209289,6136.358647680783,713.9723874256291,3724.65508625167),c(533.8375845254657,1564.481579082838,2603.171524541526,3460.5883196462873,705.5727122794452,1753.3828078311842),c(1006.8966964294362,1140.5575382991012,1247.968199526475,256.38134105435125,199.49228472186698,257.81686048786446),c(1300.6593140999962,1263.513861816462,1397.1648958584071,2112.627033054851,298.18846768952744,744.931017250334),c(2691.4733625885433,2100.3509293376046,1689.3417595084413,2193.2360136483585,767.5203164825514,496.24041731071253),c(1378.6583539642484,555.1386248358457,569.5894708922206,3541.197300239795,715.0223468189022,1444.230731759453),c(857.9894385067731,572.5727304092028,449.9212873759832,432.1537015151947,808.4687328201977,433.497376041542),c(1180.1153434006974,893.7273067605186,1240.9746043859157,3270.261559911616,1489.8923790543643,1330.1524749064156))
targetgene="Ercc2"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(415.31956291355016,213.79718939959017,245.55289604630516,236.2290959059743,980.662073316967,606.8963264581588),c(250.2047122918217,167.00037970268414,158.52148985267803,259.74004857908074,1703.0341358887802,476.8471136456962),c(165.1148506217285,504.67147712349606,247.8840944264916,100.76122574188477,643.6251080763392,171.11738527955603),c(605.7587771275684,203.70375985712025,160.07562210613565,192.56589808449093,1132.9061853415499,743.7902346818036),c(2673.239820802095,1806.723888102116,2202.982469276187,5194.800971581615,3642.3091352639817,3011.6659809201865),c(2437.2167521219553,1640.6410929032927,2192.103543501984,5673.976578443023,1552.8899426507435,3652.7857844342566),c(1992.5209274413492,2271.0216470557325,3328.9512869062382,8134.789624894831,3519.4638862510424,2265.594181101322),c(735.4195187200913,1260.7611083048794,1436.0182021948478,1176.6672028302323,843.1173927982062,2408.1920021676187),c(962.3258165070065,742.3258636234697,446.0359567423391,528.4366505574402,3390.3188808784653,975.3690960934695))
targetgene="Msi2"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(463.9423410107463,615.6992020906653,733.5504236320003,2182.0403218992606,4826.663330875907,1120.248482296827),c(213.7376287189246,219.30269642275556,342.6861618874069,288.84884712673636,164.8436247438585,288.61798983818454),c(3900.964967756297,2152.653246057676,1503.6229552202547,2288.399393515694,5889.222236868168,1533.211772104822),c(2202.2066579855077,1191.9422705153117,879.6388554570173,882.2205098289468,1763.9317806986132,1000.4663126011377),c(384.9303266028026,986.4033416504697,895.9572441183224,4069.6339507972352,2609.1490922833655,2193.7248792839086),c(1805.120636858406,1371.7888332720484,1362.1969201556105,1632.3318570185334,1148.6555762406445,3685.8684789216372),c(1394.8659466633137,870.787694163996,954.2372036229833,1369.233100914723,380.0853003648202,587.5030227931425),c(2206.2585561602737,1342.4261291484995,902.9508392588816,261.97918692890045,280.3391580038867,1122.5300474338876),c(2944.71699851144,2162.746675600146,1835.4301913334582,5592.248028674605,1958.1742684541152,4225.458633836504),c(844.8207694387826,1002.9198627199659,743.6522832794748,1792.4302490306393,1531.8907547852837,2402.488089324967),c(2194.102861635975,2345.3459918684653,4034.5273299760015,3273.6202674363453,1436.344449997442,3920.8696880388943),c(875.2100057495302,1610.3608042758829,2050.67750843734,7039.850971833017,3459.6162008344822,4052.0596834198873),c(2674.2527953457866,690.0235469033983,275.0814088620001,167.93537623647464,545.9788845019517,334.2492925793995),c(457.8644937485968,331.2480058937856,163.9609527397797,201.52245148376954,1978.1234969263019,669.6393677273293),c(1152.7650307210247,1131.381693260492,1020.2878243949325,847.513865406742,1893.0767860711903,1274.2541290484273),c(2358.2047377140116,3538.205846887638,2485.057473278747,1155.3953885069454,2683.6962092057474,2826.859204818266),c(2584.0980609572352,1657.157613972789,1819.888868798882,2238.018780644752,2292.0613555149243,4107.9580292778755),c(3395.4906704541954,2360.02734393024,2430.6628444077296,3378.8597698778694,1736.6328364735157,1793.3101977297474),c(1330.035575867052,1206.623622577086,592.9014546940849,884.4596481787664,2887.388331500706,4884.83095844706),c(438.61797741845663,607.4409415559171,271.19607822835604,110.83734831607326,193.19252836222907,112.93747428450699),c(1273.3090014203233,556.0562093397066,263.42541696106787,1187.8628945793305,406.3342851966448,519.05606868132),c(218.80250143738255,293.6270412354886,636.4171577908985,634.7957221738741,1733.4829582936966,894.373533727813),c(2940.6651003366737,2048.966197121394,1976.0791602713734,2566.052548893332,4388.830263881074,5016.020953828053),c(2163.7136253252274,1141.475122802962,926.2628230607461,1319.9720572186907,1550.7900238641973,3831.888647693525),c(1459.696317459575,1471.8055441928868,1330.3372089597292,2036.4963291609824,739.1714128641808,2729.892686493184),c(1305.7241868184542,1204.7884535693643,1368.413449169441,2563.813410543513,1225.3026119495723,1089.4473529465067),c(3245.5704379878407,3574.9092270420742,5047.044493103645,6893.1874099198285,3680.107673421809,5489.445719768158),c(1262.166281439716,658.8256737721276,898.2884424985087,888.9379248784057,383.23517854463915,719.8338007426657),c(914.716012953502,910.2438278300148,534.6214951894239,465.74077676248965,342.2867622069928,500.803547584834),c(1763.588680567051,1323.1568545674206,1269.7260510748818,2660.0963595857584,3104.7299259082138,2331.7595700760835),c(480.14993370981165,641.3915681987704,389.31012949113574,1175.5476336553224,1530.8407953920107,274.92859901582005),c(536.8765081565405,385.3854916215788,600.672115961373,525.0779430327107,2116.718136838336,1257.1423905204717),c(1102.1163035364452,732.2324340809997,659.729141592763,938.1989685744383,976.4622357438751,1152.1903942156773),c(1453.6184701974257,1123.123432725744,1153.9431981922885,1431.9289747096736,668.8241335148908,1021.0003988346843),c(3172.6362708420465,2209.543485297052,4039.966792863103,4386.472027296717,1919.325770903015,1284.5211721652006),c(1432.3460047799024,2438.0220267584164,4566.817626785239,6275.185225369602,2271.0621676494643,4818.665569472299),c(5576.42486302218,3263.8480802332283,4646.855437838307,5901.249120949718,6172.711273051873,2011.1996683190487),c(2415.944286704432,2175.5928586541986,2032.804987522577,2922.0755465146585,1187.504073791745,1362.0943868252662),c(1097.0514308179875,601.9354345327516,628.6464965236104,3006.0432346328957,782.2197479883731,1613.0665519019483),c(640.1999116130822,677.1773638493456,2413.567389619696,1080.3842537879868,636.2753923234284,1391.7547336070559),c(2338.9582213838717,1297.4644884593154,3426.0845527473402,1623.3753036192547,703.4727934928993,2357.9975691522823),c(1831.457974994387,2657.324723181172,1817.5576704186956,4464.841869540405,1404.8456681992527,1162.4574373324508),c(4327.427250650455,3204.20508748227,5978.746779051494,6402.816111309323,3036.48256534547,3102.9285864026165),c(3332.6862487453172,2205.8731472816085,4576.142420305984,3654.273786905688,1283.0503785795865,1360.9536042567358),c(906.6122166039693,765.2654762199923,338.023765127034,633.6761529989643,921.86434729368,1013.0149208549718),c(1323.9577286049027,839.5898210327252,582.7995950466103,1622.2557344443449,331.78716827426297,1154.4719593527382),c(2817.0822060063,4206.207365698375,4120.781670042899,1634.5709953683531,3949.947237492966,1901.6845417401328),c(1200.3748342745291,660.6608427798494,508.20124688064425,500.4474211846944,272.98944225097586,633.1343255343573),c(1250.010586915417,1623.2069873299356,2180.4475516010516,1125.16702078438,2005.4224411513994,1228.6228263072123),c(540.9284063313069,456.95708292272917,212.13905259696617,288.84884712673636,229.9411071267835,308.0112935032009),c(370.7486829911204,1188.271932499868,1538.5909309230512,2347.7365597859152,2632.248198935371,2775.523989234399),c(1826.393102275929,2220.5544993433828,1826.1053978127125,1703.9842842127625,1592.7883995951167,1508.1145555971539),c(1557.954848197659,2705.039117381939,3858.9103853352894,4951.854460626182,3017.5832962665563,4004.1468155416114),c(1732.1864697126116,1152.486136849293,882.7471199639325,644.8718447480626,1655.7859631914957,1333.5748226120068),c(1257.101408721258,1710.3775151967213,1597.6479565544412,1222.5695390015353,2677.3964528461092,1613.0665519019483),c(1192.2710379249966,1269.0193688396273,1928.6781265409159,1102.7756372861834,1180.154358038834,781.4360594433059),c(3298.2451142598034,3107.8587145768747,5207.120115209781,5370.573332042459,5046.1048440699615,4566.552621827085),c(1522.5007391684535,1291.041396932289,2554.216358557611,2694.803004007963,1185.404155005199,3351.6191863422378),c(1976.3133347422838,1923.2571200924506,2986.2651250188314,2726.1509409054383,1631.6368971462173,1645.0084638207989),c(5758.760280886665,6869.037595902712,14470.52541194397,10023.502822967715,5412.540672322233,6872.074192826971),c(1715.9788770135463,1692.0258251195032,2060.0023019580854,3875.9484835378344,1923.5256084761068,2468.6534782997287))
targetgene="Egfr"
collabel=c("input_rep1","input_rep2","input_rep3","d15_rep1","d15_rep2","d15_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("CBE_d15_input_summary.Rnw");
library(tools);

texi2dvi("CBE_d15_input_summary.tex",pdf=TRUE);

