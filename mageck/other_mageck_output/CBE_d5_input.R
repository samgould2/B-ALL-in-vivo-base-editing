pdf(file='CBE_d5_input.pdf',width=4.5,height=4.5);
gstable=read.table('CBE_d5_input.gene_summary.txt',header=T)
# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=3
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("safe_target","non_target","Epha7","Atrx","Ptprd","Crebbp","Epha3","Kdm6a","Phox2b","Kmt2a")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='d5_rep1,d5_rep2,d5_rep3_vs_input_rep1,input_rep2,input_rep3 neg.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(851.9102286181143,1069.1339165729948,553.6054886124991,446.06297040981633,690.9190334470067,737.6597113882768),c(1054.9818528817345,579.0385728128783,196.78645999088835,381.73710470059933,152.2363972001879,756.1452172822551),c(932.1482850344715,935.7190729938519,692.1982872831247,278.3939106103818,6783.720776338043,1051.0330494004804),c(1388.8117913053445,1541.0775809345882,1326.2029132459868,1231.6821499732043,2151.384690103754,1691.863920391728),c(252.60128871816178,931.1811531442212,454.06369951204977,225.66779117659738,122.12370324850238,712.1321080108783),c(618.1302123926782,913.0294737456984,967.8524724843692,567.3330451075205,1060.6359980760344,1183.0723772146112),c(1339.2821268508028,808.6573172041922,592.6564981826754,179.2688060748671,259.3037534728475,1115.2921889366905),c(591.3841935872258,459.2374887826276,137.06138653061873,25.30853732821653,210.78885766179863,667.2387365540737),c(670.6316567144922,1404.9399854456672,1694.5075329176493,2781.830061326467,1350.0524455005675,1209.4802427774373),c(2095.1048064271067,1891.404993326079,2794.061449442613,3514.7231214560707,2601.4021719372768,1578.3100984715757),c(1457.1627282526117,802.3042294147091,356.0533225516073,454.4991495192218,2646.571212864805,2660.15232436202),c(633.9797050181315,338.5288207824508,147.78127151066712,35.85376121497342,2838.9578686672403,919.8739837717771),c(2013.8761567216586,869.4654431892436,1163.1075203352505,491.40743312287094,2773.7136984385884,1344.1603571478504),c(822.1924299453893,716.0837522717256,316.23660691142754,318.465761380058,918.4371655264083,871.4595635732626),c(1148.0976220562727,1678.1227603934358,1369.8481592361838,1893.9222100615368,1030.523304124349,1572.1482631735828),c(1995.0548842289327,2392.391344725309,4327.770707659537,2584.634374644113,8095.295890678124,1935.696545755156),c(944.0354045035615,1052.7974051143242,711.3409390332112,879.4716721555244,450.0174818335225,1610.8797993323944),c(788.5122581163012,1211.624599851399,542.8856036324507,460.82628385127595,498.5323776445714,1083.6027502612992),c(277.36612094543256,490.0953437601164,325.42507975146907,249.9218061161382,393.13794881367204,1087.1237990030095),c(732.0484406381238,952.0555844525225,585.7651435526443,484.0257764021411,311.164504167417,470.06000701830527),c(165.4290792781687,461.96024069240605,143.1870350906464,16.87235821881102,86.99222697153594,714.7728945671608),c(139.67365376180712,491.9105116999687,168.45533540076045,79.08917915067666,40.15025860224736,346.82330105844994),c(469.5412190290537,551.8110537150941,206.74063890093328,24.25401493954084,2611.4397365878385,156.68666900610177),c(605.2524996344974,527.3062865270882,254.98012131115104,32.69019404894635,153.90932464194822,521.1152137731025),c(169.39145243453203,55.362622165494635,28.331124590127892,29.526626882919285,31.785621393445826,285.2049480785223),c(1689.952151188957,2641.0693524850717,2645.5144718619426,4047.256927737293,4567.091916005637,2124.072653436649),c(1791.9832599653125,1580.1036916414125,1408.1334627363567,1127.2844334943113,503.5511599698523,1988.5122768808083),c(1164.9377079708167,1273.3403098063766,1098.78821045496,1456.295418761126,851.5200678559961,1202.438145294017),c(969.7908300199231,821.3634927831581,379.79021072171446,351.15595542900434,207.44300277827801,1097.6869452281398),c(1706.792237103501,1787.0328367845727,1075.8170283548566,728.6749705749008,4249.235702071179,1129.3763839035312),c(372.4630766981523,512.7849430082699,367.53891360165915,25.30853732821653,92.01100929681687,750.8636441696899),c(697.3776755199447,635.308778948299,509.19453655229864,740.2747168503334,1187.7784836498176,545.7625549650735),c(376.4254498545156,490.0953437601164,229.71182100103698,47.45350749040599,65.24417022865195,233.26947913829756),c(769.6909856235753,1243.390038798814,666.1642809030072,838.3452989971726,1687.9837887361493,1091.525109930147),c(1139.1822824544552,1067.3187486331424,1055.1429644647633,793.0008362841179,1289.8270575971965,2007.878044960214),c(3594.863046110624,1809.7224360327261,1609.5141591472657,757.1470750691445,465.07382880936524,1485.882569001684),c(558.6946150472285,266.8296871582856,92.65043447041825,10.545223886756887,85.31929952977563,331.85884390618185),c(363.5477370963348,580.8537407527306,228.94611493103352,34.799238826297724,102.0485739473787,338.9009413896021),c(108.96526179999137,274.09035891769474,270.2942427112202,24.25401493954084,76.95466232097411,256.15629595941357),c(757.8038661544854,1402.2172335358887,951.7726450142966,1085.1035379472837,4055.1761188269834,1063.356719996466),c(174.34441887998616,722.4368400612086,429.56110527193914,112.83389558829869,306.1457218421361,983.2528611225599),c(12.877712758180797,198.760889413825,85.75907984038713,5.272611943378443,75.2817348792138,435.7297817866313),c(127.78653429271714,45.379198496307076,65.08501595029381,29.526626882919285,58.55246046161073,418.12453807808055),c(653.7915707999482,557.2565575346509,855.293680193861,1710.435314431967,399.82965858071327,1239.4091570819735),c(1879.1554694053057,819.5483248433059,705.980996543187,651.6948362015756,316.18328649269796,688.3650290043347),c(30.708391961815746,40.84127864667637,56.662249180255785,72.76204481862253,78.62758976273442,685.7242424480521),c(267.4601880545242,33.58060688726724,39.816715640179744,8.43617910940551,20.07512930112368,46.65389582765951),c(637.9420781744949,207.83672911308642,153.90692007069478,339.5562091535718,726.050509723973,978.8515501954222),c(459.6352861381454,342.15915666215534,149.31268365067405,91.74344781478491,48.514895811048895,469.17974483287776),c(490.3436780999611,216.0049848424217,88.05619805039751,39.01732838100048,210.78885766179863,732.3781382757116),c(570.5817345163184,342.15915666215534,191.42651750086415,288.9391344971387,158.92810696722913,469.17974483287776),c(550.7698687345018,631.6784430685946,339.97349508153474,79.08917915067666,192.38665580243526,1332.7169487372926),c(1585.9398558344196,1481.177038919463,1388.225104916267,1352.9522246709087,1977.4002361606824,1085.3632746321543),c(992.5744756690123,1862.3623062884424,879.0305683639682,563.1149555528177,339.60427067734224,664.5979499977911),c(29.717798672724918,108.00249242121085,47.47377634021431,2.1090447773513774,18.402201859363373,151.40509589353653),c(1923.732167414393,1766.1584054762714,1542.1320249869616,1637.6732696133445,1736.4986845471983,1524.6141051604957),c(644.8762311981307,1586.4567794308955,1444.121648026519,1225.3550156411502,655.7875571700401,1046.6317384733427),c(2.9717798672724918,9.983423669187557,135.5299743906118,11.599746275432576,43.49611348576797,327.4575329790441),c(2185.2487957343724,1189.8425845731715,1442.5902358865121,1418.3326127688013,4006.6612230159344,2302.765877078439),c(180.28797861453117,621.695019399407,709.0438208232008,768.746821344577,1087.4028371441993,1642.5692380077858),c(1545.3255309816957,1983.9785582585455,1670.0049386775388,1092.4851946680135,1965.6897440683604,1776.3690901927716),c(702.3306419653989,404.78245058705915,338.4420829415278,112.83389558829869,255.9578985893269,769.3491500636682),c(413.07740155087635,455.6071529029231,194.48934178087796,100.17962692419043,135.50712278258484,1159.3052982080676),c(547.7980888672292,275.90552685754704,288.67118839130313,36.9082836036491,108.74028371441993,606.5006457595737),c(883.6092138690209,368.47909179001346,186.06657501083995,153.96026874665054,664.1521943788417,446.2929280117618),c(418.0303679963305,551.8110537150941,179.9409264508123,258.35798522554376,978.6625534297793,337.14041701874703),c(1311.5455147562598,1550.1534206338497,1839.2259801483028,587.3689704923586,558.7577655479424,1661.9350060871916),c(533.9297828199577,161.5499466468532,133.9985622506049,115.99746275432575,98.70271906385808,665.4782121832187),c(887.5715870253841,1429.444752633673,1617.9369259173038,405.99111964014014,1318.2668241071217,455.9758120514647),c(206.04340413089275,136.13759548892122,149.31268365067405,150.79670158062348,97.02979162209779,749.9833819842623),c(992.5744756690123,1410.385489265224,606.4392074427376,114.94294036565007,921.7830204099289,1205.959194035727),c(564.6381747817734,84.40530920313117,45.94236420020739,250.97632850481392,98.70271906385808,590.655926421878),c(908.3740460962916,446.5313132036616,306.28242800138264,238.32205984070563,324.5479237014995,882.0227097983931),c(799.4087842963003,791.4132217755954,320.0651372614449,149.7421791919478,267.66839068164904,299.2891430453629),c(984.6497293562855,634.4011949783729,288.67118839130313,243.59467178408408,439.97991718296066,1374.9695336378143),c(664.6880969799473,688.8562331739414,374.43026823169026,119.16102992035282,125.469558132023,727.9768273485739),c(1564.1468034744214,1398.5868976561842,1159.2789899852332,504.0617017869792,634.0395004271562,1786.0519742324745),c(1524.5230719107883,1139.0178822573077,663.8671626929969,658.0219705336298,436.63406229944,1661.0547439017641),c(949.9789642381065,1313.2740044831269,841.5109709337988,269.9577315009763,289.41644742453303,463.8981717203125),c(912.336419252655,472.85124833151974,283.31124590127894,167.6690597994345,2136.3283431279115,700.6886996003202),c(554.7322418908651,488.28017582026416,208.2720510409402,155.01479113532625,100.37564650561839,402.2798187403849),c(1220.4109321599033,204.20639323338185,203.67781462091946,112.83389558829869,207.44300277827801,110.91303536386978),c(2057.462261441655,2380.5927531162693,1848.4144529883442,2696.413747843736,608.9455888007516,1940.0978566822937),c(832.0983628362976,574.5006529632476,782.5516035435327,784.5646571747124,1590.9539971140516,947.1621115200309),c(671.6222500035831,93.48114890239258,33.69106708015209,57.998731377162876,108.74028371441993,588.0151398655954),c(99.05932890908305,738.7733515198793,537.5256611424265,777.1830004539826,224.1722771958811,301.04966741621797),c(533.9297828199577,642.5694507077083,284.84265804128586,49.56255226775737,234.2098418464429,1135.538219201524),c(951.9601508162882,987.451359279642,867.5449773139163,1851.7413145145094,2869.070562618926,1286.9433150950606),c(487.37189823268864,621.695019399407,326.1907858214725,11.599746275432576,311.164504167417,577.4519936404649),c(1367.018738945346,1287.8616533251948,878.2648622939647,763.4742094011987,1032.1962315661092,1626.7245186700902),c(1093.614991156277,706.1003286025381,454.06369951204977,405.99111964014014,506.8970148533729,1046.6317384733427),c(2091.1424332707434,1374.0821304681783,1094.959680104943,1187.3922096488254,578.8328948490661,1052.7935737713353),c(2767.7176497197806,1859.6395543786641,1046.7201976947251,970.1605975816336,1234.6204520191063,2207.6975610522654),c(2025.7632761907485,803.2118133846353,435.68675383196677,49.56255226775737,513.5887246204142,1094.1658964864298),c(843.9854823053877,698.839656843129,671.5242233930314,1321.316553010638,455.0362641588034,883.7832341692481),c(1969.299458712571,2105.5948102286484,2472.4649000411614,1311.8258515125567,2263.4708287016947,2565.0840083358457),c(5648.3629343959155,4406.3201739914175,3531.4363948559417,1890.7586428955099,6581.2965558850465,1945.3794297948589),c(723.1331010363064,562.7020613542078,221.28905423099894,89.63440303743354,229.191059521162,1941.8583810531488),c(1042.1041401235536,706.1003286025381,310.1109583513999,364.8647464817883,177.3303088265925,912.8318862883569),c(2693.4231530379684,1230.683863219848,993.1207727944832,158.1783583013533,736.0880743745349,1573.0285253590105),c(1114.4174502271844,935.7190729938519,1373.676689586201,432.35417935703236,1087.4028371441993,521.99547595853),c(676.5752164490373,667.074217895714,653.1472777129485,1224.3004932524746,473.43846601816676,1315.9919672141693),c(1617.6388410853262,386.6307711885363,222.0547603010024,250.97632850481392,202.4242204529971,1213.0012915191473),c(2319.969483050725,1867.8078101079993,1442.5902358865121,605.2958510998453,321.2020688179789,1036.068592248212),c(197.1280645290753,262.2917673086549,118.68444085053576,27.417582105567906,26.766839068164906,98.58936476788425),c(2206.0512548052798,1024.6623020466138,534.4628368624127,314.2476718253552,237.55569672996353,1361.7656008564013),c(827.1453963908435,554.5338056248725,392.8072139117732,39.01732838100048,135.50712278258484,962.126568672299),c(3266.9766674215593,2292.5571080334335,2671.54847824206,1563.8567024060465,2400.65087892604,2044.8490567481708),c(188.2127249272578,54.45503819556849,113.32449836051157,9.490701498081199,145.54468743314666,264.0786556282614),c(301.14035988361246,1184.3970807536148,481.6291180321742,230.94040311997583,630.6936455436356,971.809452712002),c(877.6656541344759,295.87237419592213,98.01037696044244,26.363059716892216,38.477331160487054,253.51550940313095),c(278.3567142345234,611.7115957302194,207.50634497093674,61.16229854318995,103.72150138913901,898.7476913215163),c(530.9580029526852,429.28721777506496,176.11239610079502,44.289940324378925,90.33808185505656,367.06933132328334),c(156.51373967635124,364.8487559103089,134.76426832060835,20.035925384838084,95.35686418033748,951.5634224471686),c(977.7155763326498,1345.947027400468,720.5294118732527,531.4792838925471,704.3024529810891,879.3819232421105),c(524.0238499290493,270.4600230379902,150.84409579068094,85.41631348273079,71.93587999569318,539.6007196670807),c(705.3024218326714,598.0978361813272,205.97493283092982,78.03465676200096,41.82318604400766,249.11419847599325),c(1864.296570068943,896.6929622870279,1065.0971433748082,1308.6622843465298,1109.1508938870834,1850.311113768685),c(304.112139750885,795.0435576553,478.5662937521604,263.6305971689222,7247.121677705648,214.78397324431927),c(129.7677208708988,569.0551491436908,516.8515972523332,706.5300004127114,391.46502137191175,1099.447469598995),c(2401.1981327561734,2936.941726680994,2938.779896673266,2929.4631957410634,3728.9552676837234,1122.3342864201109),c(157.50433296544205,473.75883230144586,359.11614683162117,160.28740307870467,105.39442883089932,803.6793752953422),c(909.3646393853825,932.0887371141474,486.9890605221984,336.3926419875447,306.1457218421361,1025.5054460230817),c(1953.449966087118,1936.784191822386,1598.0285680972138,1634.5097024473175,2107.8885766179865,996.456793903973),c(1053.9912595926437,739.6809354898054,292.4997187413204,97.01605975816337,242.57447905524447,678.6821449646318),c(1258.0534771453547,1327.795348001945,491.58329694221914,49.56255226775737,232.53691440468262,1081.842225890444),c(444.7763868017829,175.1637061957453,156.20403828070513,44.289940324378925,205.77007533651772,367.06933132328334),c(17.83067920363495,141.58309930847807,52.06801276023505,30.581149271594974,41.82318604400766,257.91682033026865),c(1301.6395818653514,707.9154965423904,349.92767399157964,107.56128364492025,582.1787497325867,1095.9264208572847),c(571.5723278054093,402.0596986772807,168.45533540076045,5.272611943378443,40.15025860224736,456.8560742368922),c(144.62662020726125,395.7066108877977,340.73920115153817,304.756970327274,2203.2454407983237,809.841210593335),c(2234.778460188914,1613.6842985286796,957.1325875043208,636.931522760116,1861.9682426792212,2646.9483915806068),c(2434.8783045852615,2313.4315393417346,2731.2735517023298,1786.3609264166166,921.7830204099289,1814.2203641661558),c(1304.611361732624,1725.317126829595,702.1524661931697,281.55747777640886,767.8736957679807,1845.0295406561197),c(337.7923115799732,334.89848490274625,306.28242800138264,583.1508809376559,265.99546323988875,845.931960195864),c(778.6063252253928,726.0671759409132,333.0821404515036,167.6690597994345,180.67616371011312,1266.697284830227),c(735.0202205053963,549.0883018053156,483.1605301721811,265.73964194627354,1646.1606026921418,791.3557046993567),c(2947.015035045221,2578.4460585601682,3071.2470467838643,2368.457284965597,5207.823126199834,3129.3320691948975),c(365.5289236745165,147.93618709796107,61.25648560027653,23.199492550865152,123.79663069026269,476.221842316298),c(220.90230346725522,100.74182066180171,91.88472840041479,110.72485081094732,354.660617653185,1090.6448477447195),c(624.0737721272233,104.37215654150627,114.85591050051849,164.50549263340744,235.88276928820324,191.01689423777574),c(2375.4427072398116,1787.0328367845727,1670.0049386775388,995.4691349098501,1627.7584008327783,1857.3532112521052),c(705.3024218326714,1430.352336603599,1064.3314373048047,992.3055677438231,369.71696462902776,691.8860777460449),c(493.3154579672336,601.7281720610318,408.8870413818458,235.15849267467857,142.19883254962608,475.3415801308705),c(461.61647271632705,229.6187443913138,169.2210414707639,131.8152985844611,2678.3568342582507,169.0103396020873),c(927.1953185890173,627.1405232189638,459.42364200207396,658.0219705336298,739.4339292580555,621.4651029118418),c(158.49492625453288,201.48364132360342,143.1870350906464,26.363059716892216,85.31929952977563,389.9561481443993),c(544.8263089999568,646.1997865874127,282.5455398312755,10.545223886756887,78.62758976273442,353.86539854187026),c(434.87045391087463,137.04517945884737,71.21066451032146,14.763313441459642,113.75906603970085,1445.3905084720175),c(44.57669800908737,197.85330544389885,6955.673939911399,497.73456745492507,92.01100929681687,346.82330105844994),c(2089.1612466925617,1978.5330544389885,15310.292869719115,2691.1411359003578,4762.824426691593,1278.1406932407851),c(1501.739426261699,517.3228628579006,3970.185972967922,675.9488511411165,809.6968818119884,1043.99095191706),c(1445.2756087835219,689.7638171438675,2790.2329190925957,424.97252263630253,199.0783655694765,1057.194884698473),c(1135.2199092980918,984.7286073698635,3156.240420554248,494.571000288898,254.2849711475666,1540.4588244981915),c(36.65195169636073,195.13055353412042,3243.530912534642,258.35798522554376,58.55246046161073,35.21048741710152),c(1004.4615951381022,1859.6395543786641,9170.095894361397,782.455612397361,4098.6722323127515,1737.63755403396),c(211.98696386543773,43.564030556454796,2118.7086956995645,181.37785085221844,80.30051720449472,130.27880344327562),c(795.4464111399369,240.5097520304275,284.84265804128586,224.6132687879217,220.82642231236048,591.5361886073056),c(3296.694466094284,2680.0954631918958,2318.5579799704665,4311.942047294891,2260.124973818174,2022.8425021124822),c(162.4572994108962,124.33900387988139,85.75907984038713,52.72611943378443,117.10492092322146,597.6980239052983),c(1116.398636805366,1036.4608936556535,379.79021072171446,140.2514776938666,272.68717300693,1504.3680748956624),c(1268.950003325354,1070.949084512847,568.1539039425647,1002.8507916305799,327.8937785850201,777.271509732516),c(1006.4427817162839,929.3659852043689,650.8501595029381,555.7332988320879,1306.5563320147994,441.01135489919653),c(736.0108137944871,431.1023857149172,176.11239610079502,111.77937319962301,145.54468743314666,574.8112070841823),c(337.7923115799732,435.64030556454793,219.75764209099205,278.3939106103818,923.4559478516893,1268.4578092010822),c(830.117176258116,771.4463744372204,366.0075014616522,233.0494478973272,153.90932464194822,737.6597113882768),c(2243.693799790731,1188.9350006032455,693.7296994231317,868.9264482687674,252.6120437058063,554.565176819349),c(366.5195169636073,563.6096453241339,418.84122029189075,240.43110461805702,853.1929952977564,534.3191465545156),c(841.0137024381152,1022.8471341067615,1075.8170283548566,604.2413287111697,1080.7111273771582,1244.6907301945387),c(574.5441076726818,630.7708590986683,267.9971245012098,94.90701498081198,56.87953301985043,378.51273973384133),c(990.5932890908306,679.7803934746801,416.5441020818804,241.48562700673273,120.45077580674207,503.50997006455174),c(701.340048676308,1405.8475694155932,985.4637120944486,1105.1394633321217,700.9565980975684,1408.4194966840607),c(2404.1699126234457,1164.4302334152396,1546.7262614069823,1453.131851595099,712.6670901898906,823.045143374748),c(238.73298267089015,14.521343518818265,3.828530350017283,0.0,1.6729274417603066,14.964457152268146),c(171.37263901271368,318.5619734440757,117.91873478053232,13.708791052783953,76.95466232097411,731.4978760902841),c(673.6034365817648,474.66641627137204,222.0547603010024,56.94420898848719,162.27396185074974,1037.8291166190672),c(2778.6141758997796,2264.4220049657233,2878.2891171429933,2129.0807027362157,960.260351570416,2288.6816821115985),c(1434.3790826035226,981.098271490159,1181.4844660153335,1010.2324483513098,722.7046548404525,1411.0602832403433),c(503.22139085814194,155.19685885737022,148.54697758067059,65.3803880978927,66.91709767041226,383.79431284640657),c(1481.9275604798825,1112.6979471294496,1349.939801416094,1771.597612975157,657.4604846118006,765.828101321958),c(904.4116729399283,397.52177882765,219.75764209099205,278.3939106103818,1155.9928622563718,355.62592291272534),c(492.3248646781428,418.39621013595126,192.95792964087107,84.36179109405509,68.59002511217257,689.2452911897623),c(935.1200649017441,642.5694507077083,483.1605301721811,220.39517923321893,301.1269395168552,1269.3380713865097),c(1570.0903632089664,1362.2835388591384,1261.8836033656964,628.4953436507104,526.9721441544966,1798.37564482846),c(194.1562846618028,281.3510306771039,290.20260053131005,210.90447773513773,142.19883254962608,209.50240013175403),c(1088.6620247108228,1187.119832663393,792.5057824535776,969.106075192958,1114.1696762123643,1217.402602446285),c(1558.2032437398764,1874.1608978974823,1646.2680505074316,1593.3833292889656,1629.4313282745386,668.9992609249289),c(1082.7184649762778,110.72524433098927,45.94236420020739,136.03338813916383,81.97344464625502,590.655926421878),c(808.3241238981177,728.7899278506917,300.15677944135496,33.74471643762204,506.8970148533729,1079.2014393341615),c(399.2090955036047,243.23250394020593,105.667437660477,15.81783583013533,53.53367813632981,451.57450112432696),c(134.72068731635295,52.63987025571621,36.753891360165916,23.199492550865152,78.62758976273442,339.7812035750297),c(1918.7792009689388,1424.9068327840423,805.5227856436363,672.7852839750894,2166.441037079597,594.1769751635882),c(0.0,19.966847338375114,6.89135463003111,1.0545223886756887,1.6729274417603066,2.640786556282614),c(1393.7647577507985,972.9300157608237,542.1198975624472,671.7307615864137,217.48056742883986,976.2107636391396),c(1550.27849742715,1213.4397677912511,555.136900752506,383.8461494779507,284.39766509925215,846.8122223812916),c(982.6685427781039,1532.001741235327,1282.5576672557897,1750.5071652016431,3412.7719811910256,638.190084434965),c(2415.0664388034447,1151.7240578362737,496.94323943224333,391.2278061986805,1256.3685087619904,1062.4764578110382),c(484.4001183654161,610.8040117602933,447.17234488201865,1068.2311797284726,356.3335450949453,767.5886256928131),c(324.9145988217924,746.0340232792884,353.75620434159697,54.83516421113581,90.33808185505656,272.88127748253675),c(1475.9840007453374,1842.3954589500672,1885.9340504185136,2161.7708967851618,3163.50579236874,1633.7666161535105),c(1376.9246718362544,681.5955614145323,324.6593736814656,117.05198514300145,421.57771532359726,1041.3501653607775),c(884.5998071581117,1106.3448593399664,676.8841658830556,266.79416433494924,930.1476576187305,802.7991131099146),c(229.8176430690727,86.22047714298344,38.28530350017283,28.472104494243595,128.8154130155436,292.2470455619426),c(2055.4810748634736,2857.0743373274936,2562.0525102315655,1630.2916128926147,1176.0679915574956,1186.5934259563212),c(1533.4384115126056,1182.5819128137625,1006.9034820545454,679.1124183071436,1585.9352147887707,1379.370844564952),c(529.9674096635944,500.98635139923016,232.00893921104733,111.77937319962301,90.33808185505656,487.665250726856),c(752.8508997090312,940.2569928434826,593.4222042526789,336.3926419875447,152.2363972001879,574.8112070841823),c(1486.8805269253367,1508.4045580172472,763.4089517934462,604.2413287111697,354.660617653185,1289.5841016513432),c(1189.7025401980875,1885.9594895065222,1088.0683254749117,1035.5409856795263,2884.1269095947687,1080.0817015195892),c(1305.6019550217147,719.7140881514302,876.7334501539577,344.8288210969502,219.15349487060016,1332.7169487372926),c(629.0267385726773,133.4148435791428,49.00518848022122,21.090447773513773,60.225387903371036,668.9992609249289),c(1457.1627282526117,1347.7621953403202,1021.4518973846111,666.4581496430353,3238.7875272479537,424.2863733760733),c(2781.5859557670524,2122.838905657245,1671.5363508175458,1666.1453741075882,1599.318634322853,1386.4129420483723),c(355.62299078360815,622.6026033693331,385.15015321173865,729.7294929635766,1135.917732955248,402.2798187403849),c(677.5658097381281,1233.4066151296263,589.5936739026615,63.27134332054132,118.77784836498176,779.0320341033711),c(41.604918141814885,569.9627331136169,220.5233481609955,33.74471643762204,40.15025860224736,115.31434629100748),c(1862.3153834907614,737.865767549953,295.56254302133425,248.86728372746254,143.87175999138637,997.3370560894006),c(740.9637802399412,767.8160385575158,541.3541914924438,115.99746275432575,863.2305599483182,1687.4626094645903),c(334.8205317127007,110.72524433098927,60.49077953027307,4.218089554702755,173.98445394307188,505.2704944354068),c(1200.5990663780867,773.2615423770726,500.7717697822606,1024.9957617927694,1094.0945469112405,930.4371299969076),c(1761.2748680034967,1327.795348001945,794.8029006635879,927.979702034606,393.13794881367204,1130.2566460889589),c(320.9522256654291,454.6995689329969,167.689629330757,83.30726870537941,100.37564650561839,713.8926323817333),c(1455.18154167443,1736.2081344687087,2335.403513510543,1683.0177323263993,1229.6016696938254,1999.0754231059389),c(1039.1323602562813,517.3228628579006,239.6659999110819,76.98013437332527,85.31929952977563,588.0151398655954),c(691.4341157853997,773.2615423770726,513.0230669023159,645.3677018695215,557.0848381061821,851.2135333084292),c(2584.457891237977,1168.9681532648704,1133.2449836051157,1706.2172248772642,1937.2499775584351,1225.3249621151328),c(1591.8834155689647,1616.407050438458,1040.5945491346974,2102.717643019323,486.8218855522492,1540.4588244981915),c(1109.4644837817302,1016.4940463172785,607.9706195827446,354.3195225950314,204.0971478947574,1492.9246664851044),c(281.32849410179585,517.3228628579006,250.3858848911303,839.3998213858482,938.5122948275321,814.2425215204727),c(1751.3689351125884,2151.8815926948814,967.0867664143657,467.1534181833301,2216.6288603324065,1977.0688684702502),c(3574.0605870397167,1292.3995731748255,1317.7801464759489,874.1990602121459,2332.060853813867,1360.0050764855462),c(449.72935324723704,1408.5703213253717,740.4377696933425,296.32079121786853,2588.0187524031944,804.5596374807698),c(127.78653429271714,480.1119200909289,251.91729703113722,31.63567166027066,112.08613859794055,495.5876103957039),c(1666.177912250777,2015.7439972059603,1859.9000440383961,1996.2108817630788,2735.236367278101,2338.8566266809685),c(1091.6338045780954,749.664359158993,712.1066451032146,750.8199407370904,734.4151469327746,1166.347395691488),c(418.0303679963305,283.16619861695614,114.85591050051849,13.708791052783953,56.87953301985043,279.92337496595707),c(2125.8131983889225,1459.3950236412356,683.7755205130867,462.93532862862736,1182.7597013245368,1275.4999066845025),c(1759.293681425315,2267.1447568755016,1882.1055200684964,1734.689329371508,2173.1327468466384,2242.908048469367),c(56.46381747817734,58.9929580451992,76.57060700034566,124.43364186373127,227.5181320794017,1185.7131637708937),c(30.708391961815746,324.9150612335587,166.15821719075007,200.35925384838086,70.26295255393288,558.0862255610591),c(1905.901488210758,1308.7360846334961,1062.0343190947942,1385.642418719855,1831.8555487275357,1772.8480414510616),c(1364.0469590780738,1521.1107335962133,787.9115460335569,1145.2113141017978,2265.143756143455,2162.8041895954607),c(1278.8559362162623,1421.2764969043376,789.4429581735637,957.5063289175254,1137.5906603970086,1512.2904345645102),c(615.1584325254058,852.221347760647,521.445833672354,1630.2916128926147,2037.6256240640535,763.1873147656754),c(1673.1120652744128,1142.6482181370122,621.7533288428067,315.3021942140309,264.32253579812846,976.2107636391396),c(1297.677208708988,989.2665272194943,632.4732138228551,372.24640320251814,138.85297766610546,624.1058894681245),c(1403.6706906417069,3707.480517148288,4276.468400969305,1675.6360756056692,3523.185192347206,4947.073482102764),c(156.51373967635124,189.68504971456358,104.90173159047355,226.72231356527308,160.60103440898945,536.0796709253706),c(1884.1084358507596,1848.7485467395504,1488.5326000867196,1389.8605082745578,2624.823156121921,1407.5392344986333),c(1462.115694698066,1158.9847295956827,674.5870476730453,286.83008971978734,960.260351570416,1161.9460847643502),c(215.94933702180106,736.9581835800269,578.1080828526098,949.0701498081198,3844.3872611651846,828.3267164873132),c(342.74527802542735,382.0928513389056,289.43689446130657,158.1783583013533,291.0893748662933,851.2135333084292),c(1522.5418853326066,676.1500575949755,448.70375702202557,231.9949255086515,135.50712278258484,251.75498503227587),c(1321.451447647168,1325.9801800620928,789.4429581735637,440.79035846643785,654.1146297282799,1704.1875909877135),c(138.68306047271628,270.4600230379902,87.29049198039405,56.94420898848719,95.35686418033748,937.479227480328),c(314.0180726417933,121.61625197010297,101.83890731045973,122.3245970863799,337.93134323558195,1156.664511651785),c(399.2090955036047,959.3162562119317,493.11470908222606,438.6813136890865,113.75906603970085,680.4426693354868),c(618.1302123926782,903.953634046437,617.9247984927895,1420.4416575461528,983.6813357550603,1369.687960525249),c(410.10562168360383,1113.6055310993756,653.9129837829519,811.9822392802803,665.825121820602,556.325701190204),c(2217.93837427437,1033.7381417458753,445.6409327420117,119.16102992035282,864.9034873900786,1357.3642899292636),c(542.8451224217752,500.98635139923016,289.43689446130657,433.4087017457081,368.04403718726746,2113.5095072115187),c(1096.5867710235493,827.7165805726411,647.7873352229243,646.4222242581972,1622.7396185074974,955.9647333743062),c(230.80823635816353,359.40325209075206,1466.3271240566194,106.50676125624456,60.225387903371036,367.06933132328334),c(592.3747868763166,463.77540863225835,6383.691505618817,1172.6288962073659,1189.451411091578,1154.0237250955022),c(823.1830232344802,536.3821262263497,1983.1787213089526,934.3068363666601,1375.1463571269721,678.6821449646318),c(2737.009257757965,1332.3332678515758,2454.0879543610786,774.0194332879555,859.8847050647976,1547.5009219816118),c(2618.138063067065,1060.9656608436594,3540.624867695983,1029.2138513474722,784.6029701855838,356.50618509815286),c(2674.6018805452427,1450.3191839419742,2894.368944613066,507.22526895300626,287.74351998277274,1309.8301319161765),c(941.063624636289,1070.949084512847,398.9328624718009,55.889686599811505,490.1677404357698,1007.0199401291035),c(119.8617879799905,601.7281720610318,300.92248551135845,239.37658222938134,152.2363972001879,1433.9471000614594),c(1455.18154167443,1970.3647987096533,2068.172095079336,2902.045613635495,1224.5828873685443,1215.64207807543),c(2018.8291231671126,1177.1364089942056,1635.5481655273832,2387.438687961759,6171.429332653771,2533.394569660454),c(86.18161615090226,346.69707651178607,140.12421081063255,14.763313441459642,115.43199348146116,186.61558331063804),c(524.0238499290493,197.85330544389885,114.09020443051503,45.34446271305461,105.39442883089932,321.29569768105137),c(1536.4101913798781,808.6573172041922,503.83459406227445,137.08791052783954,122.12370324850238,361.7877582107181),c(915.3081991199274,1056.4277409940287,400.4642746118078,47.45350749040599,133.83419534082452,539.6007196670807),c(1390.7929778835262,1237.944534979257,612.5648560027653,434.4632241343837,324.5479237014995,1312.470918472459),c(497.2778311235969,1232.4990311597003,745.0320061133633,469.2624629606815,307.81864928389643,1049.2725250296253),c(509.1649505926869,87.12806111290959,61.25648560027653,37.962805992324796,25.093911626404598,87.14595635732626),c(1713.726390127137,2595.690153988765,1336.1570921560317,899.5075975403624,734.4151469327746,1512.2904345645102),c(573.5535143835909,585.3916606023613,373.66456216168683,225.66779117659738,399.82965858071327,808.9609484079074),c(2881.635877965226,1831.5044513109535,1408.1334627363567,1619.746389005858,5833.497989418189,1485.882569001684),c(163.44789269998705,355.77291621104746,137.8270926006222,24.25401493954084,184.02201859363373,1266.697284830227),c(795.4464111399369,897.600546256954,470.14352698212235,423.9180002476269,177.3303088265925,1323.0340646975897),c(2000.9984439634777,1796.1086764838342,1744.278427467874,1748.3981204242918,786.2758976273441,2265.794865290483),c(2787.529515501597,2271.6826767251323,1777.9694945480262,1556.4750456853164,413.21307811479574,1026.3857082085092),c(1194.6555066435417,1361.3759548892124,924.9729325641756,126.54268664108264,85.31929952977563,271.1207531116817),c(525.0144432181402,229.6187443913138,104.1360255204701,109.67032842227162,249.2661888222857,580.0927801967475),c(1156.0223683689992,808.6573172041922,569.6853160825717,412.31825397219427,209.11593022003834,922.5147703280599),c(6.9341530236358135,2.7227519097784247,264.1685941511925,17.92688060748671,40.15025860224736,27.28812774825368),c(1604.7611283271456,405.69003455698527,738.9063575533356,570.4966122735476,369.71696462902776,580.0927801967475),c(809.3147171872085,410.227954406616,189.12939929085377,47.45350749040599,734.4151469327746,122.35644377442777),c(1609.7140947725995,766.0008706176635,519.914421532347,346.93786587430156,352.9876902114247,1501.7272883393798),c(1143.1446556108185,711.5458324220949,495.4118272922364,279.4484329990575,227.5181320794017,738.5399735737044),c(1514.61713901988,687.9486492040153,728.9521786432907,392.2823285873562,1171.0492092322147,632.9085113223998),c(1927.6945405707563,778.7070461966294,398.1671564017974,409.1546868061672,945.2040045945732,291.36678337651506),c(1009.4145615835563,560.8868934143554,195.25504785088143,145.52408963724505,167.29274417603065,931.3173921823352),c(582.4688539854084,970.2072638510454,480.86341196217074,156.06931352400193,1676.2732966438273,1345.9208815187055),c(2216.9477809852788,1122.681370798637,1460.2014754965917,1098.8123290000676,434.9611348576797,896.1069047652337),c(1887.0802157180322,1325.9801800620928,1114.1023318550294,561.0059107754664,3268.900221199639,482.38367761429083),c(415.058588129058,670.7045537754186,447.17234488201865,377.51901514589656,3983.24023883129,964.7673552285817),c(2564.6460254561603,551.8110537150941,287.1397762512962,647.4767466468728,1232.947524577346,1414.5813319820536),c(3128.293606948843,1717.1488711002598,1404.3049323863395,1126.2299111056354,4317.825727183352,1443.6299841011623),c(1328.3856006708038,967.4845119412669,777.1916610535085,574.7147018282503,334.5854883520613,1512.2904345645102),c(2576.5331449252503,1463.0253595209401,602.6106770927204,255.19441805951666,272.68717300693,1984.9912281390982),c(99.05932890908305,242.32491997027978,129.40432583058416,23.199492550865152,140.52590510786575,443.6521414554791),c(3087.6792820961186,1049.1670692346197,1291.7461400958312,1246.4454634146641,466.74675625112553,1921.6123507883153),c(2356.621434747086,1338.6863556410588,1170.7645810352851,1617.6373442285064,2077.7758826663007,1762.284895225931),c(411.09621497269467,113.4479962407677,88.05619805039751,166.61453741075883,100.37564650561839,470.94026920373284),c(462.6070660054179,417.4886261660251,161.56398077072933,105.45223886756887,294.43522974981397,300.16940523079046),c(889.5527736035658,509.15460712856543,158.50115649071552,8.43617910940551,41.82318604400766,328.3377951644717),c(855.8726017744776,816.8255729335274,1081.9426769148843,1050.304299120986,2153.0576175455144,999.9778426456832),c(1237.2510180744473,589.929580451992,288.67118839130313,221.44970162189463,1217.8911776015032,649.633492845523))
targetgene="safe_target"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1915.8074211016663,628.9556911588161,251.91729703113722,329.0109852668149,254.2849711475666,1988.5122768808083),c(785.5404782490286,269.552439068064,570.4510221525752,217.23161206719186,103.72150138913901,240.31157662171788),c(1518.5795121762433,667.074217895714,944.1155843142619,141.30600008254228,287.74351998277274,541.3612440379359),c(2420.019405248899,2855.259169387641,2470.167781831151,1617.6373442285064,1380.165139452253,2387.271046879483),c(641.9044513308583,1022.8471341067615,1245.8037758956239,354.3195225950314,1264.7331459707918,590.655926421878),c(1122.3421965399111,569.9627331136169,753.4547728834012,578.9327913829532,456.7091916005637,598.5782860907258),c(761.7662393108487,596.282668241475,392.04150784176977,844.6724333292267,726.050509723973,493.8270860248488),c(1592.8740088580555,1762.5280695965669,1476.2813029666643,1164.1927170979604,1048.9255059837124,904.909526619509),c(754.8320862872129,1736.2081344687087,1957.9104209988384,2120.64452362681,610.6185162425119,1136.4184813869515),c(2634.978148981609,2651.9603601241856,1773.3752581280055,1815.887553299536,1204.5077580674208,1295.7459369493358),c(772.6627654908478,902.1384661065847,1023.7490155946215,468.2079405720058,595.5621692666691,617.9440541701316),c(2658.7523879197893,1731.670214619078,2081.9548043393984,1192.664821592204,1027.1774492408283,1712.1099506565613),c(352.6512109163357,1024.6623020466138,1906.608114308607,1849.632269737158,618.9831534513135,522.8757381439575),c(436.85164048905625,623.5101873392592,516.0858911823298,1071.3947468944998,3327.4526816612497,1149.6224141683647),c(988.6121025126489,1000.157534858608,770.3003064234773,693.8757317486031,486.8218855522492,1750.841486815373),c(12.877712758180797,178.79404207544988,134.76426832060835,6.327134332054133,46.84196836928859,441.01135489919653),c(244.67654240543516,345.78949254185994,155.43833221070167,150.79670158062348,75.2817348792138,685.7242424480521),c(884.5998071581117,1057.335324963955,1563.5717949470584,646.4222242581972,2639.879503097764,777.271509732516),c(1486.8805269253367,1171.6909051746488,601.0792649527134,344.8288210969502,286.07059254101245,1410.1800210549159),c(116.89000811271801,663.4438820160094,830.025379883747,2379.002508852354,376.408674396069,541.3612440379359),c(79.24746312726644,417.4886261660251,574.2795525025924,791.9463138954422,237.55569672996353,649.633492845523),c(502.2307975690511,1098.1766036106312,1042.891667344708,733.9475825182793,1624.4125459492577,2376.7079006543527),c(759.785052732667,696.1169049333506,467.846408772112,292.10270166316576,1661.2169496679844,629.3874625806897),c(971.7720165981048,659.8135461363049,736.6092393433253,286.83008971978734,107.06735627265962,502.62970787912417),c(857.8537883526593,855.8516836403514,455.5951116520567,249.9218061161382,254.2849711475666,764.9478391365305),c(1314.517294623532,1029.2002218962446,977.0409453244106,389.1187614213291,448.3445543917622,677.8018827792042),c(589.4030070090441,774.1691263469987,583.468025342634,656.9674481449541,334.5854883520613,684.8439802626245),c(1881.1366559834871,1819.7058597019138,1120.227980415057,1404.6238217160173,2377.2298947413956,1824.7835103912862),c(2981.6858001634,1920.4476803637156,1530.6464339369097,942.7430154760657,1340.0148808500055,1126.7355973472486),c(359.5853639399715,271.3676070079163,238.134587771075,22.144970162189463,45.16904092752828,221.82607072773956),c(20.802459070907442,397.52177882765,282.5455398312755,43.23541793570324,51.860750694569504,179.57348582721775),c(541.8545291326843,1220.7004395506603,963.2582360643484,1960.3571205481053,414.88600555655603,258.79708251569616),c(591.3841935872258,657.0907942265264,1065.0971433748082,672.7852839750894,577.1599674073058,906.6700509903641),c(1379.896451703527,1298.7526609643085,887.4533351340062,481.91673162478975,304.4727944003758,860.0161551627046),c(1641.4130800235062,1087.2855959715175,847.6366194938264,784.5646571747124,443.32577206648125,852.9740576792843),c(1637.4507068671428,1757.0825657770101,1007.6691881245489,222.5042240105703,1955.6521794177984,1140.8197923140892),c(483.40952507632534,359.40325209075206,595.7193224626892,1073.503791671851,946.8769320363335,161.08797993323944),c(1588.9116357016921,2440.4932951313945,2459.4478968511025,1674.5815532169936,3320.7609718942085,1454.1931303262927),c(1559.1938370289672,981.098271490159,578.1080828526098,346.93786587430156,215.80763998707954,661.9571634415086),c(456.66350627087286,1619.1298023482366,755.7518910934117,316.3567166027066,194.05958324419558,707.7307970837405),c(1351.1692463198929,991.9892791292727,776.425954983505,269.9577315009763,177.3303088265925,944.5213249637483),c(3074.801569337938,1820.6134436718398,2157.7597052697406,2036.2827325327548,627.3477906601149,882.9029719838206),c(390.2937559017872,508.24702315863925,215.92911174097475,561.0059107754664,80.30051720449472,154.04588244981915),c(1696.8863042125927,1465.7481114307186,1931.876414618721,1821.1601652429144,523.6262892709759,1425.144478207184),c(354.63239749451736,433.8251376246957,179.17522038080884,259.4125076142194,505.2240874116126,525.5165247002402),c(3052.017923688849,3389.8261276741387,3311.67875276495,3254.2560914531755,8980.274507369326,3006.095363235042),c(4163.463594048761,6989.304152401216,7502.388073893868,6499.021481408269,2857.3600705266035,2899.58363879831),c(987.6215092235581,237.78700012064908,215.1634056709713,76.98013437332527,25.093911626404598,191.89715642320328),c(428.92689417632965,520.0456147676791,295.56254302133425,15.81783583013533,194.05958324419558,698.9281752294652),c(850.9196353290234,1266.0796380469674,1055.9086705347665,2177.588732615297,416.5589329983163,604.7401213887186),c(80.23805641635728,431.1023857149172,339.97349508153474,113.88841797697438,460.0550464840843,195.41820516491345),c(1683.0179981653212,741.4961034296576,597.2507346026962,781.4010900086853,388.11916648839116,1374.9695336378143),c(655.7727573781299,944.7949126931134,475.50346947214655,282.61200016508457,1590.9539971140516,1087.1237990030095),c(60.42619063454067,314.9316375643711,324.6593736814656,62.216820931865634,81.97344464625502,434.8495196012038),c(1639.4318934453245,1698.997191701737,1065.0971433748082,977.5422543023634,2651.589995190086,1013.1817754270962),c(1723.632323018045,858.5744355501299,749.626242533384,1564.911224794722,704.3024529810891,612.6624810575664),c(458.64469284905454,529.1214544669405,351.45908613158656,143.41504485989367,274.3601004486903,923.3950325134873),c(425.95511430905714,944.7949126931134,646.2559230829173,499.8436122322764,4635.681941117809,771.1096744345233),c(932.1482850344715,868.5578592193175,710.5752329632077,630.6043884280618,1162.684572023413,777.271509732516),c(1240.2227979417198,814.102821023749,770.3003064234773,782.455612397361,555.4119106644218,658.4361146997984),c(2773.6612094543257,2453.1994707103604,2317.792273900463,2759.6850911642773,1587.608142230531,2101.185836615533),c(390.2937559017872,238.69458409057523,98.01037696044244,11.599746275432576,2649.9170677483257,168.13007741665976),c(511.14613717086854,486.46500788041186,267.9971245012098,188.75950757294828,204.0971478947574,728.8570895340015),c(1181.7777938853608,1741.6536382882657,1936.4706510387416,2009.9196728158627,848.1742129724754,1539.578562312764),c(1006.4427817162839,733.3278477003224,1035.2346066446732,446.06297040981633,498.5323776445714,518.4744272168199),c(322.93341224361075,520.0456147676791,176.87810217079848,170.83262696546157,66.91709767041226,162.84850430409452),c(1038.1417669671905,873.0957790689482,852.9965619838506,1071.3947468944998,327.8937785850201,430.44820867406605),c(790.4934446944828,1143.5558021069382,1797.877852368116,1405.678344104693,10076.041981722326,612.6624810575664),c(3586.9382997978973,2658.3134479136684,2613.3548169217975,1269.644955965529,1346.706590617047,1654.0126464183438),c(713.227168145398,775.0767103169248,1319.3115586159556,2330.494478973272,9771.569187321951,539.6007196670807),c(2666.677134232516,1626.3904741076456,2226.673251570052,2218.715105773649,5385.153435026427,1740.2783405902426),c(1453.2003550962484,437.45547350440023,4892.096081252084,449.2265375758434,222.49934975412077,359.1469716544355),c(2200.1076950707347,651.6452904069696,702.9181722631731,992.3055677438231,342.95012556086283,1210.3605049628648),c(722.1425077472155,614.4343476399978,1448.7158844465398,989.142000577796,436.63406229944,944.5213249637483),c(2396.245166310719,918.4749775652552,1511.5037821868234,749.7654183484146,739.4339292580555,852.0937954938568),c(1117.389230094457,785.0601339861124,679.9469901630695,419.6999106929241,217.48056742883986,613.542743242994),c(67.36034365817648,333.99090093282007,166.92392326075353,48.50802987908168,28.439766509925214,345.06277668759486),c(703.3212352544897,301.317878015479,102.60461338046318,142.36052247121796,3141.7577356258557,249.11419847599325),c(1740.4724089325894,2743.626341086726,2362.968932030667,1629.237090503939,3713.8989207078807,1804.537480126453),c(1576.0339229435115,2749.071844906283,1349.1740953460906,1097.757806611392,1328.3043887576835,1911.049204563185),c(541.8545291326843,1031.922973806023,806.2884917136398,358.5376121497342,376.408674396069,937.479227480328),c(1219.4203388708124,1065.5035806932901,1303.231731145883,1680.9086875490477,1075.692345051877,1062.4764578110382),c(412.0868082617855,778.7070461966294,591.1250860426685,971.2151199703093,1174.3950641157353,808.0806862224798),c(491.33427138905193,660.721130106231,415.7783960118769,83.30726870537941,1023.8315943573076,273.7615396679643),c(1114.4174502271844,981.098271490159,493.8804151522295,1344.516045561503,595.5621692666691,882.0227097983931),c(74.29449668181229,461.96024069240605,205.97493283092982,250.97632850481392,199.0783655694765,516.7139028459648),c(1110.455077070821,1142.6482181370122,1513.8009003968336,1116.7392096075544,968.6249887792176,775.5109853616609),c(1899.957928476213,1170.7833212047226,1241.9752455456066,436.57226891173514,535.3367813632981,787.8346559576465),c(985.6403226453764,1033.7381417458753,1715.1815968077428,1330.807254508719,3782.4889458200532,546.6428171505011),c(2040.622175527111,1510.2197259570996,2083.4862164794054,426.02704502497824,4945.1735178434665,787.8346559576465),c(396.2373156363322,306.76338183503583,198.31787213089527,330.0655076554906,6039.268064754707,503.50997006455174),c(790.4934446944828,345.78949254185994,454.06369951204977,131.8152985844611,200.75129301123678,389.9561481443993),c(849.9290420399326,1259.7265502574844,964.0239421343518,957.5063289175254,2035.9526966222932,734.1386626465667),c(1048.0476998580987,1757.0825657770101,1836.1631558682889,1446.804717263045,3384.3322146811,720.9347298651536),c(270.43196792179674,1089.1007639113698,1166.936050685268,122.3245970863799,444.99869950824154,584.4940911238853),c(954.9319306835606,654.3680423167481,1219.7697695155064,768.746821344577,419.90478788183697,1319.5130159558794),c(829.1265829690252,933.9039050539997,1146.2619867951746,805.6551049482262,3749.030396984847,1330.9564243664374),c(230.80823635816353,29.95027100756267,42.11383385019011,6.327134332054133,10.03756465056184,0.0),c(2326.9036360743607,3449.726669689264,9812.523287094296,4604.0447489580565,2582.9999700779135,3015.778247274745),c(364.53833038542564,530.9366224067928,1928.0478842687037,138.14243291651522,86.99222697153594,73.06176139048566),c(553.7416486017743,451.9768170232185,8343.899044827667,1090.3761498906622,301.1269395168552,1106.4895670824153),c(187.22213163816699,491.9105116999687,3934.9634937477636,604.2413287111697,416.5589329983163,716.5334189380159),c(1838.5411445525815,1727.1322947694473,7159.351754532319,2342.094225248705,3044.7279440037582,1139.059267943234),c(1290.7430556853521,1213.4397677912511,2429.585360120968,2293.586195369623,3491.39957095376,725.3360407922913),c(729.0766607708513,440.17822541417866,2295.5867978703627,877.362627378173,493.51359531929046,331.85884390618185),c(630.0173318617682,680.6879774446062,8552.93680193861,630.6043884280618,3856.0977532575066,316.8943867539137),c(1569.0997699198756,1243.390038798814,16806.48253050587,4110.528271057835,846.5012855307151,1788.6927607887571),c(2098.076586294379,619.8798514595546,5523.037882934932,623.2227317073321,1846.9118957033786,912.8318862883569),c(379.3972297217881,313.11646962451886,894.3446897640373,189.81402996162396,421.57771532359726,551.0441280776388),c(318.97103908724745,214.1898169025694,395.87003819178705,325.8474181007878,81.97344464625502,175.17217490008005),c(2670.6395073888793,2174.571191943035,1457.138651216578,534.6428510585741,1602.6644892063737,895.2266425798061),c(3258.0613278197416,2187.277367522001,11171.65156135043,1723.0895830960753,3914.6502137191173,2841.4863345600925),c(405.1526552381497,442.9009773239571,1265.7121337157137,350.10143304032863,2469.2409040382126,602.0993348324359),c(812.2864970544811,1079.1173402421823,13737.532601932015,1465.7861202592073,327.8937785850201,839.7701248978713),c(273.40374778906926,272.27519097784244,4702.96668196123,577.8782689942774,369.71696462902776,69.5407126487755),c(4311.061994123294,4410.858093841048,5712.167282225786,7798.193064256718,5898.742159646841,3255.2095617110353),c(2636.959335559791,1069.1339165729948,1277.1977247657655,1505.8579710288834,1371.8005022434513,1807.1782666827355),c(1679.0556250089578,1579.1961076714863,4644.007314570964,2269.332180430082,446.67162695000184,1383.7721554920897),c(3498.7754970688134,2053.8625239428584,3617.195474696329,2362.1301506335426,4997.034268538036,2383.7499981377728),c(1397.7271309071618,1610.0539626489751,9279.59186237189,2726.994897115331,1085.729909702439,1055.4343603276182),c(396.2373156363322,1816.0755238222093,4601.12777465077,308.9750598819768,465.07382880936524,538.7204574816533),c(1777.12436062895,1218.885271610808,1477.0470090366678,1393.0240754405847,3295.667060267804,992.0554829768353),c(590.393600298135,476.4815842112243,1858.3686318983891,399.663985308086,237.55569672996353,710.3715836400231))
targetgene="non_target"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1270.9311899035356,1077.30217230233,408.12133531184236,176.10523890884002,229.191059521162,1658.4139573454815),c(970.7814233090139,883.0792027381357,985.4637120944486,876.3081049894973,306.1457218421361,618.8243163555592),c(1737.5006290653168,1421.2764969043376,772.5974246334877,660.1310153109812,727.7234371657333,322.1759598664789),c(2629.034589247064,990.1741111894204,424.9668688519184,416.53634352689704,918.4371655264083,1750.841486815373),c(502.2307975690511,281.3510306771039,408.8870413818458,261.5215523915708,195.73251068595587,575.6914692696098),c(1139.1822824544552,853.1289317305731,406.58992317183544,378.57353753457227,127.1424855737833,676.0413584083492),c(707.283608410853,532.7517903466451,513.0230669023159,1494.2582247534508,404.8484409059942,1058.0751468839007),c(2003.9702238307502,1688.1061840626232,1543.6634371269686,2323.112822252542,1340.0148808500055,2397.8341931046134),c(2121.850825232559,2190.0001194317797,2785.638682672575,1830.6508667409955,1985.764873369484,1141.7000544995167),c(450.7199465363279,1389.5110579569227,1169.9988749652816,1202.1555230902852,1288.1541301554362,1311.5906562870316),c(125.80534771453549,291.3344543462914,114.85591050051849,11.599746275432576,28.439766509925214,181.33401019807283),c(2073.3117540671083,3051.2973068916876,2830.0496347327758,4286.633509966675,1930.5582677913937,1242.049943638256),c(2267.4680387289113,2917.882463312545,3251.95367930468,3244.765389955094,1161.0116445816527,1975.3083440993953),c(1725.6135095962268,2025.727420875148,2516.875852101362,3336.508837769879,1022.1586669155473,1323.0340646975897),c(1140.172875743546,428.3796338051388,276.4198912712478,448.1720151871677,138.85297766610546,259.67734470112373),c(1746.4159686671342,923.9204813848121,489.2861787322088,826.74555272174,388.11916648839116,1866.1558331063804),c(1714.7169834162278,867.6502752493914,522.2115397423574,297.37531360654424,1202.8348306256605,1666.3363170143293),c(573.5535143835909,379.37009942912715,225.8832906510197,34.799238826297724,189.04080091891464,1036.068592248212),c(1001.4898152708297,687.9486492040153,592.6564981826754,175.05071652016431,1840.2201859363372,736.7794492028493),c(822.1924299453893,550.903469745168,416.5441020818804,439.7358360777622,230.86398696292233,1083.6027502612992),c(2903.4289303252244,932.9963210840735,759.5804214434289,782.455612397361,366.37110974550717,1081.842225890444),c(1281.8277160835348,520.0456147676791,348.3962618515728,107.56128364492025,165.61981673427036,193.65768079405836),c(6042.619063454066,2773.5766120942885,2033.7153219291806,1064.0130901737698,2837.28494122548,4745.493441639857),c(1940.572253328937,733.3278477003224,302.45389765136537,158.1783583013533,585.5246046161074,818.6438324476103),c(1426.454336290796,2210.874550740081,1354.5340378361147,397.55494053073465,3854.4248258157463,1089.764585559292),c(1265.9782234580814,1171.6909051746488,871.3735076639335,326.90194048946347,448.3445543917622,1218.2828646317125),c(1420.510776556251,1026.477469986466,552.0740764724922,446.06297040981633,747.7985664668571,1732.3559809213948),c(1638.4413001562336,1447.5964320321957,1138.60492609514,620.059164541305,391.46502137191175,497.348134766559),c(2316.997703183453,1009.2333745578694,1287.917609745814,1617.6373442285064,1336.669025966485,1016.7028241688064),c(2040.622175527111,2844.3681617485277,2434.945302610992,1320.2620306219624,1079.0381999353979,2223.542280389961),c(1790.9926666762217,1809.7224360327261,1706.7588300377047,2250.3507774339196,1296.5187673642376,1684.8218229083077),c(786.5310715381195,1381.3428022275875,1799.409264508123,627.4408212620348,1231.2745971355857,1070.3988174798862),c(65.37915707999481,147.02860312803492,110.26167408049776,254.13989567084099,148.89054231666728,181.33401019807283),c(686.4811493399455,421.1189620457297,418.0755142218873,275.23034344435473,163.94688929251004,390.8364103298269),c(708.2742016999439,912.1218897757723,797.8657249436018,957.5063289175254,1485.5595682831522,1387.2932042337998),c(1097.5773643126402,725.1595919709871,1050.5487280447423,806.7096273369018,664.1521943788417,574.8112070841823),c(1692.9239310562293,1559.2292603331111,1137.073513955133,1391.969553051909,2223.3205700994477,1583.5916715841408),c(867.7597212435676,484.64983994055956,789.4429581735637,1990.9382698197003,4013.3529327829756,574.8112070841823),c(2380.3956736852656,1933.1538559426815,1982.4130152389491,1024.9957617927694,1159.3387171398924,1842.388754099837),c(1650.3284196253237,1965.8268788600226,1359.893980326139,962.7789408609037,784.6029701855838,2782.5087681364475),c(1072.8125320853694,1107.2524433098927,829.2596738137435,679.1124183071436,1646.1606026921418,1264.0564982739445),c(967.8096434417414,481.92708803078114,436.45245990197026,1117.79373199623,354.660617653185,1387.2932042337998),c(1348.1974664526203,805.9345652944137,547.4798400524714,905.8347318724166,1572.5517952546882,1058.0751468839007),c(764.7380191781211,1052.7974051143242,741.9691818333495,202.46829862573225,1616.0479087404563,735.0189248319942),c(1503.7206128398807,1041.9063974752105,677.6498719530591,787.7282243407394,401.50258602247357,1912.80972893404),c(1997.0360708071144,932.9963210840735,1374.4423956562046,2045.7734340308361,460.0550464840843,1367.927436154394),c(2815.2661275961404,1978.5330544389885,2050.5608554692567,2186.0249117247026,8908.338627373632,2306.2869258201495),c(75.28508997090312,471.9436643615936,369.07032574166607,139.1969553051909,60.225387903371036,216.54449761517435),c(3127.303013659752,3498.7362040652756,4087.339001678451,3946.022778424427,1539.093246419482,1375.849795823242),c(2504.2198348216198,1384.0655541373658,1655.4565233474732,1762.1069114770758,466.74675625112553,578.3322558258925),c(1505.7017994180624,2062.0307796721936,2232.033194060076,2691.1411359003578,1196.143120858619,1735.8770296631048),c(1388.8117913053445,556.3489735647248,229.71182100103698,323.7383733234364,265.99546323988875,462.13764734945744),c(1592.8740088580555,704.2851606626858,390.51009570176285,122.3245970863799,220.82642231236048,1183.9526394000386),c(734.0296272163055,626.2329392490377,391.27580177176634,1557.5295680739923,495.18652276105075,1641.6889758223583),c(1167.9094878380893,2149.158840785103,2303.2438585703976,1456.295418761126,985.3542631968206,1247.3315167508213),c(3049.0461438215766,1749.821894017601,2121.005813909575,2053.1550907515657,5756.543327097215,941.8805384074657),c(2772.6706161652346,1526.55623741577,2065.1092707993225,1832.759911518347,700.9565980975684,1057.194884698473),c(1008.4239682944655,1338.6863556410588,1085.7712072649015,945.9065826420928,384.7733116048705,577.4519936404649),c(621.1019922599507,837.7000042418287,408.8870413818458,196.1411642936781,157.25517952546883,867.9385148315524),c(1414.567216821706,1090.9159318512222,735.8435332733218,451.33558235319475,317.85621393445825,934.8384409240454),c(787.5216648272103,981.098271490159,784.0830156835395,2702.7408821757904,1135.917732955248,1025.5054460230817),c(280.3379008127051,1271.5251418665243,741.203475763346,1048.1952543436346,249.2661888222857,362.66802039614566),c(2138.690911147103,1221.6080235205866,672.2899294630349,465.0443734059787,936.8393673857717,3162.782032241144),c(2455.680763656169,717.898920211578,872.9049198039405,2440.1648073955434,1321.6126789906423,1819.501937278721),c(1405.6518772198885,557.2565575346509,499.2403576422537,780.3465676200096,465.07382880936524,1371.4484848961042),c(1500.7488329726084,1511.1273099270256,1638.6109898073971,2793.4298076018995,1505.634697584276,1742.9191271465252),c(1553.2502772944224,819.5483248433059,742.7348879033528,869.9809706574432,5390.172217351708,734.1386626465667),c(992.5744756690123,1548.3382526939974,1974.7559545389145,1046.0862095662833,6748.589300061077,1551.9022329087495),c(671.6222500035831,314.024053594445,186.83228108084342,162.39644785605606,165.61981673427036,951.5634224471686),c(1063.897192483552,894.8777943471756,660.804338412983,336.3926419875447,456.7091916005637,1677.7797254248874),c(1189.7025401980875,733.3278477003224,665.3985748330037,1785.306404027941,1948.9604696507572,931.3173921823352),c(601.2901264781342,1374.9897144381043,1508.4409579068094,1677.7451203830208,2109.5615040597468,1337.1182596644303),c(1147.1070287671819,973.8375997307498,896.6418079740477,2150.171150509729,3620.2149839693034,1379.370844564952),c(1946.515813063482,2191.8152873716317,1457.138651216578,1048.1952543436346,955.2415692451351,2352.940821647809),c(2420.019405248899,2163.6801843039216,2630.2003504618733,5455.044316619337,1947.287542208997,1111.7711401949805),c(1339.2821268508028,1342.3166915207632,1015.3262488245834,567.3330451075205,617.3102260095532,721.8149920505812),c(1519.570105465334,1670.8620886340266,1362.9568046061527,362.7557017044369,808.0239543702281,1181.311852843756),c(1700.848677368956,442.9009773239571,291.734012671317,432.35417935703236,1234.6204520191063,950.683160261741),c(864.7879413762951,697.0244889032767,724.3579422232699,1266.4813887995022,281.0518102157315,334.49963046246444),c(129.7677208708988,510.9697750684177,751.9233607433944,1002.8507916305799,262.64960835636816,995.5765317185454),c(42.59551143090572,189.68504971456358,840.7452648637953,215.1225672898405,110.41321115618024,426.92715993235595),c(1860.3341969125797,887.6171225877664,774.894542843498,289.9936568858144,301.1269395168552,957.7252577451613))
targetgene="Epha7"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1047.0571065690078,1249.743126588297,1037.5317248546837,3521.0502557881246,1925.5394854661129,1210.3605049628648),c(675.5846231599464,1604.6084588294182,2822.392574032741,739.2201944616578,361.35232742022623,1915.4505154903227),c(1352.1598396089837,2049.3246040932277,861.4193287538886,272.06677627832767,685.9002511217257,1232.3670595985532),c(625.0643654163141,412.04312234646824,500.0060637122572,443.953925632465,1863.6411701209815,948.0423737054584),c(2382.3768602634473,1274.2478937763028,676.8841658830556,757.1470750691445,1110.8238213288437,727.9768273485739),c(1084.6996515544595,1443.058512182565,1194.5014692053924,1484.7675232553697,901.7078911088053,2411.918388071454),c(403.171468659968,312.2088856545927,118.68444085053576,20.035925384838084,138.85297766610546,325.69700860818904),c(117.88060140180883,90.75839699261415,64.31930988029035,170.83262696546157,274.3601004486903,148.7643093372539),c(777.615731936302,269.552439068064,328.48790403148286,107.56128364492025,615.6372985677929,187.49584549606558),c(405.1526552381497,606.2660919106626,274.8884791312409,25.30853732821653,215.80763998707954,359.1469716544355),c(831.1077695472069,740.5885194597315,394.3386260517801,83.30726870537941,429.9423525323988,192.77741860863082),c(1287.7712758180796,1385.880722077218,1291.7461400958312,1084.049015558608,2445.819919853568,1864.3953087355255),c(1106.4927039144577,472.85124833151974,321.59654940145174,155.01479113532625,130.4883404573039,279.92337496595707),c(2339.781348832542,1259.7265502574844,451.0008752320359,186.6504627955969,162.27396185074974,1222.6841755588503),c(148.58899336362458,343.0667406320815,175.34669003079156,71.70752242994683,525.2992167127363,369.7101178795659),c(927.1953185890173,750.5719431289191,288.67118839130313,67.48943287524408,252.6120437058063,899.6279535069439),c(1127.295162985365,673.427305685197,281.779833761272,130.7607761957854,142.19883254962608,1012.3015132416687),c(1372.962298679891,1325.9801800620928,673.8213416030418,340.61073154224744,2255.1061914928932,428.687684303211),c(679.5469963163098,437.45547350440023,150.84409579068094,283.6665225537603,113.75906603970085,606.5006457595737),c(507.18376401450524,676.1500575949755,677.6498719530591,670.676239197738,309.4915767256567,286.0852102639498),c(145.6172134963521,31.765438947414953,10.719884980048391,0.0,21.748056742883985,77.46307231762334),c(941.063624636289,457.4223208427753,418.84122029189075,339.5562091535718,608.9455888007516,1577.429836286148),c(817.2394634999353,537.2897101962758,396.63574426179053,89.63440303743354,189.04080091891464,249.11419847599325),c(922.2423521435633,959.3162562119317,363.7103832516419,388.06423903265346,155.5822520837085,691.8860777460449),c(844.9760755944785,449.25406511344005,378.25879858170754,299.4843583838956,816.3885915790296,680.4426693354868),c(105.00288864362804,242.32491997027978,111.0273801505012,28.472104494243595,43.49611348576797,155.80640682067423),c(468.55062573996287,502.8015193390824,186.06657501083995,66.43491048656838,88.66515441329625,411.9627027800878),c(1735.5194424871352,2221.7655583791943,2476.2934303911784,797.2189258388206,2909.220821221173,677.8018827792042),c(1425.463743001705,1606.4236267692706,2402.7856476708466,3968.1677485866167,1308.2292594565597,1262.2959739030894),c(1669.1496921180494,1039.183645565432,761.1118335834359,1300.226105237124,1246.3309441114284,977.0910258245672),c(2859.842825605228,1703.5351115513677,1911.2023507286276,2167.0435087285405,5002.0530508633165,1604.7179640344018),c(528.9768163745035,1580.1036916414125,1325.4372071759833,1501.6398814741808,2338.752563580909,382.914050660979),c(1266.9688167471722,874.0033630388743,1239.6781273355962,1535.3845979118028,5605.979857338787,1190.994736883459),c(311.0462927745208,139.7679313686258,97.24467089043898,142.36052247121796,117.10492092322146,1012.3015132416687),c(828.1359896799344,344.88190857193376,179.9409264508123,253.08537328216528,115.43199348146116,197.1787295357685),c(446.7575733799646,425.65688189536036,437.9838720419772,399.663985308086,741.1068566998158,316.0141245684861),c(958.894303839924,259.5690153988765,140.12421081063255,256.24894044819234,727.7234371657333,1188.3539503271763),c(338.78290486906405,551.8110537150941,1574.2916799271068,124.43364186373127,112.08613859794055,1019.343610725089))
targetgene="Atrx"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1122.3421965399111,1439.4281763028605,1560.5089706670444,1313.9348962899082,605.599733917231,1066.877768738176),c(1247.1569509653557,1046.4443173248412,415.0126899418735,146.57861202592073,167.29274417603065,1080.9619637050166),c(1602.779941748964,1080.9325081820346,1177.6559356653163,1045.0316871776074,1674.600369202067,1117.9329754929731),c(1578.0151095216931,1100.8993555204097,1630.9539291073625,1438.3685381536393,1132.5718780717275,997.3370560894006),c(2155.530997061647,2884.301856425278,4372.181659719737,1445.7501948743693,6977.780359582239,1939.2175944968662),c(1462.115694698066,1546.5230847541452,937.2242296842309,1443.6411500970178,721.0317273986922,1866.1558331063804),c(1570.0903632089664,824.0862446929365,619.4562106327963,1028.1593289587966,396.4838036971927,397.87850781324715),c(626.0549587054049,374.8321795794965,349.1619679215762,269.9577315009763,145.54468743314666,822.1648811893205),c(2036.6598023707477,1910.4642566945279,689.1354630031109,653.8038809789269,618.9831534513135,955.9647333743062),c(3382.8760822451864,3715.6487728776233,8613.427581468883,2188.133956502054,2414.0342984601225,2987.609857341064),c(1137.2010958762735,1218.885271610808,3596.5214108062355,1457.3499411498017,774.5654055350219,1266.697284830227),c(1057.953632749007,793.2283897154477,3705.2516727467264,550.4606868887095,2109.5615040597468,480.62315324343575),c(865.7785346653859,719.7140881514302,6117.225793257615,1071.3947468944998,297.78108463333456,701.5689617857478),c(891.5339601817475,754.2022790086236,3446.443021085558,1156.8110603772304,2238.3769170752903,1369.687960525249),c(728.0860674817604,416.58104219609896,4634.818841730923,370.1373584251667,230.86398696292233,1020.2238729105165),c(2841.021553112502,2645.6072723347024,3026.0703886536603,1893.9222100615368,2263.4708287016947,1399.6168748297853),c(2696.3949329052407,2575.7233066503895,3920.4150784176977,1567.0202695720734,2019.22342220469,2553.6405999252875),c(438.83282706723793,745.1264393093622,689.1354630031109,87.52535826008216,622.329008334834,363.5482825815732),c(553.7416486017743,458.3299048127015,1805.5349130681507,152.90574635797486,133.83419534082452,999.9778426456832),c(880.6374340017484,378.46251545920103,4402.044196449872,607.4048958771967,4384.7428248537635,340.6614657604572),c(1295.6960221308063,1289.6768212650472,3648.5894235664705,1329.7527321200434,1246.3309441114284,1712.990212841989),c(2428.9347448507165,1072.7642524526993,1479.3441272466782,799.327970616172,884.9786166912022,1152.2632007246473),c(1701.8392706580469,1890.4974093561527,2340.7634560005667,866.8174034914161,311.164504167417,1117.0527133075457),c(59.435597345449835,399.3369467675023,3338.4784652150706,508.27979134168197,1249.676798994949,308.0917648996383),c(479.447151919962,1088.1931799414438,2544.441270621486,1460.5135083158289,592.2163143831485,1695.384969133438),c(1528.4854450671514,1149.9088898964214,2428.053947980961,699.1483436919816,1442.0634547973843,2155.7620921120406),c(2952.958594779766,1706.2578634611461,4635.584547800926,1829.5963443523199,1005.4293924979443,1053.673835956763),c(1726.6041028853176,1272.4327258364503,2690.691129992146,950.1246721967955,537.0097088050584,628.5072003952621),c(789.502851405392,317.6543894741495,1042.891667344708,105.45223886756887,342.95012556086283,1057.194884698473),c(1074.793718663551,630.7708590986683,949.4755268042861,265.73964194627354,443.32577206648125,1300.1472478764736),c(1101.5397374690035,280.4434467071777,1444.121648026519,109.67032842227162,1276.443638063114,535.1994087399431),c(757.8038661544854,1648.172489385873,8200.71200973702,1772.6521353638327,483.4760306687286,1283.4222663533503),c(1410.6048436653427,1362.2835388591384,1062.0343190947942,1453.131851595099,1500.615915258995,1920.7320886028879),c(1743.4441887998619,1073.6718364226253,947.1784085942758,438.6813136890865,5646.130115941035,1109.130353638698),c(2000.0078506743869,1907.7415047847496,2200.639245189934,1804.2878070241034,784.6029701855838,2488.50119820365),c(883.6092138690209,811.3800691139705,1166.936050685268,3689.773837976235,1763.2655236153632,1474.4391605911262),c(316.98985250906577,586.2992445722874,1052.8458462547528,2940.0084196278203,3810.9287123299787,1067.7580309236037),c(1239.232204652629,1379.527634287735,1448.7158844465398,1273.863045520232,451.6904092752828,782.5530828450812),c(2554.740092565252,1456.6722717314572,1058.9714948147805,959.6153736948767,458.382119042324,1009.6607266853861),c(1100.5491441799127,1916.8173444840108,1744.278427467874,199.30473145970515,398.156731138953,1399.6168748297853),c(1790.0020733871308,1026.477469986466,1008.4348941945523,1154.7020155998791,650.7687748447593,1787.8124986033297),c(1180.78720059627,1147.186137986643,1854.540101548372,656.9674481449541,438.3069897412003,869.6990392024076),c(1586.9304491235105,936.626656963778,807.0541977836432,517.7704928397632,4063.540756035785,174.2919127146525),c(763.7474258890304,2426.8795355825023,1366.78533495617,927.979702034606,3126.701388650013,766.7083635073856),c(329.86756526724656,1078.209756272256,1952.5504785088142,1802.178762246752,6591.334120535608,1563.3456413193076),c(2171.3804896871006,1554.6913404834804,2477.059136461182,3576.9399423879363,5544.081541993656,1551.0219707233218),c(657.7539439563114,1100.8993555204097,467.0807027021085,1017.6141050720396,173.98445394307188,790.4754425139291),c(756.8132728653945,887.6171225877664,1398.1792838263118,981.7603438570662,1614.374981298696,1591.5140312529886),c(1613.676467928963,2352.4576500485587,1970.9274241888972,2731.212986670034,2869.070562618926,1689.2231338354454),c(1027.2452407871913,1883.2367375967438,1804.7692069981472,4327.759883125026,3002.9047579597504,2928.6322909174187),c(1461.125101408975,2622.9176730865493,2165.416765969775,2686.9230463456547,2880.781054711248,1343.280094962423),c(1245.175764387174,1103.6221074301882,845.339501283816,274.1758210556791,650.7687748447593,1163.706609135205),c(671.6222500035831,496.44843154959943,414.24698387187,215.1225672898405,127.1424855737833,347.7035632438775),c(656.7633506672206,819.5483248433059,414.24698387187,94.90701498081198,190.71372836067496,1502.6075505248073),c(824.173616523571,1182.5819128137625,855.293680193861,1204.2645678676365,490.1677404357698,2119.6713425095113),c(1259.0440704344455,1372.266962528326,1625.5939866173383,480.86220923611404,434.9611348576797,1503.487812710235),c(2492.3327153525297,1512.9424778668779,1935.7049449687383,1490.0401351987482,5480.510299206764,1781.6506633053368),c(926.2047252999266,1848.7485467395504,2115.6458714195505,2367.4027625769213,1495.5971329337142,1895.2044852254892),c(1493.8146799489725,2745.4415090265784,2284.8669128903143,2227.1512848830544,1522.3639720018791,2192.7331038999973),c(1352.1598396089837,958.4086722420054,846.1052073538195,934.3068363666601,587.1975320578676,531.678359998233),c(2012.8855634325678,1367.7290426786954,2052.0922676092637,2530.853732821653,1803.4157822176105,1157.5447738372125),c(1300.6489885762605,1127.2192906482678,843.8080891438092,649.5857914242242,978.6625534297793,2139.037110588917),c(2067.3681943325632,1122.681370798637,523.7429518823643,2031.0101205893764,1843.5660408198578,1676.0192010540322),c(70.33212352544896,335.80606887267237,188.3636932208503,81.19822392802803,607.2726613589913,120.59591940357271),c(974.7437964653773,274.09035891769474,196.02075392088489,172.94167174281296,118.77784836498176,604.7401213887186),c(3458.1611722160897,3119.3661046361485,3849.97011997738,4713.715077380329,2209.937150565365,2009.6385693310692),c(4698.383970157809,5028.92277736075,4699.138151611213,5790.382436218207,2079.448810108061,3007.8558876058974),c(5997.051772155888,5676.937731888015,4761.160343281493,5523.588271883257,16769.42467620531,5329.107270578315),c(1928.6851338598472,2125.5616575670233,2135.5542292396403,1824.3237324089414,5972.350967084295,2029.004337410475),c(1025.2640542090096,854.9440996704253,676.8841658830556,662.2400600883325,1421.9883254962606,845.931960195864),c(210.99637057634692,918.4749775652552,503.83459406227445,572.6056570508989,3027.998669586155,1321.2735403267345),c(565.6287680708642,2005.7605735367729,1263.4150155057034,3045.460658495389,2531.139219383344,1497.325977412242),c(187.22213163816699,194.2229695641943,81.1648434203664,33.74471643762204,31.785621393445826,305.4509783433557),c(639.9232647526766,506.431855218787,484.691942312188,157.1238359126776,705.9753804228494,1250.8525654925315),c(1276.8747496380806,738.7733515198793,564.3253735925475,720.2387914654954,634.0395004271562,800.158326553632),c(2301.1482105579994,2373.3320813568603,1726.6671878577945,3142.4767182535525,4035.1009895258594,3037.7848019104335),c(527.9862230854127,636.2163629182252,261.87147594118215,16.87235821881102,66.91709767041226,140.84194966840607),c(1682.0274048762303,1080.9325081820346,1351.4712135561008,1338.1889112294489,582.1787497325867,852.9740576792843),c(2371.4803340834483,3327.2028337492347,3016.1162097436154,5923.252257191343,2534.4850742668646,1551.0219707233218),c(992.5744756690123,1293.3071571447517,1543.6634371269686,363.8102240931126,2603.075099379037,1207.7197184065822),c(741.9543735290321,243.23250394020593,253.44870917114412,79.08917915067666,868.2493422735992,932.1976543677628),c(2023.7820896125668,1813.3527719124309,1453.3101208665605,1615.5282994511551,848.1742129724754,1982.3504415828156),c(1345.2256865853478,982.0058554600852,1790.986497738085,1215.8643141430691,496.85945020281105,1176.0302797311908),c(1468.059254432611,2174.571191943035,1654.6908172774697,684.3850302505219,2437.4552826447666,1695.384969133438),c(2334.8283823870875,1147.186137986643,647.7873352229243,489.2983883455196,2161.4222547543163,1455.0733925117204),c(1117.389230094457,1067.3187486331424,709.0438208232008,684.3850302505219,4321.171582066872,2126.713439992932),c(833.0889561253884,885.8019546479142,353.75620434159697,310.0295822706525,695.9378157722875,1823.022986020431),c(603.2713130563158,852.221347760647,509.19453655229864,362.7557017044369,291.0893748662933,1047.5120006587701),c(2210.013627961643,749.664359158993,552.0740764724922,473.4805525153842,3804.237002562937,1237.6486327111184),c(514.1179170381411,375.7397635494226,306.28242800138264,184.54141801824554,242.57447905524447,519.3546894022475),c(1820.7104653489466,2167.310520183626,1964.036069558866,684.3850302505219,1718.0964826878349,1506.1285992665175),c(1306.5925483108056,1026.477469986466,523.7429518823643,245.70371656143547,202.4242204529971,948.9226358908859),c(1369.9905188126186,1311.4588365432746,926.5043447041825,897.3985527630111,1984.0919459277236,1341.5195705915678),c(805.3523440308452,541.8276300459065,297.09395516134117,258.35798522554376,217.48056742883986,772.8701988053783),c(336.8017182908824,72.60671759409132,42.11383385019011,430.245134579681,217.48056742883986,287.8457346348049),c(1048.0476998580987,548.1807178353895,473.2063512621362,1410.9509560480715,4654.084142977173,1091.525109930147),c(203.07162426362027,106.18732448135856,127.10720762057379,9.490701498081199,50.187823252809196,431.3284708594936),c(2111.9448923416508,2663.7589517332253,2085.0176286194123,2724.8858523379795,1838.547258494577,1584.4719337695683),c(977.7155763326498,863.1123553997606,1146.2619867951746,1046.0862095662833,4277.675468581104,1969.1465088014024),c(2925.2219826852224,3158.3922153429726,2872.9291746529693,4382.595047336163,3884.537519767432,2330.054004826693),c(1182.7683871744516,1715.3337031604076,2889.774708193045,2395.8748670711648,868.2493422735992,1455.0733925117204),c(1717.6887632835,1342.3166915207632,547.4798400524714,67.48943287524408,102.0485739473787,392.5969347006819),c(630.0173318617682,735.1430156401747,387.447271421749,171.88714935413725,197.40543812771617,443.6521414554791),c(1310.554921467169,742.4036873995838,380.55591679171795,88.57988064875785,652.4417022865196,959.4857821160164),c(689.4529292072181,750.5719431289191,503.06888799227096,548.3516421113582,190.71372836067496,830.0872408581683),c(110.94644837817302,1022.8471341067615,642.4273927329001,262.5760747802465,138.85297766610546,381.1535262901239),c(279.34730752361423,333.99090093282007,234.30605742105772,99.12510453551474,363.0252548619865,532.5586221836605),c(1584.9492625453288,902.1384661065847,420.37263243189767,95.96153736948767,239.22862417172385,1445.3905084720175),c(353.6418042054265,1021.0319661669092,452.53228737204284,115.99746275432575,165.61981673427036,776.3912475470885),c(1412.5860302435244,600.8205880911057,303.9853097913723,333.22907482151766,296.10815719157426,1866.1558331063804),c(681.5281828944915,1412.2006572050761,848.4023255638299,330.0655076554906,1020.485739473787,1066.877768738176),c(924.223538721745,901.2308821366586,625.581859192824,385.95519425530205,319.52914137621855,764.9478391365305),c(1888.070809007123,2168.2181041535523,1830.8032133782647,1814.8330309108603,1216.2182501597429,1799.2559070138877),c(39.62373156363322,21.782015278227398,72.74207665032837,10.545223886756887,53.53367813632981,7.922359668847842),c(376.4254498545156,137.95276342877352,492.34900301222257,1034.4864632908507,889.9973990164831,629.3874625806897),c(647.8480110654032,506.431855218787,357.58473469161424,486.1348211794925,379.7545292795896,1134.6579570160964),c(1693.9145243453202,1410.385489265224,1131.7135714651088,1380.3698067764765,3959.8192546466457,1674.2586766831773),c(1832.5975848180365,1560.1368443030374,1435.6988812564812,934.3068363666601,3638.617185828667,1521.0930564187856),c(629.0267385726773,461.96024069240605,228.18040886103006,213.01352251248912,158.92810696722913,588.8954020510229),c(1755.3313082689517,1923.1704322734938,1236.6153030555824,1317.0984634559352,613.9643711260326,1613.520585888677),c(983.6591360671947,1463.0253595209401,1484.7040697367024,318.465761380058,543.7014185720997,876.7411366858279),c(971.7720165981048,596.282668241475,869.0763894539232,2007.8106280385114,1830.1826212857754,1149.6224141683647),c(2314.02592331618,1892.3125772960052,1884.4026382785066,2989.5709718955773,1438.7175999138638,2374.06711409807),c(3078.7639424943013,2850.7212495380104,3707.548790956737,4787.531644587627,1380.165139452253,1804.537480126453),c(1760.284274714406,2105.5948102286484,2400.4885294608366,1952.9754638273755,1321.6126789906423,1198.9170965523067),c(485.39071165450696,727.8823438807655,344.56773150155544,478.7531644587627,163.94688929251004,676.0413584083492),c(825.1642098126619,801.396645444783,625.581859192824,345.8833434856259,557.0848381061821,1194.515785625169),c(635.9608915963132,266.8296871582856,144.71844723065328,238.32205984070563,68.59002511217257,160.2077177478119),c(2110.9542990525597,1180.76674487391,970.1495906943795,1497.421791919478,945.2040045945732,2217.3804450919683),c(977.7155763326498,1319.6270922726098,1348.408389276087,2135.4078370682696,1217.8911776015032,2781.62850595102),c(411.09621497269467,647.1073705573389,415.7783960118769,133.92434336181248,117.10492092322146,488.5455129122836),c(1651.3190129144145,2282.5736843642458,2271.8499097002555,2144.898538566351,1619.3937636239768,1654.0126464183438),c(1047.0571065690078,1053.7049890842504,1741.2156031878603,804.6005825595505,7436.162478624563,1628.4850430409454),c(1109.4644837817302,1234.3141990995525,881.3276865739786,815.1458064463073,1693.0025710614302,1608.2390127761118),c(1290.7430556853521,1343.2242754906895,761.8775396534393,849.9450452726051,6250.056922416506,918.1134594009221),c(1580.9868893889657,3055.8352267413184,3546.750516256011,4597.717614626003,3867.8082453498287,3878.4351889937325),c(692.4247090744906,1130.8496265279723,3744.3026823169025,7621.033302959202,7227.046548404524,2914.548095950578),c(4423.98962907965,4101.371960096234,5507.723761534863,7611.542601461121,3941.4170527872825,2360.8631813166567),c(1000.4992219817389,660.721130106231,428.0296931319322,249.9218061161382,562.103620431463,731.4978760902841),c(2475.4926294379857,2563.92471504135,2075.0634497093674,996.5236572985258,5385.153435026427,1428.6655269488942),c(3124.3312337924795,1569.2126840022988,1893.591111118548,1644.0004039453986,2974.464991449825,1069.5185552944586),c(1161.9659281035442,1703.5351115513677,3375.2323565752367,1790.5790159713194,1912.1560659320305,1710.3494262857064))
targetgene="Ptprd"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1067.8595656399154,1413.1082411750024,6353.0632628186795,2317.840210309164,3854.4248258157463,753.5044307259725),c(814.2676836326627,705.192744632612,419.6069263618942,395.44589575338324,351.3147627696644,922.5147703280599),c(773.6533587799387,1300.567828904161,913.4873415141237,1272.8085231315563,4133.803708589718,2348.5395107206714),c(1773.1619874725866,1742.5612222581917,805.5227856436363,4832.876107300682,3452.9222397932726,740.3004979445594),c(856.8631950635685,796.8587255951522,398.9328624718009,342.71977631959885,271.0142455651697,1135.538219201524),c(2279.355158198001,2502.209005086372,1876.7455775784722,2527.6901656556256,1115.8426036541246,3215.5977633667962),c(1077.7654985308236,439.27064144425253,254.21441524114758,164.50549263340744,200.75129301123678,723.5755164214362),c(2960.8833410924926,1698.997191701737,883.6248047839889,161.34192546738038,3941.4170527872825,1414.5813319820536),c(1110.455077070821,659.8135461363049,255.7458273811545,241.48562700673273,167.29274417603065,584.4940911238853),c(3993.081548325138,3622.167623975231,6611.106208409844,7432.273795386254,13083.965522007358,4757.817112235843),c(295.1968001490675,856.7592676102776,1035.2346066446732,1982.5020907102949,3016.288177493833,1926.013661715453),c(344.72646460360903,692.486569053646,451.7665813020394,669.6217168090624,317.85621393445825,331.85884390618185),c(681.5281828944915,1714.4261191904814,996.183597074497,568.3875674961962,2487.643105897576,793.1162290702117),c(1144.1352488999094,909.3991378659938,922.6758143541651,1765.270478643103,1390.2027041028148,2099.425312244678),c(682.5187761835823,1013.7712944075001,627.8789774028344,956.4518065288496,391.46502137191175,1119.6934998638283),c(1901.9391150543947,1853.286466589181,1653.9251112074662,1551.2024337419382,2496.0077431063773,1591.5140312529886),c(1698.8674907907744,764.1857026778112,782.5516035435327,572.6056570508989,1154.3199348146115,826.5661921164582),c(1328.3856006708038,993.804447069125,1643.9709322974213,1701.9991353225616,1022.1586669155473,1965.6254600596924),c(901.4398930726558,1439.4281763028605,791.7400763835741,1696.7265233791832,844.8283580889548,845.0516980104364),c(296.1873934381583,730.6050957905439,457.1265237920636,494.571000288898,511.9157971786538,817.7635702621828),c(1143.1446556108185,786.8753019259647,422.669750641908,310.0295822706525,239.22862417172385,529.0375734419504),c(937.1012514799257,1680.845512303214,1929.5792964087107,1675.6360756056692,5060.605511324928,1340.6393084061403),c(628.0361452835866,618.9722674896285,388.97868356175593,312.13862704800385,73.60880743745349,433.0889952303487),c(972.7626098871956,1376.8048823779568,627.1132713328309,405.99111964014014,965.2791338956969,1705.067853173141),c(83.20983628362977,413.85829028632054,199.0835782008987,225.66779117659738,1209.5265403927017,1440.108935359452),c(559.6852083363193,553.6262216549463,377.4930925117041,165.56001502208312,152.2363972001879,529.9178356273778),c(1641.4130800235062,3354.430352847019,2358.374695610646,4670.479659444625,2398.97795148428,2216.5001829065404),c(244.67654240543516,777.7994622267033,349.92767399157964,103.3431940902175,110.41321115618024,1197.1565721814516),c(1002.4804085599205,1319.6270922726098,1672.3020568875493,1002.8507916305799,1197.8160483003796,891.705593838096),c(1442.3038289162494,1345.0394434305417,1473.2184786866505,1999.3744489291057,5930.527781040287,488.5455129122836),c(339.7734981581549,141.58309930847807,258.8086516611683,26.363059716892216,157.25517952546883,787.8346559576465),c(982.6685427781039,974.745183700676,715.9351754532319,1302.3351500144756,2864.0517802936447,647.8729684746679),c(1176.8248274399066,796.8587255951522,789.4429581735637,728.6749705749008,1129.226023188207,1751.7217490008006),c(1210.5049992689949,1346.854611370394,1050.5487280447423,1321.316553010638,1917.1748482573114,566.0085852299069),c(1342.2539067180753,1612.7767145587536,1163.873226405254,1052.4133438983374,3073.1677105136832,1254.3736142342416),c(485.39071165450696,467.4057445119629,240.43170598108537,280.5029553877332,460.0550464840843,695.407126487755),c(329.86756526724656,853.1289317305731,975.5095331844037,1990.9382698197003,4357.975985785599,2018.4411911853447),c(281.32849410179585,458.3299048127015,278.7170094812582,592.6415824357371,2579.654115194393,1235.8881083402632),c(416.0491814181488,274.99794288762087,162.3296868407328,2022.573941479971,1172.722136673975,1074.800128407024),c(266.46959476543344,656.1832102566003,537.5256611424265,2140.680449011648,772.8924780932616,475.3415801308705),c(1511.6453591526074,979.2831035503067,834.6196163037677,804.6005825595505,1719.7694101295951,824.805667745603),c(888.562180314475,1007.4182066180172,769.5346003534738,1919.2307473897533,1127.5530957464466,726.2163029777188),c(1338.2915335617122,855.8516836403514,761.8775396534393,1171.5743738186902,1040.5608687749107,701.5689617857478),c(1500.7488329726084,1034.6457257158013,890.51615941402,405.99111964014014,2000.8212203453268,1721.7928346962642),c(1034.1793938108272,1553.7837565135544,797.8657249436018,1673.527030828318,674.1897590294036,713.8926323817333),c(864.7879413762951,616.2495155798501,503.06888799227096,344.8288210969502,322.8749962597392,1080.9619637050166),c(1376.9246718362544,1293.3071571447517,653.1472777129485,2089.008851966539,883.3056892494419,841.5306492687263),c(1469.0498477217018,1141.740634167086,1565.8689131570686,2702.7408821757904,8756.102230173445,1116.1724511221182),c(1177.8154207289974,876.7261149486527,883.6248047839889,2560.380359704572,2956.0627895904618,951.5634224471686),c(2258.5526991270935,2853.444001447789,2575.0695134216244,1725.1986278734266,8404.787467403781,1578.3100984715757),c(2832.1062135106845,3302.698066561229,3418.877602565434,1516.4031949156404,900.034963667045,938.3594896657555),c(1590.8928222798738,1888.6822414163005,1343.8141528560664,1455.2408963724504,1744.8633217559998,1490.2838799288218),c(815.2582769217536,1787.9404207544987,1572.7602677870998,1710.435314431967,627.3477906601149,1374.0892714523868),c(809.3147171872085,827.7165805726411,1467.8585361966263,1607.0921203417495,1306.5563320147994,1506.1285992665175),c(1332.3479738271672,1374.0821304681783,980.8694756744279,1119.9027767735813,557.0848381061821,2204.176512310555),c(599.3089398999525,245.0476718800582,248.08876668111992,187.7049851842726,418.2318604400767,408.44165403837764),c(558.6946150472285,612.6191797001455,624.0504470528172,436.57226891173514,381.4274567213499,664.5979499977911),c(985.6403226453764,752.3871110687713,567.3881978725614,506.17074656433056,260.9766809146078,463.8981717203125),c(2017.8385298780217,1772.5114932657543,1775.6723763380157,1159.9746275432576,928.4747301769702,2011.3990937019244),c(557.7040217581376,433.8251376246957,176.87810217079848,293.15722405184147,155.5822520837085,702.4492239711753),c(349.67943104906317,630.7708590986683,535.2285429324162,746.6018511823876,1888.7350817473862,1171.628968804053),c(1344.235093296257,1170.7833212047226,860.6536226838851,3602.248479716153,3578.391797925296,1787.8124986033297),c(1199.6084730889959,1186.212248693467,774.894542843498,868.9264482687674,943.5310771528129,581.8533045676025),c(1496.786459816245,1214.3473517611774,1349.939801416094,1040.8135976229048,1719.7694101295951,1514.9312211207928),c(151.56077323089707,142.49068327840422,82.69625556037332,60.107776154514255,53.53367813632981,200.69977827747866),c(366.5195169636073,653.460458346822,590.359379972665,534.6428510585741,314.51035905093767,1176.9105419166183),c(240.71416924907183,407.50520249683757,377.4930925117041,350.10143304032863,607.2726613589913,737.6597113882768),c(458.64469284905454,648.0149545272651,401.99568675181473,138.14243291651522,189.04080091891464,274.6418018533918),c(1754.3407149798609,1723.5019588897428,3145.5205355741996,5930.633913912074,4900.004476915938,1493.804928670532),c(1862.3153834907614,2129.1919934467282,1249.632306245641,669.6217168090624,916.764238084648,1867.9163574772356),c(3180.795051270657,2357.9031538681156,1814.723385908192,1816.9420756882116,3792.526510470615,2659.272062176592),c(1716.6981699944095,1638.1890657166855,1310.1230857759142,1361.388403780314,4951.865227610508,1741.15860277567),c(2541.862379807071,2758.1476846055443,2346.123398490591,2386.3841655730835,2116.253213826788,2078.2990197944173),c(206.04340413089275,632.5860270385207,350.6933800615831,467.1534181833301,1236.2933794608666,672.520309666639),c(1529.4760383562423,1124.4965387384893,1316.248734335942,1356.1157918369356,1120.8613859794054,1144.3408410557993),c(2344.734315277996,2967.799581658483,2477.059136461182,2995.8981062276316,1411.9507608456988,1654.0126464183438),c(1199.6084730889959,1061.8732448135856,1420.384759856412,2802.920509099981,12436.54260204612,1259.6551873468068),c(852.9008219072051,1326.8877640320188,1972.4588363289042,926.9251796459304,1263.0602185290315,1712.1099506565613),c(1527.4948517780608,1735.3005504987827,2280.272676470294,1967.738777268835,2149.711762661994,1620.5626833720974),c(723.1331010363064,836.7924202719025,1019.1547791746007,2581.470807478086,853.1929952977564,588.0151398655954),c(2530.965853627072,1684.4758481829188,2051.32656153926,1696.7265233791832,2475.932613805254,2094.143739132113),c(1032.1982072326455,628.04810718889,846.870913423823,1668.2544188849395,4095.3263774292304,1477.0799471474088),c(1728.5852894634993,1301.475412874087,986.2294181644521,1762.1069114770758,1698.021353386711,2395.193406548331),c(1896.9861486089405,3644.8572232233846,5340.034132204106,7814.010900086853,10059.312707304724,2418.9604855548746),c(2027.7444627689301,1484.8073747991675,2694.5196603421637,949.0701498081198,982.0084083132999,1820.3821994641485),c(1187.7213536199058,1384.0655541373658,1936.4706510387416,2117.480956460783,776.2383329767823,1453.3128681408652),c(659.7351305344931,1394.9565617764795,862.9507408938956,760.3106422351716,3411.0990537492653,1199.7973587377342),c(429.91748746542044,462.86782466233217,526.8057761623782,1394.0785978292604,2099.523939409185,1442.7497219157347),c(1745.4253753780433,874.9109470088005,679.9469901630695,3119.2772257026872,6059.34319405583,1679.5402497957425),c(526.9956297963219,635.308778948299,295.56254302133425,375.4099703685452,199.0783655694765,372.3509044358486),c(973.7532031762864,920.2901455051075,1131.7135714651088,2586.7434194214643,2206.5912956818443,1130.2566460889589),c(2632.9969624034275,4213.9123723670755,3091.155404603954,2895.718479303441,2193.207876147762,4027.1994983309864),c(457.6540995599637,1286.9540693552688,413.48127780186655,330.0655076554906,314.51035905093767,1116.1724511221182),c(302.1309531727033,876.7261149486527,512.2573608323124,434.4632241343837,336.25841579382165,819.5240946330379),c(899.4587064944741,820.455908813232,1072.7542040748426,1923.4488369444562,4762.824426691593,1837.9874431726994),c(1789.01148009804,1970.3647987096533,1496.9553668567576,1285.4627917956645,4244.216919745898,1183.0723772146112),c(81.2286497054481,402.96728264720684,328.48790403148286,195.0866419050024,250.939116264046,530.7980978128054),c(1946.515813063482,1238.8521189491833,1356.831156046125,1583.8926277908845,2889.1456919200496,1771.0875170802065),c(1113.4268569380936,1214.3473517611774,1339.985622506049,834.1272094424697,722.7046548404525,1835.3466566164168),c(1152.0599952126358,609.8964277903672,434.1553416919599,295.2662688291928,132.16126789906423,572.1704205278996),c(1280.837122794444,2523.0834363946733,1849.1801590583477,1514.294150138289,567.1224027567439,971.809452712002),c(1263.9970368798997,1334.148435791428,935.692817544224,1968.7932996575107,2820.555666807877,896.9871669506612),c(867.7597212435676,1097.2690196407052,875.2020380139509,447.11749279849204,369.71696462902776,1144.3408410557993),c(1030.2170206544638,1418.5537449945593,1297.1060825858553,684.3850302505219,1452.101019447946,1444.5102462865898),c(1084.6996515544595,1978.5330544389885,3111.8294684940474,1274.9175679089076,2127.96370591911,834.488551785306),c(3112.4441143233894,3122.088856545927,4198.366381828952,3812.0984350626145,1779.9947980329662,2047.4898433044534),c(2653.799421474335,1986.7013101683237,1883.6369322085031,2157.552807230459,2659.9546323988875,871.4595635732626),c(984.6497293562855,1422.1840808742638,1395.1164595462978,1013.3960155173369,2997.8859756344696,1514.0509589353653),c(1629.5259605544163,2488.59524553748,2246.5816093901417,2915.7544046882795,7536.5381251301815,1647.8508111203512),c(887.5715870253841,666.1666339257879,1997.7271366390182,1839.0870458504012,3740.6657597760454,1759.6441086696484),c(4883.624915217794,3906.2414065621133,7082.781147531973,1825.378254797617,7912.94679952625,1596.7956043655538),c(572.5629210945001,118.89350006032454,1085.005501194898,139.1969553051909,112.08613859794055,322.1759598664789),c(1001.4898152708297,2486.780077597628,2224.3761333600414,489.2983883455196,520.2804343874553,1866.1558331063804),c(2305.1105837143627,4713.991139796379,7319.384323163042,10798.309260039052,8081.912471144041,3816.8168360138047),c(808.3241238981177,878.5412828885051,1529.8807278669062,1415.1690456027743,868.2493422735992,1361.7656008564013),c(1763.2560545816784,1646.3573214460207,2612.589110851794,3245.81991234377,1125.8801683046863,1896.0847474109169),c(1596.8363820144189,1050.982237174472,1035.2346066446732,1446.804717263045,2014.2046398794091,2080.059544165272))
targetgene="Crebbp"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(2314.02592331618,1949.490367401352,1762.655373147957,719.1842690768196,1301.5375496895185,2606.4563310509398),c(886.5809937362933,504.6166872789347,852.2308559138472,384.9006718666264,229.191059521162,907.5503131757916),c(791.4840379835736,1034.6457257158013,546.714133982468,298.4298359952199,254.2849711475666,1007.900202314531),c(951.9601508162882,1011.9561264676478,1140.9020443051504,576.8237466056017,868.2493422735992,306.3312405287832),c(1764.2466478707693,609.8964277903672,442.5781084619979,526.2066719491687,1109.1508938870834,1548.3811841670392),c(4001.006294637865,2404.189936334349,5237.429518823643,4412.121674219082,4018.3717151082565,1434.8273622468869),c(945.0259977926523,448.3464811435139,761.8775396534393,468.2079405720058,3620.2149839693034,918.1134594009221),c(2767.7176497197806,1767.0659894461976,3137.863474874165,2161.7708967851618,729.3963646074936,1234.1275839694083),c(2958.902154514311,2484.0573256878492,3947.214790867819,4457.466136932137,8645.689019017265,2792.1916521761505),c(1139.1822824544552,971.1148478209715,970.9152967643829,1163.1381947092846,416.5589329983163,997.3370560894006),c(105.99348193271886,224.17324057175696,137.06138653061873,221.44970162189463,95.35686418033748,35.21048741710152),c(1735.5194424871352,1809.7224360327261,1149.3248110751883,1293.89897090507,456.7091916005637,456.8560742368922),c(2896.4947773015883,3174.728726801643,3892.8496598975735,3037.0244793859833,4061.8678285940246,1738.5178162193874),c(5942.569141255893,3771.0113950431182,5450.295806284604,4600.88118179203,2810.5181021573153,2592.3721360840996),c(5324.438928863215,3003.1953564856026,3302.4902799249085,3919.659718707535,1609.3561989734148,1485.0023068162566),c(1614.6670612180537,2190.9077034017055,2164.6510598997716,1135.7206126037167,4389.761607179044,1262.2959739030894),c(4116.905709461492,2989.5815969367104,3724.3943244968127,3738.2818678553162,1795.051145008809,2661.912848732875),c(3008.4318189688524,2562.1095471014974,1515.3323125368406,1100.921373777419,1487.2324957249125,2015.800404629062),c(2975.742240428855,4050.54725778037,4003.8770400480744,5194.5772866164425,3436.1929653756697,2110.8687206552363),c(8402.212278068424,6490.132968941838,9006.234795380657,4856.075599851546,21821.66555032144,4499.020029720146),c(1924.7227607034838,1598.2553710399352,2234.3303122700863,801.4370153935234,1236.2933794608666,1248.211778936249),c(784.5498849599378,923.012897414886,1336.1570921560317,1915.0126578350507,766.2007683262204,1826.5440347621413),c(1918.7792009689388,2178.2015278227395,1947.9562420887935,2065.809359415674,1137.5906603970086,1859.1137356229601),c(2477.4738160161673,2340.659058439519,2763.433206642475,3667.6288678140454,3588.429362575858,2424.24205866744),c(2705.310272507058,1493.883214498429,2794.061449442613,3399.7801810904202,1079.0381999353979,1406.6589723132056),c(1073.8031253744603,929.3659852043689,441.046696321991,185.59594040692122,451.6904092752828,1788.6927607887571),c(1175.834234150816,399.3369467675023,133.9985622506049,199.30473145970515,317.85621393445825,712.1321080108783),c(1731.5570693307718,2030.2653407247785,2220.547603010024,1569.1293143494247,3330.7985365447703,1289.5841016513432),c(950.9695575271974,536.3821262263497,1275.6663126257586,2272.495747596109,4342.919638809756,1589.7535068821335),c(3452.2176124815446,3143.870871824154,4934.209915102274,3761.4813604061815,8150.502496256214,2463.853857011679),c(735.0202205053963,741.4961034296576,474.73776340214306,260.4670300028951,179.0032362683528,442.7718792700516),c(618.1302123926782,252.30834363946735,637.0674502428759,571.5511346622233,3312.396334685407,716.5334189380159),c(971.7720165981048,1529.2789893255485,1582.7144466971447,1504.8034486402078,2245.0686268423315,1333.59721092272),c(1770.1902076053143,1078.209756272256,927.270050774186,1282.2992246296374,5664.532317800398,967.4081417848643),c(247.64832227270765,558.1641415045771,465.5492905621016,213.01352251248912,172.3115265013116,828.3267164873132),c(399.2090955036047,467.4057445119629,203.67781462091946,378.57353753457227,408.1942957895148,639.9506088058201),c(952.950744105379,1031.922973806023,418.84122029189075,209.84995534646205,210.78885766179863,1148.742151982937),c(113.91822824544552,892.1550424373971,349.92767399157964,179.2688060748671,844.8283580889548,741.180760129987),c(1017.339307896283,1208.9018479416206,1356.0654499761215,3401.889225867772,2688.394398908813,1723.5533590671193),c(1041.113546834463,1056.4277409940287,712.1066451032146,295.2662688291928,1868.6599524462624,389.0758859589718),c(2088.1706534034706,1138.1102982873815,667.6956930430141,950.1246721967955,1258.0414362037507,1790.4532851596123),c(2709.2726456634214,3355.3379368169453,2626.371820111856,3430.3613303620155,2049.3361161563757,1577.429836286148),c(567.6099546490459,586.2992445722874,208.2720510409402,39.01732838100048,63.57124278689165,587.1348776801678),c(887.5715870253841,606.2660919106626,621.7533288428067,994.4146125211745,393.13794881367204,1749.080962444518),c(928.1859118781082,1616.407050438458,3369.8724140852123,2766.0122254963317,4791.2641932015185,1231.4867974131257),c(1394.7553510398893,1398.5868976561842,1186.8444085053577,1780.0337920845625,2546.1955663591866,2299.2448283367294),c(1650.3284196253237,1828.7816994011753,2561.2868041615625,2473.9095238331656,955.2415692451351,2889.900754758607),c(895.4963333381108,1239.7597029191093,1402.7735202463325,769.8013437332528,2566.27069566031,702.4492239711753),c(739.9731869508504,2108.3175621384266,1728.1985999978015,2084.7907624118366,2111.234431501507,1184.832901585466),c(1436.3602691817043,1911.371840664454,1169.9988749652816,285.77556733111163,535.3367813632981,904.909526619509),c(2771.680022876144,2139.1754171159155,1716.7130089477496,1398.2966873839632,573.8141125237852,1759.6441086696484),c(246.6577289836168,383.9080192787579,358.3504407616177,428.1360898023296,930.1476576187305,307.2115027142108),c(511.14613717086854,430.1948017449911,562.7939614525405,489.2983883455196,453.36333671704307,1464.7562765514233),c(446.7575733799646,875.8185309787266,549.7769582624818,631.6589108167375,158.92810696722913,204.22082701918882),c(1637.4507068671428,2159.142264454291,1679.9591175875837,4014.566733688347,4600.550464840843,1920.7320886028879),c(933.1388783235624,1642.7269855663162,2211.3591301699826,3952.3499127564814,2795.461755181472,1145.221103241227),c(494.30605125632445,501.8939353691563,359.8818529016246,85.41631348273079,55.20660557809012,186.61558331063804),c(771.672172201757,553.6262216549463,362.17897111163495,188.75950757294828,80.30051720449472,238.5510522508628),c(1276.8747496380806,793.2283897154477,924.2072264941721,1205.3190902563122,2209.937150565365,858.2556307918495),c(523.0332566399585,267.7372711282118,264.1685941511925,228.83135834262444,167.29274417603065,1099.447469598995),c(805.3523440308452,439.27064144425253,153.14121400069132,32.69019404894635,194.05958324419558,1010.5409888708136),c(919.2705722762907,884.894370677988,819.3054949036986,714.9661795221169,689.2461060052464,837.1293383415887),c(2056.4716681525642,1669.9545046641003,817.0083766936882,1445.7501948743693,814.7156641372693,1274.619644499075),c(728.0860674817604,648.9225384971912,800.9285492236156,1413.0600008254228,2325.369144046826,762.3070525802478),c(2232.797273610732,1698.997191701737,3024.5389765136533,4191.726494985863,8990.312072019888,1754.3625355570832),c(1196.6366932217234,1591.9022832504522,1251.163718385648,720.2387914654954,4202.393733701891,1110.890878009553),c(804.3617507417545,451.9768170232185,516.0858911823298,429.1906121910053,230.86398696292233,1264.0564982739445),c(789.502851405392,815.0104049936751,679.181284093066,719.1842690768196,782.9300427438235,1694.5047069480106),c(849.9290420399326,936.626656963778,657.7415141329692,1261.2087768561237,3355.892448171175,1477.9602093328363),c(853.891415196296,991.9892791292727,810.8827281336605,1027.104806570121,1642.8147478086212,761.4267903948204),c(812.2864970544811,726.9747599108393,280.2484216212651,189.81402996162396,351.3147627696644,477.9823666871531),c(911.3458259635642,673.427305685197,395.87003819178705,627.4408212620348,396.4838036971927,1471.7983740348434),c(2572.570771768887,1748.0067260777487,1085.7712072649015,781.4010900086853,1475.5220036325904,1501.7272883393798),c(1149.0882153453636,1236.1293670394048,876.7334501539577,842.5633885518753,7247.121677705648,1829.184821318424),c(1015.3581213181013,826.808996602715,1137.8392200251365,1041.8681200115805,1845.238968261618,739.4202357591319),c(1832.5975848180365,1274.2478937763028,993.8864788644867,1132.5570454376896,2708.4695282099365,1602.0771774781192),c(1352.1598396089837,2247.1779095371267,2703.708133182205,1167.3562842639874,1365.1087924764101,1640.8087136369309),c(381.3784162999698,114.35558021069383,1504.6124275567922,314.2476718253552,354.660617653185,398.7587699986747),c(1670.1402854071403,1813.3527719124309,3214.434081874511,1977.2294787669164,1110.8238213288437,2340.6171510518234),c(1293.7148355526247,1781.5873329650158,1029.1089580846456,242.5401493954084,1462.138584098508,896.9871669506612),c(140.66424705089793,249.58559172968893,437.9838720419772,104.39771647889319,81.97344464625502,769.3491500636682))
targetgene="Epha3"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(127.78653429271714,156.10444282729634,68.14784023030764,31.63567166027066,66.91709767041226,216.54449761517435),c(367.51011025269815,354.86533224112134,144.71844723065328,34.799238826297724,138.85297766610546,1198.0368343668792),c(688.4623359181272,650.7377064370435,411.1841595918562,526.2066719491687,224.1722771958811,1632.8863539680829),c(869.7409078217493,842.2379240914594,335.379258661514,279.4484329990575,284.39766509925215,545.7625549650735),c(1099.5585508908218,1484.8073747991675,1199.095705625413,592.6415824357371,1492.2512780501936,902.2687400632265),c(1825.6634317944008,1987.60889413825,1857.6029258283857,1173.6834185960415,2904.202038895892,2159.283140853751),c(792.4746312726644,729.6975118206178,522.2115397423574,1094.5942394453648,699.2836706558081,1474.4391605911262),c(867.7597212435676,831.3469164523457,468.61211484211543,240.43110461805702,463.40090136760494,345.06277668759486),c(871.7220943999309,746.9416072492145,357.58473469161424,39.01732838100048,132.16126789906423,719.1742054942986),c(1306.5925483108056,1359.5607869493601,1359.893980326139,682.2759854731706,448.3445543917622,1410.1800210549159),c(1561.175023607149,2232.6565660183082,2516.875852101362,2104.826687796675,1520.6910445601186,1911.9294667486124),c(3652.3174568778923,3912.594494351596,4572.796650060643,4459.575181709488,1507.3076250260362,2583.569514229824),c(210.00577728725608,338.5288207824508,291.734012671317,184.54141801824554,187.36787347715435,903.1490022486539),c(860.8255682199317,721.5292560912825,451.7665813020394,87.52535826008216,1007.1023199397046,501.74944569369666),c(1556.2220571616947,1198.918424272433,645.490217012914,632.7134332054133,359.67939997846594,1292.2248882076258),c(1528.4854450671514,1475.731535099906,1602.6228045172347,3807.880345507912,2136.3283431279115,2668.954946216295),c(1324.4232275144404,1349.5773632801724,624.8161531228205,414.4272987495457,1793.3782175670488,898.7476913215163),c(1364.0469590780738,1694.4592718521062,2201.4049512599377,1727.3076726507782,3611.850346760502,2587.090562971534),c(1489.8523067926092,1417.646161024633,1134.0106896751192,1009.177925962634,988.7001180803412,1272.85912012822),c(395.2467223472414,368.47909179001346,666.9299869730107,602.1322839338183,378.0816018378293,933.0779165531902),c(1183.7589804635425,382.0928513389056,604.9077953027307,1084.049015558608,416.5589329983163,314.25360019763104),c(760.7756460217579,775.984294286851,352.9904982715935,127.59720902975833,212.46178510355895,248.2339362905657),c(2454.6901703670783,2382.4079210561217,2022.2297308791287,2483.400225331247,2843.976650992521,2209.4580854231203),c(1182.7683871744516,481.92708803078114,335.379258661514,396.50041814205895,667.4980492623623,508.791543177117),c(1210.5049992689949,1258.8189662875584,458.6579359320705,805.6551049482262,210.78885766179863,345.94303887302243),c(1440.3226423380677,819.5483248433059,766.4717760734601,697.0392989146302,3076.513565397204,624.1058894681245),c(537.892155976321,832.2545004222718,777.1916610535085,473.4805525153842,399.82965858071327,417.244275892653),c(563.6475814926825,100.74182066180171,75.03919486033874,377.51901514589656,88.66515441329625,171.65112615836992),c(227.83645649089104,463.77540863225835,397.40145033179397,226.72231356527308,344.6230530026232,731.4978760902841),c(656.7633506672206,748.7567751890667,546.714133982468,347.9923882629773,1196.143120858619,774.6307231762335),c(12.877712758180797,497.35601551952556,171.51815968077426,5.272611943378443,66.91709767041226,180.4537480126453),c(1674.1026585635036,1435.797840423156,807.8199038536467,682.2759854731706,1609.3561989734148,952.443684632596),c(924.223538721745,658.9059621663788,460.9550541420809,1586.0016725682358,2146.3659077784732,1481.4812580745465),c(1873.2119096707606,989.2665272194943,897.4075140440511,1323.4255977879893,3002.9047579597504,1109.130353638698),c(2548.796532830707,2133.729913296359,1147.0276928651779,827.8000751104156,2126.2907784773497,2398.714455290041),c(1052.010073014462,919.3825615351814,539.0570732824334,282.61200016508457,1500.615915258995,1318.632753770452),c(1334.3291604053488,1860.5471383485901,1957.1447149288351,3035.9699569973077,2618.1314463548797,1848.5505893978298),c(1422.4919631344326,1031.0153898360968,616.3933863527825,401.77303008543737,843.1554306471945,1440.9891975448797),c(2242.7032065016406,1215.2549357311036,1178.4216417353198,942.7430154760657,913.4183832011274,854.7345820501394),c(2748.896377227055,1907.7415047847496,1380.5680442162322,1599.7104636210197,2840.6307961090006,1208.5999805920096),c(395.2467223472414,519.138030797753,257.2772395211614,133.92434336181248,312.8374316091773,1290.4643638367706),c(1101.5397374690035,1094.5462677309267,455.5951116520567,557.8423436094394,627.3477906601149,940.1200140366105),c(1576.0339229435115,2749.9794288762087,1408.8991688063602,570.4966122735476,1012.1211022649856,1838.8677053581268),c(872.7126876890217,481.92708803078114,332.31643438150013,179.2688060748671,207.44300277827801,449.81397675347193),c(1408.623657087161,1319.6270922726098,1139.3706321651434,595.8051496017641,2275.181320794017,331.85884390618185),c(3220.41878283429,2768.1311082747316,2917.3401267131694,3306.98221088696,906.7266734340861,2309.8079745618597),c(1727.5946961744085,2210.874550740081,3676.9205481565987,3041.2425689406864,1075.692345051877,1443.6299841011623),c(777.615731936302,725.1595919709871,970.1495906943795,789.8372691180908,1072.3464901683565,653.1545415872332),c(1974.2524251580253,2337.0287225598145,1862.1971622484064,605.2958510998453,707.6483078646097,1653.1323842329164),c(2125.8131983889225,3298.1601467115984,4536.042758700477,6757.3794666338135,5385.153435026427,3247.287202042188),c(2096.0953997161973,1628.205642047498,2093.4403953894503,3401.889225867772,4090.3075951039496,2544.8379780710125),c(1184.7495737526333,913.0294737456984,474.73776340214306,398.6094629194103,209.11593022003834,576.5717314550374),c(807.3335306090269,632.5860270385207,294.79683695133076,83.30726870537941,1084.0569822606788,834.488551785306),c(1173.8530475726343,1756.174981807084,1127.8850411150916,791.9463138954422,1662.8898771097447,1663.6955304580467),c(450.7199465363279,694.3017369934983,648.5530412929277,1148.374881267825,970.2979162209779,1851.1913759541123),c(666.669283558129,1071.856668482773,534.4628368624127,830.9636422764427,3133.3930984170543,913.7121484737844),c(948.9883709490157,1324.1650121222406,799.3971370836086,619.0046421526292,301.1269395168552,759.6662660239652),c(935.1200649017441,1116.3282830091541,1045.1887855547182,649.5857914242242,5052.240874116126,719.1742054942986),c(1104.511517336276,584.4840766324352,852.9965619838506,466.0988957946544,137.18005022434514,634.6690356932548))
targetgene="Kdm6a"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1318.4796677798954,1942.229695641943,4841.559480631856,598.9687167677912,1127.5530957464466,933.0779165531902),c(698.3682688090355,516.4152788879745,2424.2254176309434,291.0481792744901,1502.2888427007554,1076.5606527778789),c(385.3407894563331,141.58309930847807,1209.8155906054615,97.01605975816337,122.12370324850238,286.9654724493774),c(500.2496109908694,481.92708803078114,2427.2882419109574,169.7781045767859,76.95466232097411,218.30502198602943),c(235.76120280361766,318.5619734440757,1700.633181477677,125.48816425240696,113.75906603970085,986.7739098642701),c(454.68231969269124,554.5338056248725,1211.3470027454682,950.1246721967955,1003.756465056184,513.1928541042546),c(3947.51425702696,2932.4038068313635,3047.510158613757,2670.050688126844,5273.067296428487,1836.2269188018442),c(1276.8747496380806,452.88440099314465,3509.996624895845,475.5895972927356,4361.321840669119,430.44820867406605),c(975.7343897544681,1216.1625197010296,4518.431519090397,813.036761668956,2311.9857245127437,846.8122223812916),c(805.3523440308452,769.631206497368,1843.05451049832,436.57226891173514,429.9423525323988,955.9647333743062),c(577.5158875399542,964.7617600314885,1014.56054275458,392.2823285873562,276.03302789045057,606.5006457595737),c(1547.3067175598774,2127.376825506876,3394.375008325323,776.1284780653069,901.7078911088053,1029.026494764792),c(1038.1417669671905,1285.1389014154165,3461.7571424856274,975.4332095250121,829.7720111131121,1418.1023807237636),c(4199.124952456031,3201.9562458994274,8356.916048017725,5019.526570096278,5925.508998715006,3723.509044358486),c(719.170727879943,474.66641627137204,2868.3349382329484,760.3106422351716,242.57447905524447,738.5399735737044),c(2714.225612108876,1914.0945925742326,4039.865225338237,1466.840642647883,6037.5951373129465,719.1742054942986),c(1550.27849742715,2144.6209209354724,11939.654749563899,1802.178762246752,2223.3205700994477,1230.606535227698),c(2452.7089837888966,2157.3270965144384,4415.06119963993,1768.4340458091299,707.6483078646097,1456.8339168825753),c(1346.2162798744387,1879.606401717039,2156.993999199737,1620.8009113945336,854.8659227395167,1235.8881083402632),c(895.4963333381108,766.0008706176635,1610.2798652172692,2274.6047923734604,747.7985664668571,582.7335667530301),c(631.007925150859,431.1023857149172,841.5109709337988,1305.4987171805026,635.7124278689165,772.8701988053783),c(1671.130878696231,1278.7858136259335,3742.771270176896,4194.89006215189,460.0550464840843,753.5044307259725),c(137.69246718362544,29.95027100756267,124.81008941056342,5.272611943378443,13.383419534082453,19.365768079405836),c(774.6439520690295,803.2118133846353,1990.0700759389836,1954.0299862160512,1340.0148808500055,2143.438421516055),c(1890.0519955853047,1636.3738977768332,3343.0727016350916,1936.1031056085644,1306.5563320147994,2198.89493919799),c(1094.6055844453679,2063.845947612046,3556.704695166056,3513.6685990673946,1443.7363822391446,798.3978021827769))
targetgene="Phox2b"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(434.87045391087463,1610.9615466189011,1428.0418205564465,1355.06126944826,1587.608142230531,1741.15860277567),c(1058.944226038098,261.38418333872875,160.03256863072244,194.03211951632673,143.87175999138637,773.7504609908059),c(599.3089398999525,856.7592676102776,343.802025431552,59.05325376583857,80.30051720449472,365.30880695242826),c(1089.6526179999137,1681.7530962731403,4505.414515900338,1868.6136727333203,3697.169646290278,2382.8697359523453),c(3704.8189011997065,2580.2612265000203,6892.120336101113,5715.511346622233,7886.179960458086,3431.261998796543),c(2178.3146427107363,1994.8695658976592,2066.6406829393295,3891.1876142132915,9947.226568706783,1766.6862061530687),c(1122.3421965399111,367.57150782008733,2502.327436771296,488.2438659568439,189.04080091891464,521.99547595853),c(1401.6895040635252,1471.1936152502753,6117.991499327618,1328.6982097313678,4028.4092797588182,443.6521414554791),c(453.6917264036004,188.77746574463745,626.3475652628275,259.4125076142194,172.3115265013116,581.8533045676025),c(791.4840379835736,608.0812598505148,911.9559293741167,542.024507779304,1077.3652724936373,710.3715836400231),c(1643.3942666016878,1676.3075924535835,5377.553729634275,2347.366837192083,1709.7318454790334,2198.89493919799),c(2979.7046135852183,2484.0573256878492,5620.282553825371,4896.147450621223,5442.032968046277,2357.342132574947),c(2716.2067986870575,2151.8815926948814,6640.203039069976,2795.538852379251,1266.4060734125521,1330.9564243664374),c(2047.5563285507467,2650.145192184333,5533.757767914981,3332.2907482151763,2812.1910295990756,1102.0882561552776),c(748.8885265526679,874.0033630388743,4944.929800082323,410.2092091948429,145.54468743314666,966.5278795994367),c(2329.8754159416335,1389.5110579569227,6036.060949837249,840.4543437745239,431.6152799741591,1270.2183335719374),c(831.1077695472069,274.09035891769474,1830.0375073082612,699.1483436919816,428.2694250906385,945.4015871491758),c(722.1425077472155,1139.0178822573077,2415.8026508609055,3136.149583921498,2685.048544025292,1565.9864278755902),c(1854.3906371780347,1435.797840423156,1439.5274116064984,1191.6102992035283,1038.8879413331504,1793.9743339013223),c(158.49492625453288,452.88440099314465,964.0239421343518,1128.338955882987,806.3510269284678,596.8177617198708),c(1050.0288864362803,1017.4016302872046,1086.536913334905,397.55494053073465,448.3445543917622,896.1069047652337),c(1599.8081618816914,1168.0605692949441,3995.4542732780365,3201.5299720193907,3762.4138165189297,2195.3738904562797),c(1194.6555066435417,1532.001741235327,1607.982747007259,2226.0967624943787,4347.938421135037,1741.15860277567),c(210.00577728725608,795.9511416252261,1680.7248236575872,1112.5211200528515,558.7577655479424,1672.4981523123222),c(479.447151919962,1611.8691305888274,1952.5504785088142,4036.711703850536,7489.696156760892,2682.158878997708),c(312.03688606361163,526.3987025571621,3513.8251552458623,548.3516421113582,220.82642231236048,625.8664138389795),c(409.11502839451305,397.52177882765,2826.986810452762,258.35798522554376,100.37564650561839,381.1535262901239),c(734.0296272163055,971.1148478209715,860.6536226838851,1096.7032842227163,277.7059553322109,836.2490761561611),c(2209.023034672552,1468.470863340497,1221.3011816555133,306.86601510462543,5343.330248982419,956.8449955597338),c(1668.1590988289586,1467.5632793705709,5213.692630653536,5507.7704360531225,1890.4080091891465,946.2818493346033),c(1865.287163358034,1620.9449702880888,2037.543852279198,3524.2138229541515,476.7843209016874,433.0889952303487),c(2634.978148981609,2237.194485867939,3054.4015132437885,2980.0802703974964,2464.2221217129318,1773.728303636489),c(1120.3610099617295,1344.1318594606157,1061.2686130247907,1019.723149849391,301.1269395168552,1102.0882561552776),c(504.2119841472327,192.407801624342,122.51297120055305,567.3330451075205,125.469558132023,401.3995565549573),c(652.8009775108574,608.0812598505148,680.7126962330728,628.4953436507104,679.2085413546845,526.3967868856677),c(3198.6257304742917,1802.4617642733172,2175.37094487982,1882.3224637861044,635.7124278689165,1692.7441825771555),c(1471.0310342998835,844.0530920313116,521.445833672354,927.979702034606,3693.823791406757,860.0161551627046),c(3510.6626165379034,2559.386795191719,1552.0862038970065,1362.4429261689897,1870.3328798880227,2085.3411172778374),c(791.4840379835736,902.1384661065847,591.1250860426685,296.32079121786853,441.65284462472096,912.8318862883569),c(1124.3233831180926,628.9556911588161,281.779833761272,126.54268664108264,376.408674396069,1218.2828646317125),c(747.8979332635771,126.15417181973368,69.67925237031454,90.68892542610922,115.43199348146116,638.190084434965),c(277.36612094543256,234.1566642409445,95.71325875043208,29.526626882919285,95.35686418033748,945.4015871491758),c(1154.0411817908175,1237.944534979257,874.4363319439474,3122.440792868714,1256.3685087619904,1148.742151982937),c(699.3588620981263,443.8085612938832,429.56110527193914,61.16229854318995,102.0485739473787,388.19562377354424),c(299.15917330543084,906.6763859562154,514.5544790423228,295.2662688291928,172.3115265013116,620.5848407264143),c(1961.3747123998444,1885.9594895065222,1453.3101208665605,2208.169881886892,1771.6301608241647,1132.0171704598138),c(1216.44855900354,1342.3166915207632,1266.4778397857172,2313.622120754461,4612.260956933165,2434.80520489257),c(2462.6149166798045,2016.6515811758866,1319.3115586159556,834.1272094424697,794.6405348361457,1238.528894896546),c(3873.2197603451473,3363.5061925462805,4019.956867518147,2507.654240270788,9681.231105466893,2540.4366671438747),c(2295.2046508234544,1615.4994664685319,1591.9029195371863,4412.121674219082,895.0161813417641,1081.842225890444),c(935.1200649017441,1159.892313565609,552.0740764724922,142.36052247121796,620.6560808930737,1089.764585559292),c(348.68883775997233,174.25612222581918,75.03919486033874,5.272611943378443,11.710492092322147,14.084194966840608),c(626.0549587054049,1124.4965387384893,1132.4792775351123,615.8410749866022,426.5964976488782,1490.2838799288218),c(1501.739426261699,547.2731338654634,621.7533288428067,412.31825397219427,284.39766509925215,1382.0116311212346),c(2619.128656356156,1157.1695616558304,964.7896482043553,719.1842690768196,388.11916648839116,793.9964912556393),c(616.1490258144966,494.63326360974713,294.03113088132733,132.86982097313677,127.1424855737833,367.94959350871085),c(813.2770903435719,999.2499508886818,1028.3432520146423,327.9564628781392,918.4371655264083,568.6493717861896),c(1045.0759199908262,460.14507275255374,425.73257492192187,949.0701498081198,652.4417022865196,1743.7993893319526),c(1029.226427365373,874.0033630388743,333.0821404515036,126.54268664108264,125.469558132023,634.6690356932548),c(1660.234352516232,1253.3734624680014,498.47465157225025,523.0431047831416,249.2661888222857,1327.4353756247274),c(2209.023034672552,1666.3241687843959,1424.2132902064293,1470.0042098139102,473.43846601816676,1095.0461586718573),c(266.46959476543344,881.2640347982834,851.4651498438437,1273.863045520232,1058.9630706342741,1960.343886947127),c(376.4254498545156,1264.2644701071151,784.0830156835395,1635.5642248359932,848.1742129724754,1240.289419267401),c(2426.953558272535,2147.3436728452507,1762.655373147957,2921.0270166316577,3001.23183051799,2791.311389990723),c(2016.847936588931,1490.2528786187245,634.0046259628621,526.2066719491687,1460.4656566567476,1644.329762378641),c(753.841492998122,1133.5723784377508,1008.4348941945523,1537.493642689154,1816.799201751693,1230.606535227698),c(462.6070660054179,340.3439887223031,385.91585928174214,448.1720151871677,148.89054231666728,391.7166725152544),c(1548.2973108489682,2099.241722439165,1480.875539386685,2931.5722405184147,3387.6780695646207,1998.1951609205112),c(1164.9377079708167,480.1119200909289,830.025379883747,175.05071652016431,301.1269395168552,1380.2511067503794),c(572.5629210945001,806.8421492643398,703.6838783331766,449.2265375758434,1035.5420864496298,1360.0050764855462),c(2692.4325597488773,3079.4324099593982,2285.632618960318,1347.6796127275302,1572.5517952546882,1878.479503702366),c(854.8820084853868,788.690469865817,529.1028943723885,545.1880749453311,291.0893748662933,966.5278795994367),c(1512.6359524416982,1507.4969740473211,1114.8680379250327,497.73456745492507,3581.7376528088166,1525.4943673459234),c(1153.0505885017267,674.3348896551232,430.3268113419426,388.06423903265346,321.2020688179789,1382.8918933066623),c(605.2524996344974,1003.7878707383126,510.72594869230556,127.59720902975833,163.94688929251004,504.39023224997925),c(188.2127249272578,643.4770346776344,576.5766707126028,91.74344781478491,1060.6359980760344,906.6700509903641),c(402.18087537087723,447.4388971735878,226.64899672102314,189.81402996162396,60.225387903371036,576.5717314550374),c(5125.329677755957,3642.134471313606,2060.5150343793016,1959.3025981594296,2387.2674593919573,2036.0464348938954),c(3209.522256654291,2237.194485867939,1790.986497738085,959.6153736948767,1107.4779664453229,3185.66884906226),c(1079.7466851090053,700.6548247829812,656.2101019929623,1010.2324483513098,505.2240874116126,1241.1696814528286))
targetgene="Kmt2a"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



# 
#
# parameters
# Do not modify the variables beginning with "__"

# gstablename='__GENE_SUMMARY_FILE__'
startindex=9
# outputfile='__OUTPUT_FILE__'
targetgenelist=c("Cdkn2a","Dnmt1","Notch1","Csf3r","Irs1","Ptprs","Fgfr1","Gnas","Insr","Trp63")
# samplelabel=sub('.\\w+.\\w+$','',colnames(gstable)[startindex]);
samplelabel='d5_rep1,d5_rep2,d5_rep3_vs_input_rep1,input_rep2,input_rep3 pos.'


# You need to write some codes in front of this code:
# gstable=read.table(gstablename,header=T)
# pdf(file=outputfile,width=6,height=6)


# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")

######
# function definition

plotrankedvalues<-function(val, tglist, ...){
  
  plot(val,log='y',ylim=c(max(val),min(val)),type='l',lwd=2, ...)
  if(length(tglist)>0){
    for(i in 1:length(tglist)){
      targetgene=tglist[i];
      tx=which(names(val)==targetgene);ty=val[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      # text(tx+50,ty,targetgene,col=colors[i])
    }
    legend('topright',tglist,pch=20,pt.cex = 2,cex=1,col=colors)
  }
}



plotrandvalues<-function(val,targetgenelist, ...){
  # choose the one with the best distance distribution
  
  mindiffvalue=0;
  randval=val;
  for(i in 1:20){
    randval0=sample(val)
    vindex=sort(which(names(randval0) %in% targetgenelist))
    if(max(vindex)>0.9*length(val)){
      # print('pass...')
      next;
    }
    mindiffind=min(diff(vindex));
    if (mindiffind > mindiffvalue){
      mindiffvalue=mindiffind;
      randval=randval0;
      # print(paste('Diff: ',mindiffvalue))
    }
  }
  plot(randval,log='y',ylim=c(max(randval),min(randval)),pch=20,col='grey', ...)
  
  if(length(targetgenelist)>0){
    for(i in 1:length(targetgenelist)){
      targetgene=targetgenelist[i];
      tx=which(names(randval)==targetgene);ty=randval[targetgene];
      points(tx,ty,col=colors[(i %% length(colors)) ],cex=2,pch=20)
      text(tx+50,ty,targetgene,col=colors[i])
    }
  }
  
}




# set.seed(1235)



pvec=gstable[,startindex]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='RRA score',main=paste('Distribution of RRA scores in \\n',samplelabel))


pvec=gstable[,startindex+1]
names(pvec)=gstable[,'id']
pvec=sort(pvec);

plotrankedvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))

# plotrandvalues(pvec,targetgenelist,xlab='Genes',ylab='p value',main=paste('Distribution of p values in \\n',samplelabel))



# you need to write after this code:
# dev.off()






# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1013.3769347399196,1766.1584054762714,3366.809589805199,7311.00372068855,8043.435139983554,2092.383214761258),c(435.86104719996547,1309.6436686034222,1832.3346255182717,1652.4365830548043,1637.79596548334,1147.8618897975095),c(2364.5461810598126,2038.433596454114,3322.3986377449983,6135.211257315157,2184.8432389389604,1778.1296145636268),c(1838.5411445525815,2206.33663089045,8255.842846777268,6112.011764764292,2417.380153343643,1481.4812580745465),c(1069.840752218097,836.7924202719025,2499.264612491282,1548.038866575911,436.63406229944,531.678359998233),c(398.2185022145139,1068.2263326030686,2739.6963184723677,2326.276389418569,1462.138584098508,323.05622205190645),c(30.708391961815746,689.7638171438675,1341.517034646056,107.56128364492025,23.420984184644293,50.174944569369664),c(634.9702983072224,771.4463744372204,2806.3127465626685,2541.39895670841,1718.0964826878349,968.2884039702918),c(2070.339974199836,4326.452784637917,3625.6182414663667,5424.4631673477425,2030.9339142970123,2543.077453700157),c(337.7923115799732,1261.5417181973366,3146.286241644203,4649.389211671111,3636.9442583869068,1151.3829385392196),c(1292.7242422635338,3242.797524546104,9496.286680182868,5058.543898477279,6320.319874970438,2852.9297429706508),c(923.2329454326541,864.9275233396129,1189.9072327853714,2441.2193297842196,3732.301122567244,1193.6355234397415),c(1796.9362264107667,1988.5164781081762,4330.83353193955,4755.895972927356,8110.352237653967,2799.2337496595705),c(1288.7618691071705,1924.9856002133463,1282.5576672557897,3051.787792827443,3621.8879114110637,1426.0247403926114),c(1306.5925483108056,768.7236225274419,577.3423767826063,2109.0447773513774,1279.7894929466345,848.5727467521466),c(1205.5520328235407,1396.771729716332,4366.05601115971,1729.4167174281295,797.9863897196662,880.2621854275379),c(1240.2227979417198,1915.0021765441586,1353.7683317661113,2982.1893151748477,4066.8866109193054,1461.235227809713),c(1189.7025401980875,744.2188553394361,1704.4617118276944,1941.375717551943,5803.3852954665035,1183.0723772146112),c(1054.9818528817345,1473.0087831901278,2336.169219580546,3306.98221088696,6258.421559625307,1882.8808146295037),c(1296.6866154198972,3417.9612307418492,11821.736014783366,7978.516392720261,5393.518072235229,3822.9786713117974),c(961.8660837071965,1659.9710809949129,1898.185347538569,2794.484329990575,3126.701388650013,2523.7116856207513),c(1094.6055844453679,1369.5442106185476,2034.481027999184,2600.452210474248,4443.295285315375,1437.4681488031695),c(383.3596028781514,330.3605650531155,1212.1127088154717,1408.8419112707202,1112.496748770604,562.4875364881967),c(1388.8117913053445,1079.1173402421823,4003.111333978071,1841.1960906277525,2338.752563580909,2287.801419926171),c(1400.6989107744344,2209.0593828002284,3141.6920052241826,5068.03459997536,8536.948735302845,1483.2417824454014))
targetgene="Cdkn2a"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1416.5484033998878,584.4840766324352,732.0150029233045,1072.4492692831755,2475.932613805254,1367.927436154394),c(3650.3362702997106,2125.5616575670233,3123.3150595440993,1978.284001155592,6758.6268647116385,2000.8359474767938),c(372.4630766981523,481.92708803078114,471.6749391221293,1380.3698067764765,1917.1748482573114,1505.2483370810899),c(1354.1410261871654,2178.2015278227395,2526.0643249414034,3815.262002228642,4080.270030453388,3566.822375352384),c(828.1359896799344,796.8587255951522,733.5464150633114,741.3292392390092,729.3963646074936,475.3415801308705),c(950.9695575271974,686.133481264163,1053.6115523247563,1859.1229712352392,1964.0168166265998,765.828101321958),c(2166.427523241646,2618.3797532369185,3428.066075405475,4616.699017622165,8130.42736695509,3911.004889854551),c(910.3552326744733,1999.40748574729,2230.501781920069,3412.4344497545285,7924.657291618572,2306.2869258201495),c(1194.6555066435417,1145.3709700467907,1541.366318916958,2670.050688126844,2658.281704957127,1467.397063107706),c(990.5932890908306,1069.1339165729948,1795.5807341581058,1896.0312548388883,2835.6120137837197,1798.37564482846),c(990.5932890908306,592.6523323617704,454.8294055820532,303.70244793859837,3314.0692621271673,572.1704205278996),c(1425.463743001705,1133.5723784377508,1259.586485155686,1241.1728514712856,513.5887246204142,1879.3597658877936),c(717.1895413017613,1016.4940463172785,476.26917554215,1543.8207770212082,754.4902762338983,968.2884039702918),c(299.15917330543084,540.9200460759804,434.92104776196334,886.8533288762542,789.6217525108647,1355.6037655584084),c(384.35019616724225,551.8110537150941,531.4000125823989,581.0418361603045,269.34131812340934,208.6221379463265),c(1142.1540623217277,790.5056378056693,1040.5945491346974,1908.6855235029966,5644.457188499275,1091.525109930147))
targetgene="Dnmt1"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(231.79882964725434,549.0883018053156,474.73776340214306,284.7210449424359,137.18005022434514,85.38543198647119),c(1252.1099174108099,1872.34572995763,1378.2709260062218,2355.8030163014887,3556.6437411824118,1561.5851169484524),c(732.0484406381238,237.78700012064908,288.67118839130313,808.8186721142532,2002.494147787087,432.20873304492113),c(1898.9673351871222,2651.0527761542594,3669.263487456564,5195.631809005118,12274.268640195369,1786.932236417902),c(1112.4362636490027,668.8893858355664,1107.9766832950017,1303.3896724031513,2708.4695282099365,669.8795231103564),c(818.2300567890261,859.482019520056,858.3565044738748,2606.7793448063026,754.4902762338983,1512.2904345645102),c(1216.44855900354,1175.3212410543533,1252.695130525655,1402.514776938666,3526.5310472307265,2146.959470257765),c(943.0448112144707,309.48613374481425,358.3504407616177,838.3452989971726,1030.523304124349,505.2704944354068),c(1836.5599579743998,925.7356493246643,898.1732201140546,1762.1069114770758,1423.6612529380209,1388.1734664192275),c(974.7437964653773,589.0219964820659,290.20260053131005,242.5401493954084,558.7577655479424,753.5044307259725),c(856.8631950635685,1355.9304510696554,1373.676689586201,1654.5456278321556,692.591960888767,1287.823577280488),c(810.3053104762994,396.6141948577239,640.1302745228897,857.326701993335,625.6748632183546,930.4371299969076),c(866.7691279544767,1205.271512061916,2473.230606111165,3627.5570170443693,3299.0129151513247,2462.0933326408235),c(1255.0816972780824,1420.3689129344116,2365.2660502406775,1897.085777227564,2266.8166835852153,1122.3342864201109),c(1207.5332194017224,1033.7381417458753,980.8694756744279,2426.4560163427595,1274.7707106213536,1247.3315167508213),c(1738.4912223544077,2377.870001206491,2758.0732641524505,3440.9065542487724,5095.736987601894,956.8449955597338),c(2281.3363447761826,2167.310520183626,2585.0236923316693,1541.7117322438569,2807.1722472737947,795.7570156264943),c(1654.290792781687,2371.516913417008,2604.932050151759,3789.9534649004254,2626.496083563681,1242.049943638256),c(812.2864970544811,795.9511416252261,869.0763894539232,1496.3672695308023,1600.9915617646134,1872.3176684043733),c(540.8639358435935,897.600546256954,685.3069326530937,523.0431047831416,1179.4138464410162,1432.1865756906043),c(2090.1518399816523,2543.957867702975,4164.675314748801,5370.6825255252825,4080.270030453388,2633.7444587991936),c(2344.734315277996,2001.2226536871422,1251.163718385648,975.4332095250121,2785.4241905309104,1706.828377543996),c(1838.5411445525815,1885.051905536596,1388.9908109862702,1868.6136727333203,583.8516771743471,1274.619644499075),c(1651.3190129144145,1172.5984891445748,990.8236545844728,3721.4095096365054,9431.964916644609,3094.121581777796),c(976.724983043559,907.5839699261415,638.5988623828828,2221.878672939676,429.9423525323988,1539.578562312764),c(1425.463743001705,1487.530126708946,1998.4928427090217,2679.541389624925,883.3056892494419,1840.628229728982),c(1316.4984812017137,2616.564585297066,2913.5115963631524,5340.101376253688,5202.8043438745535,3766.641891444435),c(4290.259535052387,3411.608142952366,2761.901794502468,5351.70112252912,2512.7370175239807,3038.665064095861),c(2102.0389594507424,1148.093721956569,1320.8429707559626,2270.386702818758,4095.3263774292304,1468.2773252931333),c(406.14324852724053,99.83423669187557,192.95792964087107,1730.471239816805,277.7059553322109,268.4799665553991),c(1056.9630394599162,1482.9922068593153,1190.672938855375,1512.1851053609375,3130.0472435335337,1129.3763839035312),c(2386.3392334198106,2332.4908027101837,2418.099769070916,1719.9260159300484,792.9676073943854,946.2818493346033),c(1884.1084358507596,2248.0854935070524,2810.1412769126855,1256.9906873014208,1744.8633217559998,1628.4850430409454),c(2949.986814912493,3361.691024606428,4028.379634288185,2657.3964194627356,1649.5064575756624,1955.9425760199895),c(1896.9861486089405,2060.215611732341,1820.0833283982163,2406.4200909579217,2685.048544025292,3252.568775154753),c(1395.7459443289802,1414.9234091148546,1371.3795713761908,2140.680449011648,2671.6651244912096,728.8570895340015),c(4695.412190290537,3540.4850666818784,3162.366069114276,3207.857106351445,6224.963010790101,1485.882569001684),c(1700.848677368956,2053.8625239428584,3450.2715514355755,6263.862988733591,4158.897620216122,1389.9339907900824),c(3346.2241305488255,3925.300669930562,7850.018629675437,7048.427645908303,7747.32698279198,1861.754522179243),c(3693.922375019707,2897.91561597417,3552.110458746035,3989.2581963601306,2947.6981523816603,1551.0219707233218),c(2163.455743374374,1745.2839741679702,1150.0905171451918,750.8199407370904,709.32123530637,793.1162290702117),c(5472.037328937748,4522.490922141963,4196.834969688945,4551.318629524272,3489.7266435119996,2975.2861867450783),c(606.2430929235883,1075.4870043624778,1398.1792838263118,1274.9175679089076,6713.457823784111,1116.1724511221182),c(278.3567142345234,368.47909179001346,191.42651750086415,993.3600901324987,436.63406229944,1126.7355973472486),c(1486.8805269253367,869.4654431892436,745.0320061133633,878.4171497668486,496.85945020281105,1515.8114833062205),c(3526.512109163357,2141.898169025694,4881.3761962720355,5855.7628243161,1989.1107282530045,1861.754522179243),c(3084.7075022288464,2477.7042378983665,2820.0954558227304,2710.12253889652,2959.4086444739823,2499.0643444287803),c(508.1743573035961,923.012897414886,849.1680316338334,1191.6102992035283,739.4339292580555,1482.361520259974),c(1528.4854450671514,482.8346720007073,565.8567857325544,2965.316956956037,786.2758976273441,1021.104135095944),c(2887.579437699771,1544.707916814293,1346.1112710660766,2342.094225248705,1595.9727794393325,2281.6395846281785),c(1697.8768975016835,1526.55623741577,1429.5732326964535,1700.944612933886,1366.7817199181704,1748.2007002590904),c(2197.135915203462,3511.4423796442416,4360.696068669686,4104.20113672578,2527.7933644998234,1912.80972893404),c(573.5535143835909,955.685920332227,1142.4334564451572,2853.537583756414,8254.223997645353,1170.7487066186254),c(4296.2030947869325,3544.115402561583,5948.004751786851,8194.693482398778,13000.319149919344,3445.346193763384),c(2052.509294996201,2456.8298065900653,2058.9836222392946,3844.788629111561,4804.647612735601,3690.0590813122394),c(3162.964372067022,2036.6184285142617,2859.9121714629105,6986.210824976438,5119.157971786538,2764.9035244278966),c(375.43485656542475,289.51928640643916,370.601737881673,744.4928064050363,908.3996008758465,244.71288754885555),c(951.9601508162882,1826.966531461323,686.072638723097,992.3055677438231,394.81087625543233,611.7822188721389),c(2354.6402481689042,2971.4299175381875,2458.682190781099,4029.3300471298066,5350.02195874946,2263.1540787342),c(2443.793644187079,2054.7701079127846,2395.8942930408157,1070.340224505824,853.1929952977564,1738.5178162193874),c(2614.1756899107017,1640.911817626464,1205.987060255444,833.0726870537941,3225.4041077138713,1123.2145486055385),c(1609.7140947725995,1839.672707040289,1868.322810808434,2937.8993748504686,3391.0239244481413,1380.2511067503794),c(2869.748758496136,3110.290264936887,3152.411890204231,2874.6280315299273,8158.867133465015,2382.8697359523453),c(3263.014294265196,2197.2607911911887,1884.4026382785066,2745.9763001114934,948.5498594780938,1035.1883300627846),c(5040.1386548941455,3054.0200588014663,4425.015378549976,5077.525301473441,7315.711702817821,2815.0784689972666),c(2236.7596467670955,2337.0287225598145,1807.832031278161,1911.8490906690236,900.034963667045,1227.9657486714154),c(1160.9753348144534,700.6548247829812,845.339501283816,1277.026612686259,471.76553857640647,916.352935030067),c(1186.730760330815,1122.681370798637,575.0452585725959,856.2721796046592,172.3115265013116,593.2967129781606),c(1106.4927039144577,1276.063061716155,735.8435332733218,544.1335525566553,792.9676073943854,1206.8394562211545),c(10.896526179999135,121.61625197010297,102.60461338046318,11.599746275432576,92.01100929681687,110.03277317844224),c(1477.965187323519,1883.2367375967438,2780.278740182551,6594.983018777757,13619.302303370656,2220.0212316482507),c(1493.8146799489725,1158.0771456257567,990.8236545844728,632.7134332054133,804.6780994867074,1040.4699031753498),c(1978.2147983143886,984.7286073698635,1756.5297245879294,2866.191852420522,5426.976621070435,1463.8760143659956),c(1663.2061323835046,695.2093209634244,1339.2199164360457,3180.4395242458772,5298.161208054891,1706.828377543996),c(630.0173318617682,563.6096453241339,577.3423767826063,2313.622120754461,9666.174758491052,1853.832162510395),c(601.2901264781342,475.57400024129817,362.17897111163495,2346.3123148034074,1820.1450566352137,833.6082895998785),c(398.2185022145139,917.5673935953291,972.4467089043899,1407.7873888820445,567.1224027567439,872.3398257586902),c(1850.4282640216716,1971.2723826795793,2219.7818969400205,3106.622957038579,4428.238938339531,1566.8666900610176),c(464.5882525835995,944.7949126931134,549.7769582624818,1119.9027767735813,1286.4812027136759,905.7897888049366),c(880.6374340017484,689.7638171438675,236.6031756310681,1004.9598364079313,466.74675625112553,1311.5906562870316),c(524.0238499290493,612.6191797001455,413.48127780186655,555.7332988320879,398.156731138953,948.9226358908859),c(1276.8747496380806,1544.707916814293,1559.7432645970412,1661.9272845528853,6380.545262873809,757.9057416531102),c(1039.1323602562813,667.9818018656401,557.4340189625163,409.1546868061672,180.67616371011312,506.15075662083433),c(547.7980888672292,401.15211470735454,852.2308559138472,1316.0439410672595,448.3445543917622,517.5941650313923),c(2024.7726829016576,1554.6913404834804,1649.3308747874455,1169.4653290413387,3626.9066937363446,1738.5178162193874),c(1764.2466478707693,1857.8243864388116,3003.0992065535565,2864.0828076431703,2261.7979012599344,1552.782495094177),c(1211.4955925580857,1889.5898253862267,3929.603551257739,7638.960183566689,8020.01415579891,873.2200879441177),c(802.3805641635728,1480.2694549495368,1173.0616992452956,1364.5519709463413,1172.722136673975,1118.8132376784008),c(587.4218204308626,890.3398744975449,1545.1948492669753,2638.415016466573,956.9144966868954,1164.5868713206328),c(1101.5397374690035,888.5247065576925,2191.4507723498928,5123.924286575171,6014.174153128302,2764.023262242469),c(73.30390339272147,171.53337031604076,124.81008941056342,111.77937319962301,326.2208511432598,272.00101529710923),c(461.61647271632705,776.8918782567772,646.2559230829173,609.513940654548,493.51359531929046,998.217318274828),c(2203.079474938007,1797.9238444236864,1807.0663252081577,2820.8473897074673,1027.1774492408283,1604.7179640344018),c(627.0455519944958,753.2946950386975,1107.2109772249983,1034.4864632908507,3832.6767690728625,719.1742054942986),c(3740.4802596069762,1926.8007681531985,1874.4484593684617,2935.7903300731173,2773.7136984385884,2337.096102310113),c(2193.1735420470986,1292.3995731748255,1509.9723700468164,976.4877319136878,3655.34646024627,1121.4540242346834),c(1691.9333377671385,1700.8123596415892,1692.9761207776426,2393.7658222938135,5375.115870375865,2602.93528230923),c(362.55714380724396,1017.4016302872046,573.5138464325889,614.7865525979265,1938.9229050001954,1706.828377543996),c(1118.3798233835478,1257.9113823176322,1185.3129963653507,1817.9965980768873,1709.7318454790334,1396.0958260880752),c(1545.3255309816957,1060.9656608436594,1739.6841910478533,1625.0190009492362,1442.0634547973843,2145.19894588691),c(2170.3898963980096,1009.2333745578694,1568.166031367079,1783.1973592505897,5806.731150350024,2235.8659509859463),c(279.34730752361423,542.7352140158326,375.19597430169375,42.180895547027546,160.60103440898945,523.7560003293851),c(1592.8740088580555,2225.3958942588993,3826.2332318072727,1289.6808813503674,1478.867858516111,1601.1969152926915),c(478.45655863087114,903.953634046437,871.3735076639335,3088.696076431092,1087.4028371441993,1678.6599876103148),c(792.4746312726644,1296.9374930244562,1529.1150217969027,200.35925384838086,864.9034873900786,785.1938694013638),c(810.3053104762994,578.1309888429522,1245.0380698256204,2305.1859416450557,2338.752563580909,1611.7600615178221),c(1165.9283012599076,1254.2810464379277,915.7844597241341,1009.177925962634,426.5964976488782,889.0648072818134),c(1453.2003550962484,827.7165805726411,1755.764018517926,2802.920509099981,398.156731138953,327.4575329790441),c(145.6172134963521,805.0269813244876,1106.4452711549948,237.26753745202996,3309.0504798018865,620.5848407264143),c(2102.0389594507424,2725.474661688203,1435.6988812564812,2610.997434361005,2268.4896110269756,1712.1099506565613),c(2131.7567581234675,1740.7460543183395,1617.9369259173038,1270.699478354205,2577.9811877526326,1461.235227809713),c(1946.515813063482,2260.7916690860184,2006.1499034090562,2990.6254942842534,7988.228534405464,2471.7762166805264),c(485.39071165450696,647.1073705573389,800.1628431536121,894.2349855969841,639.0582827524371,868.81877701698),c(784.5498849599378,953.8707523923748,2258.0672004401936,1950.8664190500242,4906.69618668298,1291.3446260221983),c(1493.8146799489725,1248.8355426183707,620.2219167027998,1298.1170604597728,710.9941627481303,536.0796709253706),c(1263.0064435908089,995.6196150089772,623.2847409828137,461.88080623995165,669.1709767041226,1252.6130898633864),c(2767.7176497197806,2767.223524304806,4806.337001411697,5985.469078123209,8286.0096190388,3068.593978400397),c(1052.010073014462,993.804447069125,1032.1717823646595,1391.969553051909,659.1334120535608,1206.8394562211545),c(3197.635137185201,2587.5218982594297,2774.918797692527,2990.6254942842534,6141.316638702086,2930.392815288274),c(1324.4232275144404,1267.8948059868198,1725.9014817877912,703.3664332466843,526.9721441544966,417.244275892653),c(2525.022293892527,2933.3113908012897,3091.9211106739576,4037.766226239212,4153.878837890841,3287.7792625718544),c(2277.3739716198193,2236.2869018980127,2915.808714573163,3032.8063898312807,6685.018057274186,1374.0892714523868),c(1448.2473886507942,889.4322905276188,1222.0668877255166,1041.8681200115805,1186.1055562080574,1160.185560393495),c(794.4558178508461,396.6141948577239,942.5841721742551,843.6179109405509,6695.055621924747,1004.3791535728209),c(1029.226427365373,775.984294286851,553.6054886124991,1297.0625380710972,1017.1398845902664,1014.0620376125238),c(1998.0266640962052,1288.769237295121,1356.831156046125,694.9302541372789,873.26812459888,1492.044404299677),c(907.3834528072008,950.2404165126702,404.2928049618251,724.4568810201981,2034.2797691805329,310.7325514559209),c(719.170727879943,799.5814775049307,469.37782091211886,337.44716437622037,1276.443638063114,995.5765317185454),c(1082.7184649762778,1050.982237174472,1220.5354755855099,3121.3862704800385,834.790793438393,1229.7262730422706),c(1799.908006278039,1686.291016122771,1590.3715073971794,911.107343815795,2378.902822183156,880.2621854275379),c(1870.2401298034881,1292.3995731748255,1481.6412454566885,3318.5819571623924,6132.952001493284,2375.827638468925),c(690.4435224963089,305.8557978651097,285.6083641112893,551.5152092773852,329.5667060267804,536.0796709253706),c(1304.611361732624,1366.8214587087691,1313.9516161259314,2513.9813746028417,1289.8270575971965,913.7121484737844),c(2293.2234642452727,2568.4626348909806,2184.559417719862,4460.6297040981635,1033.8691590078695,1504.3680748956624),c(4881.643728639613,3094.861337448143,5096.539601943007,1746.2890756469405,8128.75443951333,2383.7499981377728),c(1390.7929778835262,1344.1318594606157,1078.8798526348703,1461.5680307045045,2342.0984184644294,2716.489104229382),c(497.2778311235969,469.2209124518152,1290.2147279558244,1261.2087768561237,682.5543962382051,544.0020305942185),c(486.3813049435978,854.0365157004992,1116.3994500650397,640.095089926143,1731.4799022219174,1099.447469598995))
targetgene="Notch1"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3402.687948027003,2559.386795191719,14169.390825413964,2093.226941521242,7123.325047015385,2012.2793558873518),c(4.952966445454153,9.983423669187557,2490.841845721244,160.28740307870467,2848.995433317802,508.791543177117),c(514.1179170381411,594.4675003016227,2758.0732641524505,350.10143304032863,127.1424855737833,414.6034893363704))
targetgene="Csf3r"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(724.1236943253971,602.635756030958,578.1080828526098,1306.5532395691782,956.9144966868954,994.696269533118),c(2574.5519583470686,1967.6420467998748,3270.3306249847633,2894.6639569147655,4608.915102049645,2422.4815342965844),c(852.9008219072051,932.9963210840735,1445.653060166526,2073.191016136404,1345.0336631752866,1381.1313689358071),c(1180.78720059627,867.6502752493914,481.6291180321742,368.02831364781537,2696.7590361176144,1015.8225619833788),c(198.1186578181661,391.168691038167,574.2795525025924,395.44589575338324,670.8439041458829,450.69423893889945),c(494.30605125632445,1539.262412994736,1741.2156031878603,1147.3203588791494,9544.05105524255,891.705593838096),c(202.08103097452943,727.8823438807655,570.4510221525752,988.0874781891204,938.5122948275321,1681.3007741665976),c(722.1425077472155,392.07627500809315,310.87666442140335,171.88714935413725,321.2020688179789,1256.1341386050967),c(1658.2531659380504,418.39621013595126,232.00893921104733,772.9649108992799,324.5479237014995,461.2573851640299),c(1081.727871687187,624.4177713091854,582.7023192726305,2270.386702818758,5734.7952703543315,1235.8881083402632),c(1131.2575361417285,611.7115957302194,824.6654373937228,484.0257764021411,1447.0822371226652,749.1031197988348),c(1042.1041401235536,2085.6279628902735,2987.019379083484,3185.7121361892555,4980.304994120433,2352.0605594623817),c(907.3834528072008,1483.8997908292415,1140.136338235147,931.1432692006331,4670.8134173947765,1650.4915976766338),c(1889.0614022962138,1938.5993597622382,1748.8726638878948,2311.5130759771096,1313.2480417818406,2528.9932587333165),c(2120.860231943468,1946.7676154915737,2428.053947980961,6019.213794560831,1321.6126789906423,1176.0302797311908),c(1965.3370855562077,2175.4787759129613,1951.0190663688074,1803.2332846354277,5932.200708482047,2367.905278800077),c(1679.0556250089578,1430.352336603599,804.7570795736328,815.1458064463073,1560.841303162366,1408.4194966840607),c(2353.649654879813,3054.9276427713926,4230.526036769098,9804.949169906553,5540.735687110136,2858.211316083216),c(1300.6489885762605,1062.7808287835117,1523.7550793068785,1780.0337920845625,2179.8244566136796,1686.5823472791628),c(1837.5505512634907,2300.7253637627687,2735.8677881223502,2803.9750314886564,6701.7473316917885,1281.6617419824952),c(590.393600298135,1309.6436686034222,1875.9798715084687,1875.9953294540503,672.5168315876433,1428.6655269488942),c(431.8986740436021,592.6523323617704,631.7075077528517,475.5895972927356,1554.149593395325,1111.7711401949805),c(1619.620027663508,2028.4501727849263,1352.2369196261043,2023.6284638686466,2099.523939409185,1705.067853173141),c(1330.3667872489855,1473.9163671600538,1050.5487280447423,3742.4999574100193,11802.503101618962,1406.6589723132056),c(459.6352861381454,1599.1629550098614,1168.4674628252747,2796.5933747679264,1513.9993347930774,1339.759046220713),c(2384.358046841629,1736.2081344687087,1407.3677566663532,2277.7683595394874,1607.6832715316546,1622.3232077429525),c(2893.522997434316,3999.7225554645056,3971.717385107929,7798.193064256718,6788.739558663324,3237.604318002485),c(1157.01296165809,844.9606760012377,831.5567920237538,2338.9306580826774,4789.591265759758,1206.8394562211545),c(1783.067920363495,1237.944534979257,1356.831156046125,1516.4031949156404,5843.535554068751,2555.401124296143),c(568.6005479381367,523.6759506473836,431.09251741194606,1546.9843441872354,1709.7318454790334,1236.768370525691),c(211.98696386543773,720.6216721213564,758.8147153734254,1130.4480006603383,2556.2331310097484,1022.8646594667991),c(1439.3320490489768,1861.4547223185164,1826.9746830282475,1409.8964336593958,1517.345189676598,1902.2465827089095),c(502.2307975690511,627.1405232189638,447.17234488201865,1178.95603053942,371.38989207078805,738.5399735737044),c(1620.6106209525988,2022.0970849954433,2840.769519712824,3269.019404894635,3693.823791406757,889.0648072818134))
targetgene="Irs1"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3860.3420475869666,4642.292006172214,7184.620054842433,5792.491480995558,3641.9630407121876,3501.682973630746),c(2323.9318562070885,1724.4095428596688,1960.2075392088489,781.4010900086853,1353.398300384088,784.3136072159364),c(1474.002814167156,1391.326225896775,1892.8254050485448,2235.58746399246,451.6904092752828,752.6241685405449),c(427.9363008872388,608.0812598505148,810.8827281336605,2824.0109568734943,4091.98052254571,2380.2289493960625),c(1532.4478182235148,1041.9063974752105,1677.6619993775735,2394.820344682489,5865.283610811635,2484.099887276512),c(862.8067547981134,696.1169049333506,665.3985748330037,1893.9222100615368,2288.5647403280996,322.1759598664789),c(1034.1793938108272,868.5578592193175,1663.1135840475076,2273.550269984785,859.8847050647976,325.69700860818904),c(346.7076511817907,1119.0510349189326,769.5346003534738,388.06423903265346,269.34131812340934,806.3201618516248),c(1196.6366932217234,1617.3146344083843,3163.1317751842794,1170.5198514300146,2117.9261412685482,1067.7580309236037),c(456.66350627087286,1620.0373863181626,1673.0677629575525,2349.4758819694343,672.5168315876433,738.5399735737044),c(1652.3096062035054,1642.7269855663162,2902.0260053131005,2097.445031075945,824.7532287878312,1705.9481153585687),c(2532.947040205254,2010.2984933864036,2441.0709511710197,1963.5206877141325,5386.826362468188,1932.175497013446),c(1912.8356412343937,1947.6751994614997,1376.739513866215,1758.9433443110488,1641.1418203668609,1893.4439608546343),c(3181.7856445597477,2593.8749860489124,3643.99518714645,3166.7307331930933,3476.343223977917,1274.619644499075),c(2451.7183904998055,1767.9735734161238,1257.2893669456757,1817.9965980768873,911.7454557593671,1736.7572918485325),c(347.69824447088155,408.4127864667637,771.0660124934808,732.8930601296037,1457.119801773227,510.552067547972),c(1968.3088654234803,1607.3312107391966,1872.1513411584513,1654.5456278321556,1189.451411091578,1880.240028073221),c(1518.5795121762433,1329.6105159417973,1558.9775585270377,2021.5194190912953,3999.9695132488932,1570.3877388027277),c(677.5658097381281,528.2138704970143,486.9890605221984,528.31571672652,314.51035905093767,1024.6251838376543),c(326.8957853999741,826.808996602715,643.1930988029035,275.23034344435473,685.9002511217257,564.2480608590519),c(1502.7300195507898,2963.2616618088523,3556.704695166056,4450.084480211406,1246.3309441114284,2390.7920956211933),c(380.38782301087895,273.1827749477686,261.87147594118215,242.5401493954084,245.92033393876508,858.2556307918495),c(880.6374340017484,872.188195099022,612.5648560027653,704.4209556353601,704.3024529810891,992.0554829768353),c(371.47248340906145,372.10942766971806,300.92248551135845,1331.8617768973947,1338.3419534082452,698.0479130440376),c(1520.560698754425,1233.4066151296263,2036.7781462091946,2073.191016136404,1918.8477756990717,1455.9536546971478),c(649.8291976435848,1101.806939490336,967.0867664143657,1017.6141050720396,4347.938421135037,1236.768370525691),c(853.891415196296,738.7733515198793,811.648434203664,1405.678344104693,2743.6010044869026,1602.0771774781192),c(1761.2748680034967,2559.386795191719,3771.1023947670237,2165.988986339865,1022.1586669155473,1679.5402497957425),c(1882.127249272578,2507.654508905929,4519.962931230404,8573.26701993335,4080.270030453388,2557.1616486669977),c(1240.2227979417198,1470.2860312803493,2957.922548423353,1836.9780010730497,3616.869129085783,760.5465282093928),c(878.6562474235667,613.5267636700717,2074.297743639364,2017.3013295365924,383.1003841631102,318.6549111247688),c(1204.5614395344498,2658.3134479136684,2530.658561361424,2192.352046056757,992.0459729638618,901.3884778777989),c(1124.3233831180926,781.4297981064078,650.0844534329347,498.7890898436008,828.0990836713518,470.06000701830527),c(1148.0976220562727,1229.7762792499218,1425.7447023464363,2180.7522997813244,4162.243475099643,1626.7245186700902),c(844.9760755944785,1250.650710558223,817.7740827636916,4281.360898023296,2496.0077431063773,1025.5054460230817),c(1296.6866154198972,1612.7767145587536,2165.416765969775,1229.573105195853,1363.4358650346499,1129.3763839035312),c(1572.0715497871481,1943.137279611869,1738.1527789078464,1177.9015081507443,982.0084083132999,2152.2410433703303),c(155.5231463872604,474.66641627137204,666.9299869730107,141.30600008254228,292.7623023080537,529.0375734419504),c(3063.905043157939,2776.299364004067,5693.024630475699,1641.8913591680473,14273.416933098935,1606.4784884052567),c(280.3379008127051,654.3680423167481,919.6129900741514,1633.4551800586419,652.4417022865196,617.0637919847042),c(1657.2625726489596,1547.4306687240714,1706.7588300377047,4406.849062275704,4920.079606217062,1257.0144007905242),c(179.29738532544033,231.43391233116608,406.58992317183544,1414.1145232140987,436.63406229944,1017.583086354234),c(339.7734981581549,219.63532072212627,186.06657501083995,206.686388180435,128.8154130155436,548.4033415213562),c(1178.8060140180883,1765.2508215063453,1807.0663252081577,5328.501629978255,4240.871064862377,1418.9826429091913),c(1457.1627282526117,1942.229695641943,1686.0847661476114,3535.813569229584,4665.794635069495,2819.4797799244043),c(1096.5867710235493,1398.5868976561842,1210.581296675465,741.3292392390092,3432.847110492149,948.9226358908859),c(720.1613211690338,2032.988092634557,2210.593424099979,1709.3807920432914,1025.504521799068,693.6466021168999),c(1264.9876301689906,2297.095027883064,3231.2796154145867,1268.5904335768535,1806.761637101131,2001.7162096622214),c(2686.4890000143323,1483.8997908292415,1456.3729451465745,879.4716721555244,3022.979887260874,1312.470918472459),c(1363.056365788983,778.7070461966294,970.1495906943795,755.0380302917931,913.4183832011274,956.8449955597338),c(601.2901264781342,427.47204983521266,1106.4452711549948,525.152149560493,354.660617653185,824.805667745603),c(427.9363008872388,327.6378131433371,474.73776340214306,426.02704502497824,103.72150138913901,207.74187576089895),c(929.176505167199,1287.8616533251948,1013.0291306145731,1965.6297324914838,1875.3516622133036,1563.3456413193076),c(2234.778460188914,2283.481268334172,2573.5381012816174,3603.3030021048285,1150.974079931091,1445.3905084720175),c(578.506480829045,589.929580451992,1006.9034820545454,680.1669406958192,540.3555636885791,1159.3052982080676),c(809.3147171872085,1016.4940463172785,1373.676689586201,2145.9530609550266,600.5809515919501,681.3229315209144),c(1277.8653429271715,1953.1207032810566,1393.585047406291,1331.8617768973947,563.7765478732233,775.5109853616609),c(7.924746312726644,76.2370534737959,109.4959680104943,3.1635671660270663,40.15025860224736,265.8391799991165),c(846.9572621726601,697.0244889032767,985.4637120944486,1584.9471501795601,1892.0809366309068,1233.2473217839806),c(1438.341455759886,854.0365157004992,1668.4735265375318,6500.076003796945,1644.4876752503815,2428.6433695945775),c(1188.7119469089967,829.5317485124933,587.2965556926512,565.2240003301691,1368.4546473599307,1000.8581048311107),c(1014.3675280290105,1736.2081344687087,1009.2006002645558,453.44462713054617,1137.5906603970086,1926.8939239008807),c(2184.2582024452813,1357.7456190095077,1401.2421081063255,957.5063289175254,5562.483743853019,774.6307231762335),c(902.4304863617466,1625.4828901377196,1304.76314328589,1166.3017618753117,458.382119042324,831.8477652290234),c(1474.9934074562466,2237.194485867939,4049.819404248282,4735.860047542518,2327.0420714885863,2195.3738904562797),c(632.9891117290407,720.6216721213564,928.0357568441893,711.8026123560899,1711.4047729207937,247.35367410513817),c(83.20983628362977,496.44843154959943,302.45389765136537,117.05198514300145,55.20660557809012,141.7222118538336),c(2132.747351412558,3186.527318410683,2702.176721042198,2288.3135834262443,3595.121072342899,2065.9753491984316),c(984.6497293562855,1269.709973926672,689.9011690731144,1057.6859558417157,1974.0543812771618,920.7542459572047),c(2546.815346252525,1159.892313565609,2716.725136372264,3321.7455243284194,2067.738318015739,1102.0882561552776),c(853.891415196296,596.282668241475,1659.2850536974904,2612.051956749681,1467.157366423789,1087.1237990030095),c(892.5245534708383,1100.8993555204097,1640.142401947404,2193.4065684454326,786.2758976273441,864.4174660898423),c(1106.4927039144577,273.1827749477686,166.15821719075007,419.6999106929241,162.27396185074974,656.6755903289434),c(1752.3595284016792,1865.992642168147,2183.7937116498583,1853.8503592918607,1748.2091766395204,1867.9163574772356),c(577.5158875399542,922.1053134449598,519.1487154623436,252.0308508934896,732.7422194910143,753.5044307259725),c(581.4782606963175,798.6738935350046,909.6588111641064,1270.699478354205,2181.49738405544,2308.0474501910044),c(308.0745129072483,206.92914514316027,155.43833221070167,83.30726870537941,271.0142455651697,976.2107636391396),c(1807.8327525907657,1455.764687761531,1261.117897295693,1847.5232249598066,873.26812459888,704.2097483420304),c(251.61069542907097,175.1637061957453,281.779833761272,1396.187642606612,737.7610018162952,1496.4457152268146),c(936.1106581908349,859.482019520056,3889.7868356175595,2866.191852420522,8640.670236691984,1159.3052982080676),c(511.14613717086854,299.50271007562674,526.0400700923747,195.0866419050024,1826.8367664022549,278.162850595102),c(1289.7524623962613,483.74225597063344,1529.1150217969027,603.1868063224939,384.7733116048705,923.3950325134873),c(1733.5382559089535,1762.5280695965669,5541.414828615016,3295.382464611527,7441.181260949844,1301.0275100619012),c(699.3588620981263,364.8487559103089,8718.329313059357,841.5088661631996,244.24740649700476,476.221842316298),c(1860.3341969125797,1771.6039092958283,1891.2939929085378,739.2201944616578,649.095847402999,1831.8256078747065),c(179.29738532544033,1096.361435670779,1594.9657438172,567.3330451075205,685.9002511217257,1000.8581048311107),c(1027.2452407871913,433.8251376246957,808.5856099236502,76.98013437332527,602.2538790337104,767.5886256928131),c(654.782164089039,658.9059621663788,2188.387948069879,354.3195225950314,1013.7940297067458,743.8215466862696),c(3753.357972365157,1998.4999017773637,2209.8277180299756,3427.1977631959885,3571.7000881582544,1925.1333995300256),c(798.4181910072094,2257.161333206314,3194.525724054421,994.4146125211745,5918.817288947965,1253.4933520488141),c(504.2119841472327,839.5151721816809,5258.86928878374,1786.3609264166166,7820.935790229433,1248.211778936249),c(369.4912968308798,353.05016430126904,2406.614178020864,1104.084940943446,587.1975320578676,805.4398996661972),c(832.0983628362976,916.659809625403,912.7216354441202,633.7679555940889,863.2305599483182,691.8860777460449),c(779.5969185144836,1133.5723784377508,2282.569794680304,2399.0384342371917,2815.536884482596,1344.1603571478504),c(1139.1822824544552,1273.3403098063766,2061.280740449305,2565.652971647951,1841.8931133780975,1346.8011437041332),c(723.1331010363064,1156.2619776859044,2170.7767084597995,562.0604331641421,448.3445543917622,581.8533045676025),c(1038.1417669671905,1062.7808287835117,3559.76751944607,1329.7527321200434,973.6437711044985,675.1610962229216),c(496.28723783450613,163.3651145867055,1685.319060077608,157.1238359126776,122.12370324850238,660.1966390706535),c(690.4435224963089,341.2515726922292,2670.7827721720564,544.1335525566553,147.21761487490699,341.54172794588476),c(879.6468407126575,1176.2288250242793,1386.69369277626,1716.7624487640212,429.9423525323988,442.7718792700516),c(125.80534771453549,494.63326360974713,981.6351817444313,76.98013437332527,81.97344464625502,276.4023262242469),c(867.7597212435676,872.188195099022,11955.73457703397,1885.4860309521314,1085.729909702439,2925.9915043611363),c(690.4435224963089,1515.6652297766564,2179.965181299841,3505.2324199579894,10850.607387257349,1591.5140312529886),c(1755.3313082689517,1784.3100848747943,4815.525474251738,4132.6732412200245,2248.414481725852,2232.3449022442364),c(666.669283558129,1139.0178822573077,917.315871864141,1868.6136727333203,3531.5498295560074,1316.8722293995968),c(2566.627212034342,2922.4203831621758,4426.546790689982,2106.935732574026,7513.117140945537,3800.0918544906813),c(721.1519144581247,445.6237292337355,191.42651750086415,94.90701498081198,674.1897590294036,634.6690356932548),c(681.5281828944915,924.8280653547382,1020.6861913146076,185.59594040692122,359.67939997846594,828.3267164873132),c(1856.3718237562164,1712.6109512506291,24238.425645959418,3814.2074798399663,5110.7933345777365,3014.01772290389),c(52.50144432181402,184.23954589500673,1670.0049386775388,952.2337169741469,396.4838036971927,985.013385493415),c(950.9695575271974,1159.892313565609,2590.3836348216937,1150.4839260451763,861.5576325065579,2729.6930370107953),c(1058.944226038098,1925.8931841832723,2034.481027999184,1923.4488369444562,4602.2233922826035,1811.5795776098732),c(1079.7466851090053,1877.7912337771868,1371.3795713761908,1817.9965980768873,5565.82959873654,2398.714455290041),c(1448.2473886507942,1245.2052067386662,640.8959805928931,440.79035846643785,608.9455888007516,683.963718077197),c(588.4124137199533,747.8491912191406,1450.2472965865468,1416.22356799145,891.6703264582434,1337.1182596644303),c(719.170727879943,769.631206497368,845.339501283816,1498.4763143081536,1391.875631544575,1163.706609135205),c(463.5976592945087,626.2329392490377,790.2086642435672,220.39517923321893,271.0142455651697,415.4837515217979),c(2197.135915203462,2656.4982799738164,4525.322873720428,5046.944152201846,1319.939751548882,1354.723503372981),c(1240.2227979417198,1214.3473517611774,6381.394387408807,5015.308480541576,2412.361371018362,1231.4867974131257),c(814.2676836326627,1013.7712944075001,2067.406389009333,1285.4627917956645,702.6295255393288,1204.1986696648719),c(736.0108137944871,861.2971874599083,1746.5755456778845,916.3799557591735,418.2318604400767,1689.2231338354454),c(868.7503145326584,1404.032401475741,1502.3153093467818,1453.131851595099,1166.0304269069336,1213.0012915191473),c(2759.792903407054,4227.526131915967,5133.293493303173,3411.379927365853,3769.105526285971,3591.469716544355),c(5363.072067137757,4770.2613459318,6050.609365167314,5390.718450910121,3379.3134323558193,3637.243350186587),c(1474.9934074562466,1360.4683709192861,1996.1957244990112,2175.4796878379457,1251.3497264367093,1836.2269188018442),c(2162.4651500852833,2333.39838668011,5056.722886302828,3789.9534649004254,9841.832139875884,3219.1188121085065),c(2681.5360335688783,3378.027536065099,6238.207352318161,2838.774270314954,5616.01742198935,2633.7444587991936),c(964.837863574469,596.282668241475,3648.5894235664705,509.3343137303576,531.9909264797775,404.0403431112399),c(854.8820084853868,1205.271512061916,3366.809589805199,824.6365079443885,839.8095757636739,1287.823577280488),c(2784.5577356343247,5503.589193632122,6993.959243411572,8990.857885848922,18052.56002403547,4270.151861508987),c(1212.4861858471766,1958.5662071006134,2519.172970311372,3387.125912426312,14064.301002878898,1689.2231338354454),c(2105.010739318015,1832.4120352808798,2289.4611493103353,3967.113226197941,3299.0129151513247,3041.305850652144),c(1953.449966087118,1606.4236267692706,1694.5075329176493,1797.9606726920492,809.6968818119884,1048.3922628441978),c(1231.3074583399023,1993.961981927733,1674.5991750975595,1131.502523049014,3083.205275164245,1691.863920391728),c(1234.2792382071748,525.491118587236,484.691942312188,1055.5769110643644,841.4825032054342,1071.2790796653137),c(830.117176258116,1247.0203746785185,861.4193287538886,562.0604331641421,635.7124278689165,680.4426693354868),c(2064.396414465291,3814.575425599573,4360.696068669686,3446.1791661921507,4973.6132843533915,1929.5347104571633),c(245.66713569452597,461.0526567224799,244.26023633110265,787.7282243407394,1378.4922120104927,336.2601548333195),c(2344.734315277996,4833.79222382663,2522.235794591386,2391.656777516462,1676.2732966438273,981.4923367517049),c(2670.6395073888793,2141.898169025694,3473.2427335356792,4527.064614584731,14249.995948914291,737.6597113882768),c(689.4529292072181,499.17118345937786,1676.89629330757,2129.0807027362157,1728.1340473383968,1019.343610725089),c(2323.9318562070885,1236.1293670394048,1125.587922905081,2420.1288820107056,792.9676073943854,1094.1658964864298),c(562.6569882035917,1011.0485424977217,1358.362568186132,914.2709109818221,523.6262892709759,817.7635702621828),c(261.51662831997925,721.5292560912825,1045.1887855547182,1695.6720009905075,321.2020688179789,933.0779165531902),c(464.5882525835995,503.7091033090086,403.5270988918216,35.85376121497342,81.97344464625502,45.77363364223198),c(81.2286497054481,700.6548247829812,659.2729262729761,213.01352251248912,364.6981823037468,473.58105576001543),c(1842.5035177089449,1926.8007681531985,1650.096580857449,1644.0004039453986,7372.591235837671,2999.053265751622))
targetgene="Ptprs"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(4099.075030257857,3614.9069522158215,4541.402701190501,10163.486782056289,11032.956478409222,2352.940821647809),c(2063.4058211762,1765.2508215063453,1772.609552058002,2457.0371656143548,4346.265493693277,1463.8760143659956),c(2972.7704605615827,2714.5836540490895,3601.1156472262564,6013.941182617453,17487.110548720484,1753.4822733716558),c(1541.3631578253323,1334.148435791428,1513.0351943268302,4365.722689117351,1196.143120858619,2715.6088420439546),c(1329.3761939598946,1577.380939731634,2475.5277243211754,3255.310613841851,736.0880743745349,1092.4053721155747),c(975.7343897544681,1700.8123596415892,2068.9378011493395,3046.5151808840646,6746.9163726193165,1323.0340646975897),c(2883.6170645434077,1720.7792069799643,787.1458399635534,981.7603438570662,393.13794881367204,1294.8656747639084),c(1712.735796838046,1386.7883060471443,1199.095705625413,1396.187642606612,389.79209393015145,750.8636441696899),c(421.002147863603,383.00043530883175,497.70894550224676,852.0540900499565,363.0252548619865,1700.6665422460035),c(2010.904376854386,1696.2744397919585,1065.0971433748082,3581.158031942639,3998.296585807133,2005.2372584039315),c(989.6026958017397,1484.8073747991675,1114.1023318550294,1018.6686274607152,883.3056892494419,2436.565729263425),c(435.86104719996547,962.03900812171,1031.406076294656,1553.3114785192895,501.878232528092,1762.284895225931),c(1259.0440704344455,1231.591447189774,1068.159967654822,1211.6462245883663,585.5246046161074,1309.8301319161765),c(306.09332632906666,505.5242712488608,833.8539102337642,1263.317821633475,1242.9850892279078,1022.8646594667991),c(952.950744105379,454.6995689329969,1463.2642997766056,1324.480120176665,813.042736695509,1062.4764578110382),c(368.500703541789,214.1898169025694,265.70000629119943,578.9327913829532,548.7202008973806,762.3070525802478),c(649.8291976435848,516.4152788879745,988.5265363744625,1534.330075523127,1005.4293924979443,842.4109114541538),c(3419.528033941547,3545.930570501435,5116.447959763097,4811.785659527168,3245.479237014995,3634.6025636303043),c(746.9073399744863,353.9577482711952,480.09770589216726,323.7383733234364,1706.3859905955128,1607.3587505906844),c(1360.0845859217104,948.425248572818,2304.775270710404,4561.86385341103,2285.218885444579,1270.2183335719374),c(1143.1446556108185,1320.5346762425359,1961.7389513488558,2458.0916880030304,1493.924205491954,1395.2155639026478),c(1415.557810110797,2139.1754171159155,2598.040695521728,2805.029553877332,3217.0394705050694,2012.2793558873518),c(880.6374340017484,976.5603516405283,1290.980434025828,1162.083672320609,5157.635302947026,1112.651402380408),c(594.3559734544983,940.2569928434826,726.6550604332803,952.2337169741469,1890.4080091891465,1167.2276578769154),c(4263.513516246935,3015.9015320645685,3806.324873987183,5574.20534653969,4426.566010897771,3839.703652834921),c(310.05569948542995,235.06424821087066,308.579546211393,343.7742987082745,436.63406229944,535.1994087399431),c(1047.0571065690078,995.6196150089772,1425.7447023464363,2410.6381805126243,2445.819919853568,2093.2634769466854),c(597.3277533217708,918.4749775652552,447.17234488201865,1743.1255084809134,339.60427067734224,705.0900105274579),c(1513.626545730789,962.9465920916361,726.6550604332803,1325.5346425653406,2082.7946649915816,786.954393772219))
targetgene="Fgfr1"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(964.837863574469,1640.911817626464,3282.581922104818,3246.8744347324455,3993.277803481852,2557.1616486669977),c(189.20331821634863,392.07627500809315,209.03775711094366,554.6787764434123,490.1677404357698,635.5492978786824),c(1069.840752218097,1978.5330544389885,1936.4706510387416,1418.3326127688013,1858.6223877957007,764.9478391365305),c(2558.702465721615,2847.090913658306,4729.000688341348,4745.350749040599,6728.514170759953,3559.7802778689634),c(2706.300865796149,1724.4095428596688,1949.4876542288005,5193.522764227767,1664.562804551505,817.7635702621828),c(473.503592185417,543.6427979857588,824.6654373937228,3696.100972308289,5870.302393136916,958.6055199305889),c(878.6562474235667,621.695019399407,627.1132713328309,2006.7561056498357,2057.700753365177,1330.9564243664374),c(1812.78571903622,969.2996798811191,1049.0173159047356,1543.8207770212082,951.8957143616144,1866.1558331063804),c(1176.8248274399066,980.1906875202328,1332.3285618060145,1604.9830755643982,240.90155161348414,658.4361146997984),c(2570.5895851907053,3054.9276427713926,3362.9810594551814,9212.307587470816,17120.73943897498,1959.4636247616995),c(2271.4304118852747,1928.6159360930508,1574.2916799271068,2032.0646429780522,2009.1858575541282,1544.8601354253292),c(1510.6547658635166,1291.4919892048995,1109.5080954350085,922.7070900912277,4565.418988563877,1948.9004785365692),c(1153.0505885017267,1829.6892833711013,1330.031443596004,1273.863045520232,2009.1858575541282,1921.6123507883153),c(978.7061696217406,1264.2644701071151,982.4008878144348,1103.0304185547704,2450.838702178849,1406.6589723132056),c(387.32197603451476,1500.236302287912,1095.7253861749464,871.0354930461189,1530.7286092106806,1583.5916715841408),c(1063.897192483552,680.6879774446062,675.3527537430487,803.5460601708747,187.36787347715435,185.7353211252105),c(1477.965187323519,928.4584012344428,928.0357568441893,774.0194332879555,229.191059521162,872.3398257586902),c(266.46959476543344,481.92708803078114,713.6380572432215,602.1322839338183,403.1755134642339,622.3453650972693),c(1578.0151095216931,1315.0891724229791,1466.3271240566194,404.9365972514645,5072.31600341725,1539.578562312764),c(917.2893856981091,1398.5868976561842,2601.8692258717456,3470.4331811316915,9027.116475738614,1788.6927607887571),c(1084.6996515544595,787.7828858958909,856.0593862638644,1535.3845979118028,903.3808185505656,771.9899366199508),c(873.7032809781125,1792.4783406041295,2310.900919270432,1284.408269406989,2539.5038565921454,1246.4512545653938),c(1503.7206128398807,315.8392215342973,196.02075392088489,648.5312690355486,207.44300277827801,577.4519936404649),c(666.669283558129,778.7070461966294,735.8435332733218,850.9995676612808,555.4119106644218,508.791543177117),c(970.7814233090139,544.5503819556849,537.5256611424265,1027.104806570121,269.34131812340934,626.7466760244071),c(932.1482850344715,551.8110537150941,281.0141276912686,179.2688060748671,1575.8976501382087,173.41165052922497),c(1959.393525821663,2062.0307796721936,1650.096580857449,2337.8761356940017,6393.928682407892,2108.2279340989535),c(729.0766607708513,1092.7310997910745,737.3749454133286,1093.5397170566891,608.9455888007516,1427.7852647634666),c(1805.851566012584,802.3042294147091,1003.0749517045281,4385.75861450219,9288.093156653222,1559.8245925775973),c(604.2619063454066,578.1309888429522,1042.1259612747044,1693.562956213156,831.4449385548724,580.0927801967475))
targetgene="Gnas"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(3971.2884959651396,4527.028841991594,4715.983685151289,7849.864661301826,8280.990836713518,3928.610133563102),c(1575.0433296544206,603.5433400008841,297.8596612313446,70.65300004127114,234.2098418464429,1529.895678273061),c(791.4840379835736,1727.1322947694473,1431.1046448364605,1870.7227175106718,1017.1398845902664,1943.618905424004),c(434.87045391087463,360.3108360606782,401.99568675181473,358.5376121497342,138.85297766610546,676.9216205937767),c(769.6909856235753,401.15211470735454,853.7622680538541,460.82628385127595,190.71372836067496,799.2780643682045),c(183.25975848180366,888.5247065576925,826.9625556037331,398.6094629194103,264.32253579812846,183.0945345689279),c(1179.796607307179,2301.632947732695,3144.754829504196,2998.007151004983,3464.632731885595,2673.3562571434327),c(2657.761794630698,1898.6656650854882,2052.0922676092637,2760.739613552953,4071.9053932445863,1541.339086683619),c(3294.7132795161024,3107.567513027109,3823.1704075272587,5153.45091345809,2129.6366333608703,2323.011907343273),c(715.2083547235796,741.4961034296576,1298.6374947258623,2971.6440912880907,3583.410580250577,1466.5168009222782),c(534.9203761090484,1217.9776876408819,732.7807089933079,987.0329558004446,358.0064725367056,1854.7124246958226),c(565.6287680708642,418.39621013595126,432.623929551953,714.9661795221169,3938.071197903762,3352.0384021080645),c(1661.224945805323,3714.7411889076975,4476.3176852402075,4202.271718872619,5878.667030345718,1690.9836582063006),c(2760.7834966961445,2138.2678331459897,2423.45971156094,3986.094629194103,1905.4643561649893,2072.137184496424),c(2622.1004362234285,3165.6528871023816,2861.4435836029174,4809.6766147498165,2290.23766776986,4537.751565878958),c(1440.3226423380677,651.6452904069696,452.53228737204284,393.3368509760319,4249.235702071179,1769.3269927093513),c(834.0795494144793,1748.9143100476747,1926.5164721286967,4494.374420535785,1058.9630706342741,736.7794492028493),c(4173.369526939669,2931.496222861437,5605.734138495306,6758.433989022489,6382.21819031557,2877.5770841626218),c(1593.8646021471463,908.4915538960677,1095.7253861749464,1707.2717472659401,1079.0381999353979,1471.7983740348434),c(1478.95578061261,1159.892313565609,1532.9435521469202,3035.9699569973077,5661.186462916878,1222.6841755588503),c(1762.2654612925876,1281.5085655357118,1523.7550793068785,963.8334632495795,1816.799201751693,1336.2379974790026),c(121.84297455817216,579.0385728128783,487.75476659220186,1127.2844334943113,2111.234431501507,477.9823666871531),c(1522.5418853326066,1793.3859245740557,1594.9657438172,2188.133956502054,1152.6470073728512,989.4146964205527),c(1763.2560545816784,780.5222141364817,1323.140088965973,1464.7315978705317,4071.9053932445863,668.9992609249289),c(223.8740833345277,549.0883018053156,268.76283057121327,189.81402996162396,2490.9889607810965,591.5361886073056),c(937.1012514799257,942.0721607833349,773.3631307034912,890.0168960422812,624.0019357765943,1007.900202314531),c(285.2908672581592,197.85330544389885,382.8530350017283,308.9750598819768,177.3303088265925,622.3453650972693),c(156.51373967635124,527.3062865270882,729.7178847132941,418.6453883042484,575.4870399655455,661.076901256081),c(350.670024338154,822.2710767530842,483.9262362421846,208.79543295778637,277.7059553322109,340.6614657604572),c(2188.2205756016447,1217.9776876408819,2046.7323251192395,2803.9750314886564,1621.0666910657371,1830.0650835038514),c(1122.3421965399111,850.4061798207946,718.9979997332457,748.710895959739,2295.2564500951407,919.8739837717771),c(456.66350627087286,967.4845119412669,993.1207727944832,1339.2434336181248,5172.691649922868,2146.959470257765),c(1423.4825564235234,1772.5114932657543,1835.3974497982854,3338.6178825472302,3049.746726329039,2054.5319407878737),c(580.4876674072267,523.6759506473836,207.50634497093674,28.472104494243595,2527.7933644998234,499.9889213228416),c(1415.557810110797,654.3680423167481,618.690504562793,718.129746688144,625.6748632183546,866.1779904606974),c(48.5390711654507,598.0978361813272,425.73257492192187,813.036761668956,1155.9928622563718,151.40509589353653),c(434.87045391087463,418.39621013595126,565.091079662551,1127.2844334943113,220.82642231236048,848.5727467521466),c(490.3436780999611,509.15460712856543,402.76139282181816,884.7442840989028,2278.527175677538,825.6859299310306),c(1842.5035177089449,943.8873287231872,929.5671689841963,2176.5342102266213,910.0725283176068,1382.8918933066623),c(221.89289675634603,761.4629507680328,833.8539102337642,1086.1580603359594,664.1521943788417,1512.2904345645102),c(1888.070809007123,1279.6933975958596,902.7674565340753,310.0295822706525,356.3335450949453,1046.6317384733427),c(510.15554388177776,337.62123681252467,286.3740701812928,1021.8321946267423,946.8769320363335,1886.401863371214),c(752.8508997090312,432.0099696848434,480.86341196217074,1156.8110603772304,1025.504521799068,1163.706609135205),c(378.40663643269727,273.1827749477686,457.89222986206704,1321.316553010638,2444.146992411808,1009.6607266853861),c(242.69535582725348,608.0812598505148,612.5648560027653,1341.352478395476,1642.8147478086212,2095.9042635029678),c(483.40952507632534,1789.7555886943512,1581.183034557138,782.455612397361,496.85945020281105,1381.1313689358071),c(2261.5244789943663,1224.3307754303648,1439.5274116064984,504.0617017869792,675.8626864711639,1468.2773252931333),c(65.37915707999481,40.84127864667637,29.862536730134806,5.272611943378443,46.84196836928859,421.6455868197907),c(1296.6866154198972,1558.3216763631851,885.1562169239958,1246.4454634146641,2238.3769170752903,851.2135333084292),c(1070.8313455071877,1322.3498441823883,2036.012440139191,2110.099299740053,3615.1962016440225,957.7252577451613),c(2100.0577728725607,2813.510306771039,3836.953116787321,4354.122942841918,2191.5349487060016,1723.5533590671193),c(143.63602691817044,276.81311082747317,318.53372512143795,27.417582105567906,219.15349487060016,334.49963046246444),c(1765.23724115986,1918.6325124238633,2739.6963184723677,3281.6736735587433,9863.580196618768,2448.0091376739833),c(1451.2191685180667,1101.806939490336,1333.8599739460215,1314.989418678584,858.2117776230373,579.21251801132),c(1825.6634317944008,1969.457214739727,2102.6288682294917,1487.9310904213967,1634.4501105998195,2727.9325126399403),c(421.99274115269384,1575.5657717917818,892.8132776240304,1127.2844334943113,396.4838036971927,1771.0875170802065),c(1121.3516032508203,649.8301224671173,849.9337377038368,287.884612108463,317.85621393445825,1801.0164313847426),c(3434.3869332779095,3470.6011009975655,3430.3631936154857,4818.112793859222,1443.7363822391446,2033.4056483376128),c(2903.4289303252244,2785.375203703328,3666.9663692465538,5522.533749494582,5995.771951268939,4211.174295085341))
targetgene="Insr"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}




# parameters
# Do not modify the variables beginning with "__"
targetmat=list(c(1331.3573805380763,1335.9636037312803,1297.8717886558588,1713.5988815979943,1097.440401794761,1279.9012176116403),c(1436.3602691817043,1511.1273099270256,3013.819091533605,3735.1183006892893,2514.409944965741,1245.5709923799661),c(2327.894229363452,1521.1107335962133,2638.6231172319112,6422.041347034944,1420.3153980545003,1715.6309993982716),c(707.283608410853,710.6382484521688,818.5397888336951,1216.9188365317448,605.599733917231,901.3884778777989),c(442.7952002236013,357.58808415089976,408.12133531184236,378.57353753457227,555.4119106644218,995.5765317185454),c(1416.5484033998878,893.0626264073233,667.6956930430141,839.3998213858482,1323.2856064324026,845.0516980104364),c(1125.3139764071834,1115.4206990392279,1976.2873666789214,4877.16604762506,3116.6638239994513,1522.8535807896408),c(1502.7300195507898,2142.80575299562,2340.7634560005667,5213.558689612605,9994.068537076071,2609.0971176072226),c(140.66424705089793,584.4840766324352,1069.691379794829,1596.5468964549927,378.0816018378293,77.46307231762334),c(1348.1974664526203,2102.87205831887,2925.762893483208,4687.3520176634365,5155.962375505265,1140.8197923140892),c(1567.118583341694,1070.949084512847,1135.5421018151262,231.9949255086515,2261.7979012599344,894.3463803943786),c(2484.407969039803,1817.8906917620616,1702.164593617684,1518.5122396929917,1726.4611198966363,1293.1051503930532),c(1733.5382559089535,984.7286073698635,2718.256548512271,2344.203270026056,3444.557602584471,1675.1389388686048),c(631.9985184399499,1419.4613289644853,1019.9204852446042,2701.6863597871143,3588.429362575858,1667.216579199757),c(1717.6887632835,1214.3473517611774,1556.6804403170272,3140.367673476201,5239.60874759328,2338.8566266809685),c(950.9695575271974,846.7758439410901,1471.6870665466436,2799.7569419339534,2741.9280770451423,1606.4784884052567),c(1765.23724115986,1806.0921001530216,2123.302932119585,1978.284001155592,1249.676798994949,1005.2594157582483),c(1897.9767418980314,1856.0092184989594,3664.6692510365433,3413.488972143204,4436.6035755483335,1418.9826429091913),c(1651.3190129144145,2376.9624172365648,2879.054823212997,4727.423868433112,6017.520008011823,2014.9201424436344),c(1711.7452035489553,980.1906875202328,2534.4870917114413,917.4344781478492,5043.876236907325,1694.5047069480106),c(2032.6974292143843,2483.1497417179235,2680.7369510821013,5511.988525607825,12197.313977874395,2169.8462870788812),c(1798.9174129889482,958.4086722420054,511.491654762309,969.106075192958,1885.3892268638656,1597.6758665509815),c(826.1548031017527,1342.3166915207632,899.7046322540615,1182.119597705447,700.9565980975684,2184.8107442311493),c(404.16206194905885,574.5006529632476,725.8893543632769,2518.1994641575448,2081.1217375498213,516.7139028459648),c(821.2018366562985,1154.446809746052,1120.227980415057,892.1259408196327,677.5356139129242,1937.457070126011),c(303.12154646179414,1071.856668482773,551.3083704024888,628.4953436507104,319.52914137621855,857.375368606422),c(1221.401525448994,1699.9047756716632,2058.217916169291,2402.2020014032187,3802.5640751211768,2117.030555953229),c(916.2987924090182,589.929580451992,996.9493031445005,1692.5084338244803,11775.736262550798,580.0927801967475),c(559.6852083363193,1554.6913404834804,762.6432457234428,435.51774652305943,2487.643105897576,440.13109271376896),c(378.40663643269727,471.03608039166744,581.936613202627,1418.3326127688013,1008.7752473814649,1254.3736142342416),c(1559.1938370289672,1891.404993326079,3846.1415896273625,4580.845256407191,2437.4552826447666,2387.271046879483),c(1304.611361732624,854.9440996704253,687.604050863104,1419.387135157477,4781.226628550956,1446.270770657445),c(5821.716759986811,5071.579223947279,3905.1009570176284,4342.523196566486,6782.047848896283,3456.7896021739416),c(2483.4173757507124,2885.209440395204,3081.9669317639127,1350.8431798935571,2867.3976351771657,1183.0723772146112),c(2355.630841457995,1040.9988135052843,640.1302745228897,210.90447773513773,394.81087625543233,842.4109114541538),c(2575.5425516361593,3320.849745959752,4379.0730143497685,3801.553211175858,2040.971478947574,2759.6219513153314),c(2134.72853799074,1718.0564550701858,1370.6138653061873,2066.86388180435,782.9300427438235,1023.7449216522267),c(550.7698687345018,1170.7833212047226,1046.7201976947251,740.2747168503334,2698.4319635593747,1631.125829597228),c(2273.411598463456,2015.7439972059603,1695.2732389876528,2245.0781654905413,997.0647552891428,977.0910258245672),c(725.1142876144879,1497.5135503781335,2677.674126802088,2484.4547477199226,6260.094487067067,1461.235227809713),c(2007.9325969871136,1274.2478937763028,859.8879166138818,283.6665225537603,1288.1541301554362,478.8626288725807),c(2743.9434107816005,1942.229695641943,1519.9265489568613,1238.0092843052585,1174.3950641157353,1575.669311915293),c(1117.389230094457,1427.6295846938206,1470.92136047664,3248.983479509797,6778.701994012762,1412.8208076111985),c(1812.78571903622,2422.3416157328716,2447.9623058010507,2212.387971441595,921.7830204099289,1737.63755403396),c(881.6280272908392,1212.5321838213251,2428.053947980961,3824.7527037267228,7185.223362360517,2422.4815342965844),c(1395.7459443289802,1174.413657084427,1760.3582549379466,2567.762016425302,2854.014215643083,3112.6070876717745),c(1639.4318934453245,791.4132217755954,843.0423830738057,1161.0291499319333,4667.467562511256,558.0862255610591),c(694.4058956526723,1273.3403098063766,658.5072202029727,322.68385093476076,884.9786166912022,1275.4999066845025),c(977.7155763326498,814.102821023749,1109.5080954350085,1359.2793590029628,542.0284911303394,1115.2921889366905),c(786.5310715381195,1255.1886304078537,807.8199038536467,320.57480615740934,210.78885766179863,816.8833080767553),c(706.2930151217622,476.4815842112243,271.0599487812236,637.9860451487916,966.9520613374572,800.158326553632),c(1648.347233047142,1189.8425845731715,892.047571554027,1921.3397921671049,4347.938421135037,1992.913587807946),c(453.6917264036004,443.8085612938832,245.0259424011061,395.44589575338324,1928.8853403496335,458.6165986077473),c(730.0672540599421,982.9134394300113,417.30980815188383,211.95900012381344,416.5589329983163,2097.664787873823),c(501.24020427996027,320.37714138392795,275.6541852012444,442.89940324378927,160.60103440898945,312.49307582677596),c(1741.4630022216802,1327.795348001945,1164.6389324752574,452.39010474187046,455.0362641588034,1276.38016886993),c(989.6026958017397,503.7091033090086,382.0873289317248,612.6775078205751,935.1664399440114,1172.5092309894806),c(1865.287163358034,1287.8616533251948,1510.73807611682,1217.9733589204204,2658.281704957127,2209.4580854231203),c(1688.9615578998662,2001.2226536871422,2513.813027821348,1180.0105529280956,1569.2059403711676,1337.1182596644303),c(1864.296570068943,3054.9276427713926,3314.7415770449634,2349.4758819694343,1609.3561989734148,1643.4495001932135),c(2217.93837427437,1836.0423711605843,1438.761705536495,2954.77173306928,4525.268729961629,1124.094810790966),c(613.1772459472242,437.45547350440023,434.92104776196334,516.7159704510875,1258.0414362037507,584.4940911238853),c(1653.3001994925962,2304.355699642473,3078.1384014138953,6941.920884652059,5264.702659219685,2535.1550940313095),c(1377.9152651253453,1211.624599851399,1568.166031367079,3589.5942110520446,2751.9656416957046,2141.6778971452),c(1222.392118738085,1404.032401475741,1827.740389098251,4157.981778548241,1217.8911776015032,1132.0171704598138),c(834.0795494144793,385.7231872186102,438.7495781119806,468.2079405720058,403.1755134642339,555.4454390047765),c(1721.6511364398634,580.8537407527306,413.48127780186655,430.245134579681,552.0660557809011,816.0030458913277),c(1436.3602691817043,1177.1364089942056,481.6291180321742,204.5773434030836,588.8704594996279,1184.832901585466),c(1530.466631645333,1273.3403098063766,595.7193224626892,313.19314943667956,598.9080241501898,1375.849795823242),c(3619.627878337895,2517.637932575117,2532.9556795714343,2288.3135834262443,4558.727278796836,2345.018461978961),c(1271.9217831926264,1322.3498441823883,732.0150029233045,291.0481792744901,1463.8115115402684,706.850534898313),c(2401.1981327561734,2357.9031538681156,3931.134963397746,3034.915434608632,3324.106826777729,1338.8787840352852),c(2409.1228790688997,2749.071844906283,2066.6406829393295,3710.8642857497484,2395.6320966007593,1714.750737212844),c(2134.72853799074,1150.8164738663475,952.5383510843,3441.961076637448,2223.3205700994477,1176.0302797311908),c(360.57595722906234,750.5719431289191,1444.121648026519,1324.480120176665,1135.917732955248,798.3978021827769),c(1573.062143076239,1068.2263326030686,984.6980060244451,2308.3495088110826,4060.1949011522643,2556.2813864815703),c(1236.2604247853565,1018.3092142571309,1055.9086705347665,501.95265700962784,4038.44684440938,783.4333450305088),c(1779.1055472071316,1908.6490887546756,1442.5902358865121,1725.1986278734266,1249.676798994949,720.9347298651536),c(2372.4709273725393,1145.3709700467907,964.0239421343518,534.6428510585741,739.4339292580555,934.8384409240454),c(3328.3934513451904,3490.5679483359404,3709.8459091667473,4649.389211671111,3367.602940263497,2984.9690707847813),c(1176.8248274399066,2379.685169146343,1377.5052199362185,1819.051120465563,2228.3393524247285,1542.2193488690466))
targetgene="Trp63"
collabel=c("input_rep1","input_rep2","input_rep3","d5_rep1","d5_rep2","d5_rep3")

# set up color using RColorBrewer
#library(RColorBrewer)
#colors <- brewer.pal(length(targetgenelist), "Set1")

colors=c( "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",  "#A65628", "#F781BF",
          "#999999", "#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", "#A6D854", "#FFD92F", "#E5C494", "#B3B3B3", 
          "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "#FDB462", "#B3DE69", "#FCCDE5",
          "#D9D9D9", "#BC80BD", "#CCEBC5", "#FFED6F")


## code

targetmatvec=unlist(targetmat)+1
yrange=range(targetmatvec[targetmatvec>0]);
# yrange[1]=1; # set the minimum value to 1
for(i in 1:length(targetmat)){
  vali=targetmat[[i]]+1;
  if(i==1){
    plot(1:length(vali),vali,type='b',las=1,pch=20,main=paste('sgRNAs in',targetgene),ylab='Read counts',xlab='Samples',xlim=c(0.7,length(vali)+0.3),ylim = yrange,col=colors[(i %% length(colors))],xaxt='n',log='y')
    axis(1,at=1:length(vali),labels=(collabel),las=2)
    # lines(0:100,rep(1,101),col='black');
  }else{
    lines(1:length(vali),vali,type='b',pch=20,col=colors[(i %% length(colors))])
  }
}



dev.off()
Sweave("CBE_d5_input_summary.Rnw");
library(tools);

texi2dvi("CBE_d5_input_summary.tex",pdf=TRUE);

